Current configuration:
{
    "concurrency_flag": false,
    "data_distribution": "iid",
    "dataset": "mixed_depression",
    "device": "cuda",
    "dp_delta": 0.003,
    "dp_epsilon": 10,
    "eval_batch_size": 4,
    "eval_flag": true,
    "eval_size": 0.2,
    "fed_alg": "fedavg",
    "layers": 3,
    "learning_rate": 0.006,
    "max_length": 512,
    "ml_mode": "fl",
    "model": "bert_small",
    "model_name": "fl_10_c10_seed2_mixed_depression",
    "models_path": "/local/vpaloma/fabric-federated-learning/ablation_study/phase-3/1-ml_mode-dataset-dp/mixed_depression",
    "mu": 0.5,
    "num_clients": 10,
    "num_epochs": 3,
    "num_rounds": 4,
    "optimizer": "AdamW",
    "progress_bar_flag": false,
    "save_model": true,
    "scheduler": "linear",
    "scheduler_warmup_steps": 0,
    "seed": 221,
    "test_flag": true,
    "train_batch_size": 4,
    "train_size": 0.8
}
-------- Configuration loaded --------

-------- Setting device --------
cuda device selected and available.
-------- Device set --------

-------- Setting seed --------
-------- Seed set --------

-------- Creating Model --------
-------- Model created --------

-------- Setting Trainable Layers --------
Training the last 3 layers.

Total parameters count: 28764674
Trainable parameters count: 3416066
-------- Trainable Layers set --------

-------- Creating Tokenizer --------
-------- Tokenizer created --------

-------- Creating Train and Eval Dataloaders --------
Train Loader: 1806 total sentences. 452 batches of size 4.
Eval Loader: 452 total sentences. 113 batches of size 4.
-------- Train and Eval Dataloaders created --------

-------- Training --------
Training with Federated Learning technology.
Training with differential privacy.
Federated averaging algorithm selected.
Client 0: Label 0: 85, Label 1: 95
Client 1: Label 0: 73, Label 1: 107
Client 2: Label 0: 86, Label 1: 94
Client 3: Label 0: 84, Label 1: 96
Client 4: Label 0: 87, Label 1: 93
Client 5: Label 0: 93, Label 1: 87
Client 6: Label 0: 93, Label 1: 87
Client 7: Label 0: 89, Label 1: 91
Client 8: Label 0: 83, Label 1: 97
Client 9: Label 0: 92, Label 1: 94

Round 1 of 4
-------------------------------
max_grad_norm:  1.5
Predictions - 1s: 106, 0s: 74
True Labels - 1s: 95, 0s: 85
Client 1 of 10: Local Epoch [1/3] Loss: 0.7464, Accuracy: 50.56 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 156, 0s: 24
True Labels - 1s: 95, 0s: 85
Client 1 of 10: Local Epoch [2/3] Loss: 0.6590, Accuracy: 59.44 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 121, 0s: 59
True Labels - 1s: 95, 0s: 85
Client 1 of 10: Local Epoch [3/3] Loss: 0.5944, Accuracy: 66.67 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 165, 0s: 15
True Labels - 1s: 107, 0s: 73
Client 2 of 10: Local Epoch [1/3] Loss: 1.2156, Accuracy: 58.89 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 180, 0s: 0
True Labels - 1s: 107, 0s: 73
Client 2 of 10: Local Epoch [2/3] Loss: 1.2786, Accuracy: 59.44 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 180, 0s: 0
True Labels - 1s: 107, 0s: 73
Client 2 of 10: Local Epoch [3/3] Loss: 1.2484, Accuracy: 59.44 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 89, 0s: 91
True Labels - 1s: 94, 0s: 86
Client 3 of 10: Local Epoch [1/3] Loss: 0.6834, Accuracy: 57.22 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 113, 0s: 67
True Labels - 1s: 94, 0s: 86
Client 3 of 10: Local Epoch [2/3] Loss: 0.5423, Accuracy: 73.89 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 124, 0s: 56
True Labels - 1s: 94, 0s: 86
Client 3 of 10: Local Epoch [3/3] Loss: 0.5735, Accuracy: 72.22 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 35, 0s: 145
True Labels - 1s: 96, 0s: 84
Client 4 of 10: Local Epoch [1/3] Loss: 0.8168, Accuracy: 45.00 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 60, 0s: 120
True Labels - 1s: 96, 0s: 84
Client 4 of 10: Local Epoch [2/3] Loss: 0.6482, Accuracy: 64.44 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 113, 0s: 67
True Labels - 1s: 96, 0s: 84
Client 4 of 10: Local Epoch [3/3] Loss: 0.5455, Accuracy: 71.67 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 171, 0s: 9
True Labels - 1s: 93, 0s: 87
Client 5 of 10: Local Epoch [1/3] Loss: 1.1353, Accuracy: 53.33 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 130, 0s: 50
True Labels - 1s: 93, 0s: 87
Client 5 of 10: Local Epoch [2/3] Loss: 0.6512, Accuracy: 61.67 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 162, 0s: 18
True Labels - 1s: 93, 0s: 87
Client 5 of 10: Local Epoch [3/3] Loss: 0.7127, Accuracy: 59.44 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 35, 0s: 145
True Labels - 1s: 87, 0s: 93
Client 6 of 10: Local Epoch [1/3] Loss: 0.8769, Accuracy: 46.67 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 5, 0s: 175
True Labels - 1s: 87, 0s: 93
Client 6 of 10: Local Epoch [2/3] Loss: 1.0011, Accuracy: 54.44 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 10, 0s: 170
True Labels - 1s: 87, 0s: 93
Client 6 of 10: Local Epoch [3/3] Loss: 0.8554, Accuracy: 57.22 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 173, 0s: 7
True Labels - 1s: 87, 0s: 93
Client 7 of 10: Local Epoch [1/3] Loss: 1.0023, Accuracy: 46.67 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 23, 0s: 157
True Labels - 1s: 87, 0s: 93
Client 7 of 10: Local Epoch [2/3] Loss: 0.8187, Accuracy: 54.44 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 34, 0s: 146
True Labels - 1s: 87, 0s: 93
Client 7 of 10: Local Epoch [3/3] Loss: 0.6667, Accuracy: 65.00 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 177, 0s: 3
True Labels - 1s: 91, 0s: 89
Client 8 of 10: Local Epoch [1/3] Loss: 1.0645, Accuracy: 50.00 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 93, 0s: 87
True Labels - 1s: 91, 0s: 89
Client 8 of 10: Local Epoch [2/3] Loss: 0.6234, Accuracy: 65.56 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 82, 0s: 98
True Labels - 1s: 91, 0s: 89
Client 8 of 10: Local Epoch [3/3] Loss: 0.6190, Accuracy: 69.44 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 152, 0s: 28
True Labels - 1s: 97, 0s: 83
Client 9 of 10: Local Epoch [1/3] Loss: 0.8245, Accuracy: 52.78 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 178, 0s: 2
True Labels - 1s: 97, 0s: 83
Client 9 of 10: Local Epoch [2/3] Loss: 1.0681, Accuracy: 55.00 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 171, 0s: 9
True Labels - 1s: 97, 0s: 83
Client 9 of 10: Local Epoch [3/3] Loss: 0.8598, Accuracy: 56.67 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 169, 0s: 17
True Labels - 1s: 94, 0s: 92
Client 10 of 10: Local Epoch [1/3] Loss: 0.7499, Accuracy: 53.23 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 37, 0s: 149
True Labels - 1s: 94, 0s: 92
Client 10 of 10: Local Epoch [2/3] Loss: 0.8032, Accuracy: 56.45 %, Epsilon: 13.52, Delta: 0.0030
Predictions - 1s: 45, 0s: 141
True Labels - 1s: 94, 0s: 92
Client 10 of 10: Local Epoch [3/3] Loss: 0.7272, Accuracy: 67.20 %, Epsilon: 16.43, Delta: 0.0030
-------------------------------
Round [1/4] Average Local Loss: 0.7403, Average Local Accuracy: 64.50 %
-------------------------------
-------- Validation --------
Predictions - 1s: 451, 0s: 1
True Labels - 1s: 244, 0s: 208
Round [1/4] Global Model Validation Loss: 0.6832, Validation Accuracy: 54.20 %
-------- Validation finished --------
Updated best model in round 1 saved with Validation Loss: 0.6832 and Validation Accuracy: 54.20 %
-------------------------------

Round 2 of 4
-------------------------------
max_grad_norm:  1.5
Predictions - 1s: 141, 0s: 39
True Labels - 1s: 95, 0s: 85
Client 1 of 10: Local Epoch [1/3] Loss: 0.7527, Accuracy: 61.11 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 135, 0s: 45
True Labels - 1s: 95, 0s: 85
Client 1 of 10: Local Epoch [2/3] Loss: 0.6345, Accuracy: 67.78 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 161, 0s: 19
True Labels - 1s: 95, 0s: 85
Client 1 of 10: Local Epoch [3/3] Loss: 0.8010, Accuracy: 60.00 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 157, 0s: 23
True Labels - 1s: 107, 0s: 73
Client 2 of 10: Local Epoch [1/3] Loss: 1.1239, Accuracy: 60.00 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 179, 0s: 1
True Labels - 1s: 107, 0s: 73
Client 2 of 10: Local Epoch [2/3] Loss: 1.2299, Accuracy: 60.00 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 179, 0s: 1
True Labels - 1s: 107, 0s: 73
Client 2 of 10: Local Epoch [3/3] Loss: 1.0315, Accuracy: 60.00 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 159, 0s: 21
True Labels - 1s: 94, 0s: 86
Client 3 of 10: Local Epoch [1/3] Loss: 1.1917, Accuracy: 55.00 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 145, 0s: 35
True Labels - 1s: 94, 0s: 86
Client 3 of 10: Local Epoch [2/3] Loss: 0.6908, Accuracy: 61.67 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 169, 0s: 11
True Labels - 1s: 94, 0s: 86
Client 3 of 10: Local Epoch [3/3] Loss: 0.8240, Accuracy: 56.11 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 168, 0s: 12
True Labels - 1s: 96, 0s: 84
Client 4 of 10: Local Epoch [1/3] Loss: 0.8679, Accuracy: 56.67 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 179, 0s: 1
True Labels - 1s: 96, 0s: 84
Client 4 of 10: Local Epoch [2/3] Loss: 1.0334, Accuracy: 53.89 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 178, 0s: 2
True Labels - 1s: 96, 0s: 84
Client 4 of 10: Local Epoch [3/3] Loss: 1.0569, Accuracy: 54.44 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 90, 0s: 90
True Labels - 1s: 93, 0s: 87
Client 5 of 10: Local Epoch [1/3] Loss: 0.6467, Accuracy: 62.78 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 95, 0s: 85
True Labels - 1s: 93, 0s: 87
Client 5 of 10: Local Epoch [2/3] Loss: 0.5928, Accuracy: 66.67 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 111, 0s: 69
True Labels - 1s: 93, 0s: 87
Client 5 of 10: Local Epoch [3/3] Loss: 0.4843, Accuracy: 75.56 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 159, 0s: 21
True Labels - 1s: 87, 0s: 93
Client 6 of 10: Local Epoch [1/3] Loss: 0.6829, Accuracy: 60.00 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 37, 0s: 143
True Labels - 1s: 87, 0s: 93
Client 6 of 10: Local Epoch [2/3] Loss: 0.6535, Accuracy: 65.56 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 35, 0s: 145
True Labels - 1s: 87, 0s: 93
Client 6 of 10: Local Epoch [3/3] Loss: 0.6471, Accuracy: 66.67 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 20, 0s: 160
True Labels - 1s: 87, 0s: 93
Client 7 of 10: Local Epoch [1/3] Loss: 0.9094, Accuracy: 51.67 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 8, 0s: 172
True Labels - 1s: 87, 0s: 93
Client 7 of 10: Local Epoch [2/3] Loss: 0.9117, Accuracy: 53.89 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 24, 0s: 156
True Labels - 1s: 87, 0s: 93
Client 7 of 10: Local Epoch [3/3] Loss: 0.7562, Accuracy: 62.78 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 92, 0s: 88
True Labels - 1s: 91, 0s: 89
Client 8 of 10: Local Epoch [1/3] Loss: 0.6948, Accuracy: 61.67 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 147, 0s: 33
True Labels - 1s: 91, 0s: 89
Client 8 of 10: Local Epoch [2/3] Loss: 0.7185, Accuracy: 62.22 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 100, 0s: 80
True Labels - 1s: 91, 0s: 89
Client 8 of 10: Local Epoch [3/3] Loss: 0.5741, Accuracy: 71.67 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 180, 0s: 0
True Labels - 1s: 97, 0s: 83
Client 9 of 10: Local Epoch [1/3] Loss: 1.3023, Accuracy: 53.89 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 155, 0s: 25
True Labels - 1s: 97, 0s: 83
Client 9 of 10: Local Epoch [2/3] Loss: 0.7907, Accuracy: 62.22 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 166, 0s: 14
True Labels - 1s: 97, 0s: 83
Client 9 of 10: Local Epoch [3/3] Loss: 0.9543, Accuracy: 59.44 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 119, 0s: 67
True Labels - 1s: 94, 0s: 92
Client 10 of 10: Local Epoch [1/3] Loss: 0.8098, Accuracy: 53.23 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 59, 0s: 127
True Labels - 1s: 94, 0s: 92
Client 10 of 10: Local Epoch [2/3] Loss: 0.6489, Accuracy: 69.35 %, Epsilon: 13.52, Delta: 0.0030
Predictions - 1s: 75, 0s: 111
True Labels - 1s: 94, 0s: 92
Client 10 of 10: Local Epoch [3/3] Loss: 0.5297, Accuracy: 73.66 %, Epsilon: 16.43, Delta: 0.0030
-------------------------------
Round [2/4] Average Local Loss: 0.7659, Average Local Accuracy: 64.03 %
-------------------------------
-------- Validation --------
Predictions - 1s: 432, 0s: 20
True Labels - 1s: 244, 0s: 208
Round [2/4] Global Model Validation Loss: 0.6533, Validation Accuracy: 58.41 %
-------- Validation finished --------
Updated best model in round 2 saved with Validation Loss: 0.6533 and Validation Accuracy: 58.41 %
-------------------------------

Round 3 of 4
-------------------------------
max_grad_norm:  1.5
Predictions - 1s: 72, 0s: 108
True Labels - 1s: 95, 0s: 85
Client 1 of 10: Local Epoch [1/3] Loss: 0.7062, Accuracy: 60.56 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 138, 0s: 42
True Labels - 1s: 95, 0s: 85
Client 1 of 10: Local Epoch [2/3] Loss: 0.6925, Accuracy: 67.22 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 109, 0s: 71
True Labels - 1s: 95, 0s: 85
Client 1 of 10: Local Epoch [3/3] Loss: 0.5524, Accuracy: 74.44 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 180, 0s: 0
True Labels - 1s: 107, 0s: 73
Client 2 of 10: Local Epoch [1/3] Loss: 1.1520, Accuracy: 59.44 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 179, 0s: 1
True Labels - 1s: 107, 0s: 73
Client 2 of 10: Local Epoch [2/3] Loss: 0.9344, Accuracy: 60.00 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 179, 0s: 1
True Labels - 1s: 107, 0s: 73
Client 2 of 10: Local Epoch [3/3] Loss: 1.4406, Accuracy: 60.00 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 152, 0s: 28
True Labels - 1s: 94, 0s: 86
Client 3 of 10: Local Epoch [1/3] Loss: 0.7088, Accuracy: 62.22 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 159, 0s: 21
True Labels - 1s: 94, 0s: 86
Client 3 of 10: Local Epoch [2/3] Loss: 0.8009, Accuracy: 60.56 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 143, 0s: 37
True Labels - 1s: 94, 0s: 86
Client 3 of 10: Local Epoch [3/3] Loss: 0.6526, Accuracy: 67.22 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 173, 0s: 7
True Labels - 1s: 96, 0s: 84
Client 4 of 10: Local Epoch [1/3] Loss: 0.7985, Accuracy: 56.11 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 149, 0s: 31
True Labels - 1s: 96, 0s: 84
Client 4 of 10: Local Epoch [2/3] Loss: 0.7196, Accuracy: 65.00 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 148, 0s: 32
True Labels - 1s: 96, 0s: 84
Client 4 of 10: Local Epoch [3/3] Loss: 0.6637, Accuracy: 64.44 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 175, 0s: 5
True Labels - 1s: 93, 0s: 87
Client 5 of 10: Local Epoch [1/3] Loss: 1.0645, Accuracy: 52.22 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 155, 0s: 25
True Labels - 1s: 93, 0s: 87
Client 5 of 10: Local Epoch [2/3] Loss: 0.8008, Accuracy: 57.78 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 156, 0s: 24
True Labels - 1s: 93, 0s: 87
Client 5 of 10: Local Epoch [3/3] Loss: 0.7927, Accuracy: 59.44 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 90, 0s: 90
True Labels - 1s: 87, 0s: 93
Client 6 of 10: Local Epoch [1/3] Loss: 0.6980, Accuracy: 60.56 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 85, 0s: 95
True Labels - 1s: 87, 0s: 93
Client 6 of 10: Local Epoch [2/3] Loss: 0.5196, Accuracy: 71.11 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 66, 0s: 114
True Labels - 1s: 87, 0s: 93
Client 6 of 10: Local Epoch [3/3] Loss: 0.5482, Accuracy: 71.67 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 124, 0s: 56
True Labels - 1s: 87, 0s: 93
Client 7 of 10: Local Epoch [1/3] Loss: 0.9576, Accuracy: 52.78 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 16, 0s: 164
True Labels - 1s: 87, 0s: 93
Client 7 of 10: Local Epoch [2/3] Loss: 0.9180, Accuracy: 59.44 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 24, 0s: 156
True Labels - 1s: 87, 0s: 93
Client 7 of 10: Local Epoch [3/3] Loss: 0.8668, Accuracy: 61.67 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 173, 0s: 7
True Labels - 1s: 91, 0s: 89
Client 8 of 10: Local Epoch [1/3] Loss: 0.8923, Accuracy: 53.33 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 166, 0s: 14
True Labels - 1s: 91, 0s: 89
Client 8 of 10: Local Epoch [2/3] Loss: 0.9105, Accuracy: 53.89 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 100, 0s: 80
True Labels - 1s: 91, 0s: 89
Client 8 of 10: Local Epoch [3/3] Loss: 0.6039, Accuracy: 68.33 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 125, 0s: 55
True Labels - 1s: 97, 0s: 83
Client 9 of 10: Local Epoch [1/3] Loss: 0.8357, Accuracy: 55.56 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 175, 0s: 5
True Labels - 1s: 97, 0s: 83
Client 9 of 10: Local Epoch [2/3] Loss: 1.1398, Accuracy: 53.33 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 158, 0s: 22
True Labels - 1s: 97, 0s: 83
Client 9 of 10: Local Epoch [3/3] Loss: 0.7630, Accuracy: 62.78 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 160, 0s: 26
True Labels - 1s: 94, 0s: 92
Client 10 of 10: Local Epoch [1/3] Loss: 0.8007, Accuracy: 55.91 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 96, 0s: 90
True Labels - 1s: 94, 0s: 92
Client 10 of 10: Local Epoch [2/3] Loss: 0.5686, Accuracy: 65.59 %, Epsilon: 13.52, Delta: 0.0030
Predictions - 1s: 115, 0s: 71
True Labels - 1s: 94, 0s: 92
Client 10 of 10: Local Epoch [3/3] Loss: 0.6058, Accuracy: 65.05 %, Epsilon: 16.43, Delta: 0.0030
-------------------------------
Round [3/4] Average Local Loss: 0.7490, Average Local Accuracy: 65.51 %
-------------------------------
-------- Validation --------
Predictions - 1s: 412, 0s: 40
True Labels - 1s: 244, 0s: 208
Round [3/4] Global Model Validation Loss: 0.7211, Validation Accuracy: 62.83 %
-------- Validation finished --------

Round 4 of 4
-------------------------------
max_grad_norm:  1.5
Predictions - 1s: 117, 0s: 63
True Labels - 1s: 95, 0s: 85
Client 1 of 10: Local Epoch [1/3] Loss: 0.5968, Accuracy: 68.89 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 118, 0s: 62
True Labels - 1s: 95, 0s: 85
Client 1 of 10: Local Epoch [2/3] Loss: 0.6568, Accuracy: 69.44 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 111, 0s: 69
True Labels - 1s: 95, 0s: 85
Client 1 of 10: Local Epoch [3/3] Loss: 0.5413, Accuracy: 76.67 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 174, 0s: 6
True Labels - 1s: 107, 0s: 73
Client 2 of 10: Local Epoch [1/3] Loss: 1.1243, Accuracy: 61.67 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 179, 0s: 1
True Labels - 1s: 107, 0s: 73
Client 2 of 10: Local Epoch [2/3] Loss: 1.2580, Accuracy: 60.00 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 180, 0s: 0
True Labels - 1s: 107, 0s: 73
Client 2 of 10: Local Epoch [3/3] Loss: 1.3107, Accuracy: 59.44 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 134, 0s: 46
True Labels - 1s: 94, 0s: 86
Client 3 of 10: Local Epoch [1/3] Loss: 0.6197, Accuracy: 71.11 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 135, 0s: 45
True Labels - 1s: 94, 0s: 86
Client 3 of 10: Local Epoch [2/3] Loss: 0.6669, Accuracy: 69.44 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 120, 0s: 60
True Labels - 1s: 94, 0s: 86
Client 3 of 10: Local Epoch [3/3] Loss: 0.5853, Accuracy: 71.11 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 143, 0s: 37
True Labels - 1s: 96, 0s: 84
Client 4 of 10: Local Epoch [1/3] Loss: 0.7239, Accuracy: 67.22 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 106, 0s: 74
True Labels - 1s: 96, 0s: 84
Client 4 of 10: Local Epoch [2/3] Loss: 0.6335, Accuracy: 72.22 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 83, 0s: 97
True Labels - 1s: 96, 0s: 84
Client 4 of 10: Local Epoch [3/3] Loss: 0.6220, Accuracy: 72.78 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 105, 0s: 75
True Labels - 1s: 93, 0s: 87
Client 5 of 10: Local Epoch [1/3] Loss: 0.7064, Accuracy: 61.11 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 143, 0s: 37
True Labels - 1s: 93, 0s: 87
Client 5 of 10: Local Epoch [2/3] Loss: 0.7832, Accuracy: 58.89 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 115, 0s: 65
True Labels - 1s: 93, 0s: 87
Client 5 of 10: Local Epoch [3/3] Loss: 0.5988, Accuracy: 66.67 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 47, 0s: 133
True Labels - 1s: 87, 0s: 93
Client 6 of 10: Local Epoch [1/3] Loss: 0.9938, Accuracy: 55.56 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 122, 0s: 58
True Labels - 1s: 87, 0s: 93
Client 6 of 10: Local Epoch [2/3] Loss: 0.6129, Accuracy: 72.78 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 101, 0s: 79
True Labels - 1s: 87, 0s: 93
Client 6 of 10: Local Epoch [3/3] Loss: 0.5430, Accuracy: 72.22 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 119, 0s: 61
True Labels - 1s: 87, 0s: 93
Client 7 of 10: Local Epoch [1/3] Loss: 0.7552, Accuracy: 60.00 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 56, 0s: 124
True Labels - 1s: 87, 0s: 93
Client 7 of 10: Local Epoch [2/3] Loss: 0.5826, Accuracy: 70.56 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 64, 0s: 116
True Labels - 1s: 87, 0s: 93
Client 7 of 10: Local Epoch [3/3] Loss: 0.5886, Accuracy: 71.67 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 134, 0s: 46
True Labels - 1s: 91, 0s: 89
Client 8 of 10: Local Epoch [1/3] Loss: 0.7667, Accuracy: 57.22 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 101, 0s: 79
True Labels - 1s: 91, 0s: 89
Client 8 of 10: Local Epoch [2/3] Loss: 0.6245, Accuracy: 66.67 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 105, 0s: 75
True Labels - 1s: 91, 0s: 89
Client 8 of 10: Local Epoch [3/3] Loss: 0.5490, Accuracy: 75.56 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 165, 0s: 15
True Labels - 1s: 97, 0s: 83
Client 9 of 10: Local Epoch [1/3] Loss: 1.0681, Accuracy: 56.67 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 154, 0s: 26
True Labels - 1s: 97, 0s: 83
Client 9 of 10: Local Epoch [2/3] Loss: 0.7917, Accuracy: 59.44 %, Epsilon: 13.53, Delta: 0.0030
Predictions - 1s: 155, 0s: 25
True Labels - 1s: 97, 0s: 83
Client 9 of 10: Local Epoch [3/3] Loss: 0.8258, Accuracy: 61.11 %, Epsilon: 16.43, Delta: 0.0030
max_grad_norm:  1.5
Predictions - 1s: 114, 0s: 72
True Labels - 1s: 94, 0s: 92
Client 10 of 10: Local Epoch [1/3] Loss: 0.6341, Accuracy: 69.89 %, Epsilon: 9.99, Delta: 0.0030
Predictions - 1s: 33, 0s: 153
True Labels - 1s: 94, 0s: 92
Client 10 of 10: Local Epoch [2/3] Loss: 0.8925, Accuracy: 65.05 %, Epsilon: 13.52, Delta: 0.0030
Predictions - 1s: 47, 0s: 139
True Labels - 1s: 94, 0s: 92
Client 10 of 10: Local Epoch [3/3] Loss: 0.7598, Accuracy: 69.35 %, Epsilon: 16.43, Delta: 0.0030
-------------------------------
Round [4/4] Average Local Loss: 0.6924, Average Local Accuracy: 69.66 %
-------------------------------
-------- Validation --------
Predictions - 1s: 236, 0s: 216
True Labels - 1s: 244, 0s: 208
Round [4/4] Global Model Validation Loss: 0.4766, Validation Accuracy: 80.09 %
-------- Validation finished --------
Updated best model in round 4 saved with Validation Loss: 0.4766 and Validation Accuracy: 80.09 %
-------------------------------
Best model in round 4 saved with Validation Loss: 0.4766 and Validation Accuracy: 80.09 %

-------- Training finished in 10:55 --------

Test flag enabled. Testing the model

-------- Loading best model from model_path --------
Loaded model bert-small from date 10-04-2024 09:58. Trained with Federated Learning technology.
Round 4, lr: 0.006, optimizer: AdamW
Average train accuracy: 69.66 %, Validation accuracy: 80.09 %
-------- Best model loaded --------

-------- Creating Test Dataloader --------
Test Loader: 564 total sentences. 71 batches of size 8.
-------- Test Dataloader created --------

-------- Testing --------
Predictions - 1s: 265, 0s: 299
True Labels - 1s: 296, 0s: 268
NÂº of test samples: 564
Accuracy: 78.55%
Accuracy 2 : 78.55%
Precision: 78.80%
Recall: 78.77%
F1 Score: 78.55%
Classification report:
              precision    recall  f1-score   support

           0     0.7458    0.8321    0.7866       268
           1     0.8302    0.7432    0.7843       296

    accuracy                         0.7855       564
   macro avg     0.7880    0.7877    0.7855       564
weighted avg     0.7901    0.7855    0.7854       564

-------- Testing finished --------
