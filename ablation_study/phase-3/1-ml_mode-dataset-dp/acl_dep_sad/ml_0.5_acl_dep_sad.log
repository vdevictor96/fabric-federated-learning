Current configuration:
{
    "concurrency_flag": false,
    "data_distribution": "iid",
    "dataset": "acl_dep_sad",
    "device": "cuda",
    "dp_delta": 0.003,
    "dp_epsilon": 0.5,
    "eval_batch_size": 4,
    "eval_flag": true,
    "eval_size": 0.2,
    "fed_alg": "fedavg",
    "layers": 3,
    "learning_rate": 0.0006,
    "max_length": 512,
    "ml_mode": "ml",
    "model": "bert_small",
    "model_name": "ml_0.5_acl_dep_sad",
    "models_path": "/local/vpaloma/fabric-federated-learning/ablation_study/phase-3/1-ml_mode-dataset-dp/acl_dep_sad",
    "mu": 0.5,
    "num_clients": 5,
    "num_epochs": 12,
    "num_rounds": 4,
    "optimizer": "AdamW",
    "progress_bar_flag": false,
    "save_model": true,
    "scheduler": "linear",
    "scheduler_warmup_steps": 0,
    "seed": 0,
    "test_flag": true,
    "train_batch_size": 4,
    "train_size": 0.8
}
-------- Configuration loaded --------

-------- Setting device --------
cuda device selected and available.
-------- Device set --------

-------- Setting seed --------
-------- Seed set --------

-------- Creating Model --------
-------- Model created --------

-------- Setting Trainable Layers --------
Training the last 3 layers.

Total parameters count: 28764674
Trainable parameters count: 3416066
-------- Trainable Layers set --------

-------- Creating Tokenizer --------
-------- Tokenizer created --------

-------- Creating Train and Eval Dataloaders --------
Train Loader: 2085 total sentences. 522 batches of size 4.
Eval Loader: 521 total sentences. 131 batches of size 4.
-------- Train and Eval Dataloaders created --------

-------- Creating Optimizer --------
-------- Optimizer created --------

-------- Creating Scheduler --------
-------- Scheduler created --------

-------- Training --------
Training with Centralised Machine Learning technology.
Training with differential privacy.
max_grad_norm:  1.5
Epoch [1/12], Step [100/522], Loss: 0.7089, Accuracy: 58.25 %, Epsilon: 0.04, Delta: 0.0030
Epoch [1/12], Step [200/522], Loss: 0.7382, Accuracy: 59.25 %, Epsilon: 0.06, Delta: 0.0030
Epoch [1/12], Step [300/522], Loss: 0.8252, Accuracy: 57.83 %, Epsilon: 0.08, Delta: 0.0030
Epoch [1/12], Step [400/522], Loss: 0.8826, Accuracy: 58.06 %, Epsilon: 0.10, Delta: 0.0030
Epoch [1/12], Step [500/522], Loss: 0.9433, Accuracy: 58.20 %, Epsilon: 0.11, Delta: 0.0030
Predictions - 1s: 9, 0s: 2076
True Labels - 1s: 872, 0s: 1213
-------------------------------
Epoch [1/12] Loss: 0.9513, Accuracy: 58.23 %, Epsilon: 0.11, Delta: 0.0030
-------------------------------
-------- Validation --------
Predictions - 1s: 0, 0s: 521
True Labels - 1s: 202, 0s: 319
Validation Loss: 1.1241, Validation Accuracy: 61.23 %
-------- Validation finished --------
Updated best model in epoch 1 saved with Validation Loss: 1.1241 and Validation Accuracy: 61.23 %
-------------------------------
Epoch [2/12], Step [100/522], Loss: 1.2113, Accuracy: 57.00 %, Epsilon: 0.13, Delta: 0.0030
Epoch [2/12], Step [200/522], Loss: 1.1898, Accuracy: 57.75 %, Epsilon: 0.14, Delta: 0.0030
Epoch [2/12], Step [300/522], Loss: 1.1811, Accuracy: 57.42 %, Epsilon: 0.15, Delta: 0.0030
Epoch [2/12], Step [400/522], Loss: 1.1558, Accuracy: 58.06 %, Epsilon: 0.16, Delta: 0.0030
Epoch [2/12], Step [500/522], Loss: 1.1551, Accuracy: 57.95 %, Epsilon: 0.17, Delta: 0.0030
Predictions - 1s: 0, 0s: 2085
True Labels - 1s: 872, 0s: 1213
-------------------------------
Epoch [2/12] Loss: 1.1466, Accuracy: 58.18 %, Epsilon: 0.17, Delta: 0.0030
-------------------------------
-------- Validation --------
Predictions - 1s: 0, 0s: 521
True Labels - 1s: 202, 0s: 319
Validation Loss: 1.0536, Validation Accuracy: 61.23 %
-------- Validation finished --------
Updated best model in epoch 2 saved with Validation Loss: 1.0536 and Validation Accuracy: 61.23 %
-------------------------------
Epoch [3/12], Step [100/522], Loss: 1.0942, Accuracy: 61.00 %, Epsilon: 0.18, Delta: 0.0030
Epoch [3/12], Step [200/522], Loss: 1.1074, Accuracy: 60.25 %, Epsilon: 0.19, Delta: 0.0030
Epoch [3/12], Step [300/522], Loss: 1.1313, Accuracy: 59.25 %, Epsilon: 0.20, Delta: 0.0030
Epoch [3/12], Step [400/522], Loss: 1.1256, Accuracy: 58.44 %, Epsilon: 0.21, Delta: 0.0030
Epoch [3/12], Step [500/522], Loss: 1.1174, Accuracy: 58.25 %, Epsilon: 0.22, Delta: 0.0030
Predictions - 1s: 0, 0s: 2085
True Labels - 1s: 872, 0s: 1213
-------------------------------
Epoch [3/12] Loss: 1.1203, Accuracy: 58.18 %, Epsilon: 0.22, Delta: 0.0030
-------------------------------
-------- Validation --------
Predictions - 1s: 0, 0s: 521
True Labels - 1s: 202, 0s: 319
Validation Loss: 1.0145, Validation Accuracy: 61.23 %
-------- Validation finished --------
Updated best model in epoch 3 saved with Validation Loss: 1.0145 and Validation Accuracy: 61.23 %
-------------------------------
Epoch [4/12], Step [100/522], Loss: 1.0255, Accuracy: 57.00 %, Epsilon: 0.23, Delta: 0.0030
Epoch [4/12], Step [200/522], Loss: 1.0491, Accuracy: 57.12 %, Epsilon: 0.23, Delta: 0.0030
Epoch [4/12], Step [300/522], Loss: 1.0486, Accuracy: 57.33 %, Epsilon: 0.24, Delta: 0.0030
Epoch [4/12], Step [400/522], Loss: 1.0494, Accuracy: 57.62 %, Epsilon: 0.25, Delta: 0.0030
Epoch [4/12], Step [500/522], Loss: 1.0309, Accuracy: 58.20 %, Epsilon: 0.26, Delta: 0.0030
Predictions - 1s: 0, 0s: 2085
True Labels - 1s: 872, 0s: 1213
-------------------------------
Epoch [4/12] Loss: 1.0297, Accuracy: 58.18 %, Epsilon: 0.26, Delta: 0.0030
-------------------------------
-------- Validation --------
Predictions - 1s: 0, 0s: 521
True Labels - 1s: 202, 0s: 319
Validation Loss: 0.9827, Validation Accuracy: 61.23 %
-------- Validation finished --------
Updated best model in epoch 4 saved with Validation Loss: 0.9827 and Validation Accuracy: 61.23 %
-------------------------------
Epoch [5/12], Step [100/522], Loss: 0.9670, Accuracy: 59.00 %, Epsilon: 0.27, Delta: 0.0030
Epoch [5/12], Step [200/522], Loss: 0.9435, Accuracy: 58.88 %, Epsilon: 0.27, Delta: 0.0030
Epoch [5/12], Step [300/522], Loss: 0.9317, Accuracy: 59.17 %, Epsilon: 0.28, Delta: 0.0030
Epoch [5/12], Step [400/522], Loss: 0.9168, Accuracy: 59.50 %, Epsilon: 0.29, Delta: 0.0030
Epoch [5/12], Step [500/522], Loss: 0.9253, Accuracy: 58.75 %, Epsilon: 0.29, Delta: 0.0030
Predictions - 1s: 7, 0s: 2078
True Labels - 1s: 872, 0s: 1213
-------------------------------
Epoch [5/12] Loss: 0.9294, Accuracy: 58.51 %, Epsilon: 0.30, Delta: 0.0030
-------------------------------
-------- Validation --------
Predictions - 1s: 3, 0s: 518
True Labels - 1s: 202, 0s: 319
Validation Loss: 0.8330, Validation Accuracy: 61.80 %
-------- Validation finished --------
Updated best model in epoch 5 saved with Validation Loss: 0.8330 and Validation Accuracy: 61.80 %
-------------------------------
Epoch [6/12], Step [100/522], Loss: 0.8749, Accuracy: 60.50 %, Epsilon: 0.30, Delta: 0.0030
Epoch [6/12], Step [200/522], Loss: 0.8535, Accuracy: 59.12 %, Epsilon: 0.31, Delta: 0.0030
Epoch [6/12], Step [300/522], Loss: 0.8324, Accuracy: 60.00 %, Epsilon: 0.32, Delta: 0.0030
Epoch [6/12], Step [400/522], Loss: 0.8096, Accuracy: 60.44 %, Epsilon: 0.32, Delta: 0.0030
Epoch [6/12], Step [500/522], Loss: 0.8046, Accuracy: 60.45 %, Epsilon: 0.33, Delta: 0.0030
Predictions - 1s: 43, 0s: 2042
True Labels - 1s: 872, 0s: 1213
-------------------------------
Epoch [6/12] Loss: 0.8086, Accuracy: 60.24 %, Epsilon: 0.33, Delta: 0.0030
-------------------------------
-------- Validation --------
Predictions - 1s: 16, 0s: 505
True Labels - 1s: 202, 0s: 319
Validation Loss: 0.7391, Validation Accuracy: 64.30 %
-------- Validation finished --------
Updated best model in epoch 6 saved with Validation Loss: 0.7391 and Validation Accuracy: 64.30 %
-------------------------------
Epoch [7/12], Step [100/522], Loss: 0.6883, Accuracy: 64.50 %, Epsilon: 0.34, Delta: 0.0030
Epoch [7/12], Step [200/522], Loss: 0.7073, Accuracy: 64.88 %, Epsilon: 0.34, Delta: 0.0030
Epoch [7/12], Step [300/522], Loss: 0.7255, Accuracy: 63.75 %, Epsilon: 0.35, Delta: 0.0030
Epoch [7/12], Step [400/522], Loss: 0.7228, Accuracy: 63.81 %, Epsilon: 0.35, Delta: 0.0030
Epoch [7/12], Step [500/522], Loss: 0.7385, Accuracy: 62.90 %, Epsilon: 0.36, Delta: 0.0030
Predictions - 1s: 109, 0s: 1976
True Labels - 1s: 872, 0s: 1213
-------------------------------
Epoch [7/12] Loss: 0.7382, Accuracy: 62.93 %, Epsilon: 0.36, Delta: 0.0030
-------------------------------
-------- Validation --------
Predictions - 1s: 39, 0s: 482
True Labels - 1s: 202, 0s: 319
Validation Loss: 0.6363, Validation Accuracy: 68.33 %
-------- Validation finished --------
Updated best model in epoch 7 saved with Validation Loss: 0.6363 and Validation Accuracy: 68.33 %
-------------------------------
Epoch [8/12], Step [100/522], Loss: 0.6727, Accuracy: 62.50 %, Epsilon: 0.37, Delta: 0.0030
Epoch [8/12], Step [200/522], Loss: 0.7075, Accuracy: 62.25 %, Epsilon: 0.37, Delta: 0.0030
Epoch [8/12], Step [300/522], Loss: 0.6782, Accuracy: 64.83 %, Epsilon: 0.38, Delta: 0.0030
Epoch [8/12], Step [400/522], Loss: 0.6811, Accuracy: 65.12 %, Epsilon: 0.38, Delta: 0.0030
Epoch [8/12], Step [500/522], Loss: 0.6649, Accuracy: 65.85 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 185, 0s: 1900
True Labels - 1s: 872, 0s: 1213
-------------------------------
Epoch [8/12] Loss: 0.6624, Accuracy: 66.09 %, Epsilon: 0.39, Delta: 0.0030
-------------------------------
-------- Validation --------
Predictions - 1s: 47, 0s: 474
True Labels - 1s: 202, 0s: 319
Validation Loss: 0.6228, Validation Accuracy: 69.87 %
-------- Validation finished --------
Updated best model in epoch 8 saved with Validation Loss: 0.6228 and Validation Accuracy: 69.87 %
-------------------------------
Epoch [9/12], Step [100/522], Loss: 0.7478, Accuracy: 65.25 %, Epsilon: 0.40, Delta: 0.0030
Epoch [9/12], Step [200/522], Loss: 0.7048, Accuracy: 66.12 %, Epsilon: 0.40, Delta: 0.0030
Epoch [9/12], Step [300/522], Loss: 0.6757, Accuracy: 66.92 %, Epsilon: 0.41, Delta: 0.0030
Epoch [9/12], Step [400/522], Loss: 0.6638, Accuracy: 67.12 %, Epsilon: 0.41, Delta: 0.0030
Epoch [9/12], Step [500/522], Loss: 0.6408, Accuracy: 68.05 %, Epsilon: 0.42, Delta: 0.0030
Predictions - 1s: 235, 0s: 1850
True Labels - 1s: 872, 0s: 1213
-------------------------------
Epoch [9/12] Loss: 0.6324, Accuracy: 68.49 %, Epsilon: 0.42, Delta: 0.0030
-------------------------------
-------- Validation --------
Predictions - 1s: 73, 0s: 448
True Labels - 1s: 202, 0s: 319
Validation Loss: 0.5477, Validation Accuracy: 73.70 %
-------- Validation finished --------
Updated best model in epoch 9 saved with Validation Loss: 0.5477 and Validation Accuracy: 73.70 %
-------------------------------
Epoch [10/12], Step [100/522], Loss: 0.5495, Accuracy: 71.25 %, Epsilon: 0.42, Delta: 0.0030
Epoch [10/12], Step [200/522], Loss: 0.5556, Accuracy: 72.12 %, Epsilon: 0.43, Delta: 0.0030
Epoch [10/12], Step [300/522], Loss: 0.5489, Accuracy: 72.17 %, Epsilon: 0.44, Delta: 0.0030
Epoch [10/12], Step [400/522], Loss: 0.5576, Accuracy: 72.62 %, Epsilon: 0.44, Delta: 0.0030
Epoch [10/12], Step [500/522], Loss: 0.5621, Accuracy: 72.40 %, Epsilon: 0.45, Delta: 0.0030
Predictions - 1s: 337, 0s: 1748
True Labels - 1s: 872, 0s: 1213
-------------------------------
Epoch [10/12] Loss: 0.5627, Accuracy: 72.13 %, Epsilon: 0.45, Delta: 0.0030
-------------------------------
-------- Validation --------
Predictions - 1s: 97, 0s: 424
True Labels - 1s: 202, 0s: 319
Validation Loss: 0.4884, Validation Accuracy: 76.01 %
-------- Validation finished --------
Updated best model in epoch 10 saved with Validation Loss: 0.4884 and Validation Accuracy: 76.01 %
-------------------------------
Epoch [11/12], Step [100/522], Loss: 0.4997, Accuracy: 75.00 %, Epsilon: 0.45, Delta: 0.0030
Epoch [11/12], Step [200/522], Loss: 0.5158, Accuracy: 74.62 %, Epsilon: 0.46, Delta: 0.0030
Epoch [11/12], Step [300/522], Loss: 0.5160, Accuracy: 74.08 %, Epsilon: 0.46, Delta: 0.0030
Epoch [11/12], Step [400/522], Loss: 0.5310, Accuracy: 74.38 %, Epsilon: 0.47, Delta: 0.0030
Epoch [11/12], Step [500/522], Loss: 0.5177, Accuracy: 74.55 %, Epsilon: 0.47, Delta: 0.0030
Predictions - 1s: 414, 0s: 1671
True Labels - 1s: 872, 0s: 1213
-------------------------------
Epoch [11/12] Loss: 0.5178, Accuracy: 74.68 %, Epsilon: 0.47, Delta: 0.0030
-------------------------------
-------- Validation --------
Predictions - 1s: 102, 0s: 419
True Labels - 1s: 202, 0s: 319
Validation Loss: 0.4862, Validation Accuracy: 76.20 %
-------- Validation finished --------
Updated best model in epoch 11 saved with Validation Loss: 0.4862 and Validation Accuracy: 76.20 %
-------------------------------
Epoch [12/12], Step [100/522], Loss: 0.5382, Accuracy: 74.00 %, Epsilon: 0.48, Delta: 0.0030
Epoch [12/12], Step [200/522], Loss: 0.5239, Accuracy: 74.88 %, Epsilon: 0.48, Delta: 0.0030
Epoch [12/12], Step [300/522], Loss: 0.5403, Accuracy: 73.92 %, Epsilon: 0.49, Delta: 0.0030
Epoch [12/12], Step [400/522], Loss: 0.5325, Accuracy: 74.56 %, Epsilon: 0.49, Delta: 0.0030
Epoch [12/12], Step [500/522], Loss: 0.5247, Accuracy: 74.50 %, Epsilon: 0.50, Delta: 0.0030
Predictions - 1s: 409, 0s: 1676
True Labels - 1s: 872, 0s: 1213
-------------------------------
Epoch [12/12] Loss: 0.5325, Accuracy: 74.53 %, Epsilon: 0.50, Delta: 0.0030
-------------------------------
-------- Validation --------
Predictions - 1s: 103, 0s: 418
True Labels - 1s: 202, 0s: 319
Validation Loss: 0.4870, Validation Accuracy: 76.39 %
-------- Validation finished --------
Best model in epoch 11 saved with with Validation Loss: 0.4862 and Validation Accuracy: 76.20 %

-------- Training finished in 18:23 --------

Test flag enabled. Testing the model

-------- Loading best model from model_path --------
Loaded model bert-small from date 09-04-2024 12:38. Trained with Centralised Machine Learning technology.
Epoch 11, lr: 0.0006, optimizer: DPOptimizer
Train accuracy: 74.68 %, Validation accuracy: 76.20 %
-------- Best model loaded --------

-------- Creating Test Dataloader --------
Test Loader: 650 total sentences. 82 batches of size 8.
-------- Test Dataloader created --------

-------- Testing --------
Predictions - 1s: 132, 0s: 518
True Labels - 1s: 268, 0s: 382
Nº of test samples: 650
Accuracy: 76.92%
Accuracy 2 : 76.92%
Precision: 83.55%
Recall: 72.40%
F1 Score: 72.92%
Classification report:
              precision    recall  f1-score   support

           0     0.7239    0.9817    0.8333       382
           1     0.9470    0.4664    0.6250       268

    accuracy                         0.7692       650
   macro avg     0.8355    0.7240    0.7292       650
weighted avg     0.8159    0.7692    0.7474       650

-------- Testing finished --------
