Current configuration:
{
    "concurrency_flag": false,
    "data_distribution": "iid",
    "dataset": "acl_dep_sad",
    "device": "cuda",
    "dp_delta": 0.003,
    "dp_epsilon": 0.0,
    "eval_batch_size": 4,
    "eval_flag": true,
    "eval_size": 0.2,
    "fed_alg": "fedavg",
    "layers": 2,
    "learning_rate": 9e-05,
    "max_length": 512,
    "ml_mode": "ml",
    "model": "bert_tiny",
    "model_name": "bert_tiny_2_9e5",
    "models_path": "/local/vpaloma/ablation_study/layers-lr/",
    "mu": 0.5,
    "num_clients": 5,
    "num_epochs": 15,
    "num_rounds": 5,
    "optimizer": "AdamW",
    "progress_bar_flag": false,
    "save_model": true,
    "scheduler": "linear",
    "scheduler_warmup_steps": 0,
    "seed": 100,
    "test_flag": true,
    "train_batch_size": 4,
    "train_size": 0.8
}
-------- Configuration loaded --------

-------- Setting device --------
cuda device selected and available.
-------- Device set --------

-------- Setting seed --------
-------- Seed set --------

-------- Creating Model --------
-------- Model created --------

-------- Setting Trainable Layers --------
Training the last 2 layers.

Total parameters count: 4386178
Trainable parameters count: 16770
-------- Trainable Layers set --------

-------- Creating Tokenizer --------
-------- Tokenizer created --------

-------- Creating Train and Eval Dataloaders --------
Train Loader: 2085 total sentences. 522 batches of size 4.
Eval Loader: 521 total sentences. 131 batches of size 4.
-------- Train and Eval Dataloaders created --------

-------- Creating Optimizer --------
-------- Optimizer created --------

-------- Creating Scheduler --------
-------- Scheduler created --------

-------- Training --------
Training with Centralised Machine Learning technology.
Training without differential privacy.
Epoch [1/15], Step [100/522], Loss: 0.6608, Accuracy: 60.50 %
Epoch [1/15], Step [200/522], Loss: 0.6463, Accuracy: 61.62 %
Epoch [1/15], Step [300/522], Loss: 0.6353, Accuracy: 62.67 %
Epoch [1/15], Step [400/522], Loss: 0.6225, Accuracy: 64.62 %
Epoch [1/15], Step [500/522], Loss: 0.6073, Accuracy: 67.10 %
-------------------------------
Epoch [1/15] Loss: 0.6034, Accuracy: 67.58 %
-------------------------------
-------- Validation --------
Validation Loss: 0.5015, Validation Accuracy: 81.38 %
-------- Validation finished --------
Updated best model in epoch 1 saved with Validation Accuracy: 81.38 %
-------------------------------
Epoch [2/15], Step [100/522], Loss: 0.5065, Accuracy: 79.50 %
Epoch [2/15], Step [200/522], Loss: 0.4963, Accuracy: 80.38 %
Epoch [2/15], Step [300/522], Loss: 0.4753, Accuracy: 81.33 %
Epoch [2/15], Step [400/522], Loss: 0.4569, Accuracy: 82.25 %
Epoch [2/15], Step [500/522], Loss: 0.4555, Accuracy: 82.00 %
-------------------------------
Epoch [2/15] Loss: 0.4529, Accuracy: 82.16 %
-------------------------------
-------- Validation --------
Validation Loss: 0.3911, Validation Accuracy: 85.41 %
-------- Validation finished --------
Updated best model in epoch 2 saved with Validation Accuracy: 85.41 %
-------------------------------
Epoch [3/15], Step [100/522], Loss: 0.4040, Accuracy: 85.00 %
Epoch [3/15], Step [200/522], Loss: 0.3880, Accuracy: 84.25 %
Epoch [3/15], Step [300/522], Loss: 0.3839, Accuracy: 84.92 %
Epoch [3/15], Step [400/522], Loss: 0.3875, Accuracy: 84.44 %
Epoch [3/15], Step [500/522], Loss: 0.3906, Accuracy: 84.35 %
-------------------------------
Epoch [3/15] Loss: 0.3881, Accuracy: 84.56 %
-------------------------------
-------- Validation --------
Validation Loss: 0.3597, Validation Accuracy: 84.84 %
-------- Validation finished --------
Epoch [4/15], Step [100/522], Loss: 0.3504, Accuracy: 86.50 %
Epoch [4/15], Step [200/522], Loss: 0.3555, Accuracy: 85.62 %
Epoch [4/15], Step [300/522], Loss: 0.3580, Accuracy: 85.67 %
Epoch [4/15], Step [400/522], Loss: 0.3584, Accuracy: 85.62 %
Epoch [4/15], Step [500/522], Loss: 0.3665, Accuracy: 85.15 %
-------------------------------
Epoch [4/15] Loss: 0.3650, Accuracy: 85.04 %
-------------------------------
-------- Validation --------
Validation Loss: 0.3494, Validation Accuracy: 85.41 %
-------- Validation finished --------
Updated best model in epoch 4 saved with Validation Accuracy: 85.41 %
-------------------------------
Epoch [5/15], Step [100/522], Loss: 0.3684, Accuracy: 83.75 %
Epoch [5/15], Step [200/522], Loss: 0.3625, Accuracy: 84.62 %
Epoch [5/15], Step [300/522], Loss: 0.3631, Accuracy: 84.25 %
Epoch [5/15], Step [400/522], Loss: 0.3671, Accuracy: 84.31 %
Epoch [5/15], Step [500/522], Loss: 0.3688, Accuracy: 84.80 %
-------------------------------
Epoch [5/15] Loss: 0.3666, Accuracy: 84.80 %
-------------------------------
-------- Validation --------
Validation Loss: 0.3422, Validation Accuracy: 85.80 %
-------- Validation finished --------
Updated best model in epoch 5 saved with Validation Accuracy: 85.80 %
-------------------------------
Epoch [6/15], Step [100/522], Loss: 0.3597, Accuracy: 84.75 %
Epoch [6/15], Step [200/522], Loss: 0.3538, Accuracy: 85.50 %
Epoch [6/15], Step [300/522], Loss: 0.3557, Accuracy: 85.75 %
Epoch [6/15], Step [400/522], Loss: 0.3628, Accuracy: 85.25 %
Epoch [6/15], Step [500/522], Loss: 0.3622, Accuracy: 85.55 %
-------------------------------
Epoch [6/15] Loss: 0.3656, Accuracy: 85.37 %
-------------------------------
-------- Validation --------
Validation Loss: 0.3395, Validation Accuracy: 85.22 %
-------- Validation finished --------
Epoch [7/15], Step [100/522], Loss: 0.3727, Accuracy: 86.25 %
Epoch [7/15], Step [200/522], Loss: 0.3752, Accuracy: 85.75 %
Epoch [7/15], Step [300/522], Loss: 0.3656, Accuracy: 85.75 %
Epoch [7/15], Step [400/522], Loss: 0.3646, Accuracy: 84.88 %
Epoch [7/15], Step [500/522], Loss: 0.3721, Accuracy: 84.35 %
-------------------------------
Epoch [7/15] Loss: 0.3688, Accuracy: 84.36 %
-------------------------------
-------- Validation --------
Validation Loss: 0.3339, Validation Accuracy: 86.37 %
-------- Validation finished --------
Updated best model in epoch 7 saved with Validation Accuracy: 86.37 %
-------------------------------
Epoch [8/15], Step [100/522], Loss: 0.3397, Accuracy: 85.75 %
Epoch [8/15], Step [200/522], Loss: 0.3445, Accuracy: 85.50 %
Epoch [8/15], Step [300/522], Loss: 0.3361, Accuracy: 86.67 %
Epoch [8/15], Step [400/522], Loss: 0.3565, Accuracy: 85.50 %
Epoch [8/15], Step [500/522], Loss: 0.3514, Accuracy: 85.80 %
-------------------------------
Epoch [8/15] Loss: 0.3541, Accuracy: 85.56 %
-------------------------------
-------- Validation --------
Validation Loss: 0.3309, Validation Accuracy: 86.18 %
-------- Validation finished --------
Epoch [9/15], Step [100/522], Loss: 0.3033, Accuracy: 86.75 %
Epoch [9/15], Step [200/522], Loss: 0.3273, Accuracy: 86.50 %
Epoch [9/15], Step [300/522], Loss: 0.3493, Accuracy: 85.67 %
Epoch [9/15], Step [400/522], Loss: 0.3525, Accuracy: 85.94 %
Epoch [9/15], Step [500/522], Loss: 0.3512, Accuracy: 86.05 %
-------------------------------
Epoch [9/15] Loss: 0.3618, Accuracy: 85.90 %
-------------------------------
-------- Validation --------
Validation Loss: 0.3308, Validation Accuracy: 85.99 %
-------- Validation finished --------
Epoch [10/15], Step [100/522], Loss: 0.3917, Accuracy: 83.25 %
Epoch [10/15], Step [200/522], Loss: 0.3673, Accuracy: 83.88 %
Epoch [10/15], Step [300/522], Loss: 0.3552, Accuracy: 84.83 %
Epoch [10/15], Step [400/522], Loss: 0.3535, Accuracy: 84.44 %
Epoch [10/15], Step [500/522], Loss: 0.3539, Accuracy: 84.45 %
-------------------------------
Epoch [10/15] Loss: 0.3499, Accuracy: 84.70 %
-------------------------------
-------- Validation --------
Validation Loss: 0.3300, Validation Accuracy: 86.56 %
-------- Validation finished --------
Updated best model in epoch 10 saved with Validation Accuracy: 86.56 %
-------------------------------
Epoch [11/15], Step [100/522], Loss: 0.3550, Accuracy: 84.25 %
Epoch [11/15], Step [200/522], Loss: 0.3547, Accuracy: 84.00 %
Epoch [11/15], Step [300/522], Loss: 0.3476, Accuracy: 84.75 %
Epoch [11/15], Step [400/522], Loss: 0.3517, Accuracy: 85.25 %
Epoch [11/15], Step [500/522], Loss: 0.3523, Accuracy: 85.50 %
-------------------------------
Epoch [11/15] Loss: 0.3508, Accuracy: 85.56 %
-------------------------------
-------- Validation --------
Validation Loss: 0.3276, Validation Accuracy: 86.56 %
-------- Validation finished --------
Updated best model in epoch 11 saved with Validation Accuracy: 86.56 %
-------------------------------
Epoch [12/15], Step [100/522], Loss: 0.3552, Accuracy: 86.00 %
Epoch [12/15], Step [200/522], Loss: 0.3467, Accuracy: 85.25 %
Epoch [12/15], Step [300/522], Loss: 0.3493, Accuracy: 85.00 %
Epoch [12/15], Step [400/522], Loss: 0.3504, Accuracy: 85.25 %
Epoch [12/15], Step [500/522], Loss: 0.3526, Accuracy: 85.25 %
-------------------------------
Epoch [12/15] Loss: 0.3551, Accuracy: 85.13 %
-------------------------------
-------- Validation --------
Validation Loss: 0.3251, Validation Accuracy: 86.56 %
-------- Validation finished --------
Updated best model in epoch 12 saved with Validation Accuracy: 86.56 %
-------------------------------
Epoch [13/15], Step [100/522], Loss: 0.3256, Accuracy: 85.75 %
Epoch [13/15], Step [200/522], Loss: 0.3311, Accuracy: 85.75 %
Epoch [13/15], Step [300/522], Loss: 0.3311, Accuracy: 85.92 %
Epoch [13/15], Step [400/522], Loss: 0.3500, Accuracy: 85.31 %
Epoch [13/15], Step [500/522], Loss: 0.3533, Accuracy: 85.40 %
-------------------------------
Epoch [13/15] Loss: 0.3556, Accuracy: 85.28 %
-------------------------------
-------- Validation --------
Validation Loss: 0.3273, Validation Accuracy: 86.56 %
-------- Validation finished --------
Updated best model in epoch 13 saved with Validation Accuracy: 86.56 %
-------------------------------
Epoch [14/15], Step [100/522], Loss: 0.3544, Accuracy: 85.25 %
Epoch [14/15], Step [200/522], Loss: 0.3745, Accuracy: 84.12 %
Epoch [14/15], Step [300/522], Loss: 0.3715, Accuracy: 84.42 %
Epoch [14/15], Step [400/522], Loss: 0.3663, Accuracy: 84.12 %
Epoch [14/15], Step [500/522], Loss: 0.3625, Accuracy: 84.40 %
-------------------------------
Epoch [14/15] Loss: 0.3612, Accuracy: 84.46 %
-------------------------------
-------- Validation --------
Validation Loss: 0.3254, Validation Accuracy: 86.37 %
-------- Validation finished --------
Epoch [15/15], Step [100/522], Loss: 0.3738, Accuracy: 83.50 %
Epoch [15/15], Step [200/522], Loss: 0.3584, Accuracy: 84.25 %
Epoch [15/15], Step [300/522], Loss: 0.3630, Accuracy: 84.75 %
Epoch [15/15], Step [400/522], Loss: 0.3567, Accuracy: 85.19 %
Epoch [15/15], Step [500/522], Loss: 0.3560, Accuracy: 85.45 %
-------------------------------
Epoch [15/15] Loss: 0.3553, Accuracy: 85.56 %
-------------------------------
-------- Validation --------
Validation Loss: 0.3250, Validation Accuracy: 86.37 %
-------- Validation finished --------
Best model in epoch 13 saved with Validation Accuracy: 86.56 %
-------- Training finished --------

Test flag enabled. Testing the model

-------- Loading best model from model_path --------
Loaded model bert-tiny from date 01-02-2024 10:24. Trained with Centralised Machine Learning technology.
Epoch 13, lr: 9e-05, optimizer: AdamW
Train accuracy: 85.28 %, Validation accuracy: 86.56 %
-------- Best model loaded --------

-------- Creating Test Dataloader --------
Test Loader: 650 total sentences. 82 batches of size 8.
-------- Test Dataloader created --------

-------- Testing --------
Nº of test samples: 650
Accuracy: 85.54%
Precision: 85.45%
Recall: 84.52%
F1 Score: 84.90%
-------- Testing finished --------
