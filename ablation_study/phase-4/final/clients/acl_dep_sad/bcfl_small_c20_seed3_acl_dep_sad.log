Current configuration:
{
    "concurrency_flag": true,
    "data_distribution": "iid",
    "dataset": "acl_dep_sad",
    "device": "cuda",
    "dp_delta": 0.003,
    "dp_epsilon": 0.0,
    "eval_batch_size": 4,
    "eval_flag": true,
    "eval_size": 0.2,
    "fed_alg": "fedavg",
    "layers": 3,
    "learning_rate": 6e-05,
    "max_length": 512,
    "ml_mode": "bcfl",
    "model": "bert_small",
    "model_name": "bcfl_small_c20_seed3_acl_dep_sad",
    "models_path": "/local/vpaloma/fabric-federated-learning/ablation_study/phase-4/final/clients/acl_dep_sad/",
    "mu": 0.5,
    "num_clients": 15,
    "num_epochs": 3,
    "num_rounds": 4,
    "optimizer": "AdamW",
    "progress_bar_flag": false,
    "save_model": true,
    "scheduler": "linear",
    "scheduler_warmup_steps": 0,
    "seed": "random",
    "test_flag": true,
    "train_batch_size": 4,
    "train_size": 0.8
}
-------- Configuration loaded --------

-------- Setting device --------
cuda device selected and available.
-------- Device set --------

-------- Setting seed --------
seed set:  74279
-------- Seed set --------

-------- Creating Model --------
-------- Model created --------

-------- Setting Trainable Layers --------
Training the last 3 layers.

Total parameters count: 28764674
Trainable parameters count: 3416066
-------- Trainable Layers set --------

-------- Creating Tokenizer --------
-------- Tokenizer created --------

-------- Creating Train and Eval Dataloaders --------
Train Loader: 2085 total sentences. 522 batches of size 4.
Eval Loader: 521 total sentences. 131 batches of size 4.
-------- Train and Eval Dataloaders created --------

-------- Training --------
Training with Blockchain-Based Federated Learning technology.
Training without differential privacy.
Federated averaging algorithm selected.
Client 0: Label 0: 79, Label 1: 60
Client 1: Label 0: 83, Label 1: 56
Client 2: Label 0: 79, Label 1: 60
Client 3: Label 0: 86, Label 1: 53
Client 4: Label 0: 82, Label 1: 57
Client 5: Label 0: 90, Label 1: 49
Client 6: Label 0: 68, Label 1: 71
Client 7: Label 0: 88, Label 1: 51
Client 8: Label 0: 74, Label 1: 65
Client 9: Label 0: 82, Label 1: 57
Client 10: Label 0: 73, Label 1: 66
Client 11: Label 0: 84, Label 1: 55
Client 12: Label 0: 79, Label 1: 60
Client 13: Label 0: 90, Label 1: 49
Client 14: Label 0: 76, Label 1: 63

Round 1 of 4
-------------------------------
Predictions - 1s: 33, 0s: 106
True Labels - 1s: 60, 0s: 79
Client 3 of 15: Local Epoch [1/3] Loss: 0.6074, Accuracy: 67.63 %
Predictions - 1s: 25, 0s: 114
True Labels - 1s: 55, 0s: 84
Client 12 of 15: Local Epoch [1/3] Loss: 0.6087, Accuracy: 62.59 %
Predictions - 1s: 90, 0s: 49
True Labels - 1s: 71, 0s: 68
Client 7 of 15: Local Epoch [1/3] Loss: 0.6163, Accuracy: 66.19 %
Predictions - 1s: 36, 0s: 103
True Labels - 1s: 63, 0s: 76
Client 15 of 15: Local Epoch [1/3] Loss: 0.6663, Accuracy: 63.31 %
Predictions - 1s: 60, 0s: 79
True Labels - 1s: 60, 0s: 79
Client 3 of 15: Local Epoch [2/3] Loss: 0.4114, Accuracy: 91.37 %
Predictions - 1s: 14, 0s: 125
True Labels - 1s: 49, 0s: 90
Client 14 of 15: Local Epoch [1/3] Loss: 0.5871, Accuracy: 67.63 %
Predictions - 1s: 54, 0s: 85
True Labels - 1s: 55, 0s: 84
Client 12 of 15: Local Epoch [2/3] Loss: 0.4453, Accuracy: 84.89 %
Predictions - 1s: 68, 0s: 71
True Labels - 1s: 71, 0s: 68
Client 7 of 15: Local Epoch [2/3] Loss: 0.4274, Accuracy: 89.21 %
Predictions - 1s: 53, 0s: 86
True Labels - 1s: 63, 0s: 76
Client 15 of 15: Local Epoch [2/3] Loss: 0.4801, Accuracy: 84.17 %
Predictions - 1s: 52, 0s: 87
True Labels - 1s: 60, 0s: 79
Client 3 of 15: Local Epoch [3/3] Loss: 0.3284, Accuracy: 89.93 %
Predictions - 1s: 28, 0s: 111
True Labels - 1s: 49, 0s: 90
Client 14 of 15: Local Epoch [2/3] Loss: 0.4058, Accuracy: 84.89 %
Predictions - 1s: 50, 0s: 89
True Labels - 1s: 55, 0s: 84
Client 12 of 15: Local Epoch [3/3] Loss: 0.3711, Accuracy: 89.21 %
Predictions - 1s: 9, 0s: 130
True Labels - 1s: 49, 0s: 90
Predictions - 1s: 47, 0s: 92
Client 6 of 15: Local Epoch [1/3] Loss: 0.5729, Accuracy: 65.47 %
True Labels - 1s: 66, 0s: 73
Client 11 of 15: Local Epoch [1/3] Loss: 0.6189, Accuracy: 66.19 %
Predictions - 1s: 41, 0s: 98
True Labels - 1s: 65, 0s: 74
Client 9 of 15: Local Epoch [1/3] Loss: 0.6150, Accuracy: 64.03 %
Predictions - 1s: 15, 0s: 124
True Labels - 1s: 57, 0s: 82
Client 5 of 15: Local Epoch [1/3] Loss: 0.6335, Accuracy: 62.59 %
Predictions - 1s: 21, 0s: 118
True Labels - 1s: 51, 0s: 88
Client 8 of 15: Local Epoch [1/3] Loss: 0.5708, Accuracy: 68.35 %
Predictions - 1s: 19, 0s: 120
True Labels - 1s: 57, 0s: 82
Predictions - 1s: 12, 0s: 127
Client 10 of 15: Local Epoch [1/3] Loss: 0.6498, Accuracy: 65.47 %
Predictions - 1s: 35, 0s: 104
True Labels - 1s: 56, 0s: 83
Client 2 of 15: Local Epoch [1/3] Loss: 0.6324, Accuracy: 58.27 %
True Labels - 1s: 60, 0s: 79
Client 13 of 15: Local Epoch [1/3] Loss: 0.5944, Accuracy: 69.06 %
Predictions - 1s: 27, 0s: 112
True Labels - 1s: 53, 0s: 86
Client 4 of 15: Local Epoch [1/3] Loss: 0.5867, Accuracy: 66.91 %
Predictions - 1s: 22, 0s: 117
True Labels - 1s: 60, 0s: 79
Client 1 of 15: Local Epoch [1/3] Loss: 0.6374, Accuracy: 69.78 %
Predictions - 1s: 76, 0s: 63
True Labels - 1s: 71, 0s: 68
Client 7 of 15: Local Epoch [3/3] Loss: 0.3378, Accuracy: 92.09 %
Predictions - 1s: 54, 0s: 85
True Labels - 1s: 63, 0s: 76
Client 15 of 15: Local Epoch [3/3] Loss: 0.3801, Accuracy: 89.21 %
Predictions - 1s: 44, 0s: 95
True Labels - 1s: 49, 0s: 90
Client 14 of 15: Local Epoch [3/3] Loss: 0.3095, Accuracy: 93.53 %
Predictions - 1s: 37, 0s: 102
True Labels - 1s: 49, 0s: 90
Client 6 of 15: Local Epoch [2/3] Loss: 0.4255, Accuracy: 84.17 %
Predictions - 1s: 64, 0s: 75
True Labels - 1s: 66, 0s: 73
Client 11 of 15: Local Epoch [2/3] Loss: 0.4063, Accuracy: 88.49 %
Predictions - 1s: 49, 0s: 90
True Labels - 1s: 57, 0s: 82
Client 5 of 15: Local Epoch [2/3] Loss: 0.4955, Accuracy: 78.42 %
Predictions - 1s: 45, 0s: 94
True Labels - 1s: 51, 0s: 88
Client 8 of 15: Local Epoch [2/3] Loss: 0.3841, Accuracy: 88.49 %
Predictions - 1s: 57, 0s: 82
True Labels - 1s: 60, 0s: 79
Client 13 of 15: Local Epoch [2/3] Loss: 0.4112, Accuracy: 87.77 %
Predictions - 1s: 46, 0s: 93
True Labels - 1s: 57, 0s: 82
Client 10 of 15: Local Epoch [2/3] Loss: 0.4849, Accuracy: 86.33 %
Predictions - 1s: 42, 0s: 97
True Labels - 1s: 53, 0s: 86
Client 4 of 15: Local Epoch [2/3] Loss: 0.4227, Accuracy: 84.89 %
Predictions - 1s: 51, 0s: 88
True Labels - 1s: 56, 0s: 83
Client 2 of 15: Local Epoch [2/3] Loss: 0.4846, Accuracy: 84.89 %
Predictions - 1s: 64, 0s: 75
True Labels - 1s: 65, 0s: 74
Client 9 of 15: Local Epoch [2/3] Loss: 0.4448, Accuracy: 84.89 %
Predictions - 1s: 43, 0s: 96
True Labels - 1s: 60, 0s: 79
Client 1 of 15: Local Epoch [2/3] Loss: 0.4966, Accuracy: 79.14 %
Predictions - 1s: 44, 0s: 95
True Labels - 1s: 49, 0s: 90
Client 6 of 15: Local Epoch [3/3] Loss: 0.3530, Accuracy: 86.33 %
Predictions - 1s: 63, 0s: 76
True Labels - 1s: 66, 0s: 73
Client 11 of 15: Local Epoch [3/3] Loss: 0.3265, Accuracy: 92.09 %
Predictions - 1s: 47, 0s: 92
True Labels - 1s: 51, 0s: 88
Client 8 of 15: Local Epoch [3/3] Loss: 0.3066, Accuracy: 89.93 %
Predictions - 1s: 44, 0s: 95
True Labels - 1s: 57, 0s: 82
Client 5 of 15: Local Epoch [3/3] Loss: 0.4201, Accuracy: 83.45 %
Predictions - 1s: 52, 0s: 87
True Labels - 1s: 60, 0s: 79
Client 13 of 15: Local Epoch [3/3] Loss: 0.3379, Accuracy: 89.93 %
Predictions - 1s: 49, 0s: 90
True Labels - 1s: 53, 0s: 86
Client 4 of 15: Local Epoch [3/3] Loss: 0.3576, Accuracy: 91.37 %
Predictions - 1s: 49, 0s: 90
True Labels - 1s: 57, 0s: 82
Client 10 of 15: Local Epoch [3/3] Loss: 0.4076, Accuracy: 84.17 %
Predictions - 1s: 45, 0s: 94
True Labels - 1s: 56, 0s: 83
Client 2 of 15: Local Epoch [3/3] Loss: 0.4025, Accuracy: 86.33 %
Predictions - 1s: 68, 0s: 71
True Labels - 1s: 65, 0s: 74
Client 9 of 15: Local Epoch [3/3] Loss: 0.3722, Accuracy: 89.21 %
Predictions - 1s: 53, 0s: 86
True Labels - 1s: 60, 0s: 79
Client 1 of 15: Local Epoch [3/3] Loss: 0.3983, Accuracy: 89.21 %
-------------------------------
Round [1/4] Average Local Loss: 0.3606, Average Local Accuracy: 89.06 %
-------------------------------
-------- Validation --------
Predictions - 1s: 166, 0s: 355
True Labels - 1s: 202, 0s: 319
Round [1/4] Global Model Validation Loss: 0.3874, Validation Accuracy: 85.41 %
-------- Validation finished --------
Updated best model in round 1 saved with Validation Loss: 0.3874 and Validation Accuracy: 85.41 %
-------------------------------

Round 2 of 4
-------------------------------
Predictions - 1s: 57, 0s: 82
True Labels - 1s: 63, 0s: 76
Client 15 of 15: Local Epoch [1/3] Loss: 0.4041, Accuracy: 84.17 %
Predictions - 1s: 56, 0s: 83
True Labels - 1s: 55, 0s: 84
Client 12 of 15: Local Epoch [1/3] Loss: 0.3814, Accuracy: 84.89 %
Predictions - 1s: 58, 0s: 81
True Labels - 1s: 60, 0s: 79
Client 1 of 15: Local Epoch [1/3] Loss: 0.3720, Accuracy: 87.05 %
Predictions - 1s: 64, 0s: 75
True Labels - 1s: 63, 0s: 76
Client 15 of 15: Local Epoch [2/3] Loss: 0.2894, Accuracy: 90.65 %
Predictions - 1s: 56, 0s: 83
True Labels - 1s: 55, 0s: 84
Client 12 of 15: Local Epoch [2/3] Loss: 0.2637, Accuracy: 90.65 %
Predictions - 1s: 55, 0s: 84
True Labels - 1s: 60, 0s: 79
Client 1 of 15: Local Epoch [2/3] Loss: 0.2408, Accuracy: 90.65 %
Predictions - 1s: 66, 0s: 73
True Labels - 1s: 63, 0s: 76
Client 15 of 15: Local Epoch [3/3] Loss: 0.2254, Accuracy: 93.53 %
Predictions - 1s: 62, 0s: 77
True Labels - 1s: 55, 0s: 84
Client 12 of 15: Local Epoch [3/3] Loss: 0.2103, Accuracy: 94.96 %
Predictions - 1s: 67, 0s: 72
True Labels - 1s: 66, 0s: 73
Client 11 of 15: Local Epoch [1/3] Loss: 0.3339, Accuracy: 87.77 %
Predictions - 1s: 57, 0s: 82
True Labels - 1s: 60, 0s: 79
Client 3 of 15: Local Epoch [1/3] Loss: 0.3442, Accuracy: 87.77 %
Predictions - 1s: 55, 0s: 84
True Labels - 1s: 65, 0s: 74
Client 9 of 15: Local Epoch [1/3] Loss: 0.4348, Accuracy: 79.86 %
Predictions - 1s: 42, 0s: 97
True Labels - 1s: 57, 0s: 82
Client 5 of 15: Local Epoch [1/3] Loss: 0.4407, Accuracy: 80.58 %
Predictions - 1s: 41, 0s: 98
True Labels - 1s: 49, 0s: 90
Client 14 of 15: Local Epoch [1/3] Loss: 0.3544, Accuracy: 85.61 %
Predictions - 1s: 40, 0s: 99
True Labels - 1s: 49, 0s: 90
Client 6 of 15: Local Epoch [1/3] Loss: 0.3617, Accuracy: 83.45 %
Predictions - 1s: 57, 0s: 82
True Labels - 1s: 60, 0s: 79
Client 13 of 15: Local Epoch [1/3] Loss: 0.3563, Accuracy: 86.33 %
Predictions - 1s: 48, 0s: 91
True Labels - 1s: 51, 0s: 88
Client 8 of 15: Local Epoch [1/3] Loss: 0.3189, Accuracy: 87.77 %
Predictions - 1s: 59, 0s: 80
True Labels - 1s: 57, 0s: 82
Client 10 of 15: Local Epoch [1/3] Loss: 0.3986, Accuracy: 85.61 %
Predictions - 1s: 56, 0s: 83
True Labels - 1s: 53, 0s: 86
Client 4 of 15: Local Epoch [1/3] Loss: 0.3698, Accuracy: 84.89 %
Predictions - 1s: 72, 0s: 67
True Labels - 1s: 71, 0s: 68
Client 7 of 15: Local Epoch [1/3] Loss: 0.3402, Accuracy: 89.21 %
Predictions - 1s: 49, 0s: 90
True Labels - 1s: 56, 0s: 83
Client 2 of 15: Local Epoch [1/3] Loss: 0.4131, Accuracy: 84.89 %
Predictions - 1s: 63, 0s: 76
True Labels - 1s: 60, 0s: 79
Client 1 of 15: Local Epoch [3/3] Loss: 0.1886, Accuracy: 94.96 %
Predictions - 1s: 70, 0s: 69
True Labels - 1s: 66, 0s: 73
Client 11 of 15: Local Epoch [2/3] Loss: 0.2409, Accuracy: 92.81 %
Predictions - 1s: 57, 0s: 82
True Labels - 1s: 60, 0s: 79
Client 3 of 15: Local Epoch [2/3] Loss: 0.2235, Accuracy: 92.09 %
Predictions - 1s: 56, 0s: 83
True Labels - 1s: 57, 0s: 82
Client 5 of 15: Local Epoch [2/3] Loss: 0.3905, Accuracy: 80.58 %
Predictions - 1s: 48, 0s: 91
True Labels - 1s: 51, 0s: 88
Client 8 of 15: Local Epoch [2/3] Loss: 0.2441, Accuracy: 92.09 %
Predictions - 1s: 70, 0s: 69
True Labels - 1s: 66, 0s: 73
Client 11 of 15: Local Epoch [3/3] Loss: 0.1866, Accuracy: 94.24 %
Predictions - 1s: 65, 0s: 74
True Labels - 1s: 60, 0s: 79
Client 3 of 15: Local Epoch [3/3] Loss: 0.1764, Accuracy: 94.96 %
Predictions - 1s: 51, 0s: 88
True Labels - 1s: 57, 0s: 82
Client 10 of 15: Local Epoch [2/3] Loss: 0.3019, Accuracy: 84.17 %
Predictions - 1s: 68, 0s: 71
True Labels - 1s: 71, 0s: 68
Client 7 of 15: Local Epoch [2/3] Loss: 0.2315, Accuracy: 92.09 %
Predictions - 1s: 55, 0s: 84
True Labels - 1s: 57, 0s: 82
Client 5 of 15: Local Epoch [3/3] Loss: 0.3216, Accuracy: 85.61 %
Predictions - 1s: 56, 0s: 83
True Labels - 1s: 60, 0s: 79
Client 13 of 15: Local Epoch [2/3] Loss: 0.2590, Accuracy: 91.37 %
Predictions - 1s: 73, 0s: 66
True Labels - 1s: 65, 0s: 74
Client 9 of 15: Local Epoch [2/3] Loss: 0.3069, Accuracy: 89.93 %
Predictions - 1s: 46, 0s: 93
True Labels - 1s: 49, 0s: 90
Client 14 of 15: Local Epoch [2/3] Loss: 0.2118, Accuracy: 92.09 %
Predictions - 1s: 51, 0s: 88
True Labels - 1s: 49, 0s: 90
Client 6 of 15: Local Epoch [2/3] Loss: 0.2695, Accuracy: 91.37 %
Predictions - 1s: 47, 0s: 92
True Labels - 1s: 53, 0s: 86
Client 4 of 15: Local Epoch [2/3] Loss: 0.2999, Accuracy: 88.49 %
Predictions - 1s: 52, 0s: 87
True Labels - 1s: 56, 0s: 83
Client 2 of 15: Local Epoch [2/3] Loss: 0.2976, Accuracy: 91.37 %
Predictions - 1s: 50, 0s: 89
True Labels - 1s: 51, 0s: 88
Client 8 of 15: Local Epoch [3/3] Loss: 0.1840, Accuracy: 93.53 %
Predictions - 1s: 73, 0s: 66
True Labels - 1s: 71, 0s: 68
Client 7 of 15: Local Epoch [3/3] Loss: 0.1629, Accuracy: 97.12 %
Predictions - 1s: 63, 0s: 76
True Labels - 1s: 57, 0s: 82
Client 10 of 15: Local Epoch [3/3] Loss: 0.2552, Accuracy: 88.49 %
Predictions - 1s: 60, 0s: 79
True Labels - 1s: 60, 0s: 79
Client 13 of 15: Local Epoch [3/3] Loss: 0.2128, Accuracy: 92.81 %
Predictions - 1s: 48, 0s: 91
True Labels - 1s: 49, 0s: 90
Client 14 of 15: Local Epoch [3/3] Loss: 0.1662, Accuracy: 96.40 %
Predictions - 1s: 65, 0s: 74
True Labels - 1s: 65, 0s: 74
Client 9 of 15: Local Epoch [3/3] Loss: 0.2678, Accuracy: 89.93 %
Predictions - 1s: 51, 0s: 88
True Labels - 1s: 56, 0s: 83
Client 2 of 15: Local Epoch [3/3] Loss: 0.2722, Accuracy: 90.65 %
Predictions - 1s: 48, 0s: 91
True Labels - 1s: 49, 0s: 90
Client 6 of 15: Local Epoch [3/3] Loss: 0.2112, Accuracy: 94.96 %
Predictions - 1s: 52, 0s: 87
True Labels - 1s: 53, 0s: 86
Client 4 of 15: Local Epoch [3/3] Loss: 0.2783, Accuracy: 87.77 %
-------------------------------
Round [2/4] Average Local Loss: 0.2213, Average Local Accuracy: 92.66 %
-------------------------------
-------- Validation --------
Predictions - 1s: 196, 0s: 325
True Labels - 1s: 202, 0s: 319
Round [2/4] Global Model Validation Loss: 0.2787, Validation Accuracy: 88.48 %
-------- Validation finished --------
Updated best model in round 2 saved with Validation Loss: 0.2787 and Validation Accuracy: 88.48 %
-------------------------------

Round 3 of 4
-------------------------------
Predictions - 1s: 74, 0s: 65
True Labels - 1s: 71, 0s: 68
Client 7 of 15: Local Epoch [1/3] Loss: 0.2082, Accuracy: 93.53 %
Predictions - 1s: 51, 0s: 88
True Labels - 1s: 49, 0s: 90
Client 6 of 15: Local Epoch [1/3] Loss: 0.2603, Accuracy: 88.49 %
Predictions - 1s: 55, 0s: 84
True Labels - 1s: 57, 0s: 82
Client 5 of 15: Local Epoch [1/3] Loss: 0.3819, Accuracy: 82.73 %
Predictions - 1s: 56, 0s: 83
True Labels - 1s: 60, 0s: 79
Client 13 of 15: Local Epoch [1/3] Loss: 0.2938, Accuracy: 88.49 %
Predictions - 1s: 60, 0s: 79
True Labels - 1s: 60, 0s: 79
Client 1 of 15: Local Epoch [1/3] Loss: 0.2629, Accuracy: 91.37 %
Predictions - 1s: 72, 0s: 67
True Labels - 1s: 71, 0s: 68
Client 7 of 15: Local Epoch [2/3] Loss: 0.1636, Accuracy: 94.96 %
Predictions - 1s: 50, 0s: 89
True Labels - 1s: 49, 0s: 90
Client 6 of 15: Local Epoch [2/3] Loss: 0.2138, Accuracy: 89.21 %
Predictions - 1s: 61, 0s: 78
True Labels - 1s: 57, 0s: 82
Client 5 of 15: Local Epoch [2/3] Loss: 0.3007, Accuracy: 87.05 %
Predictions - 1s: 60, 0s: 79
True Labels - 1s: 60, 0s: 79
Client 3 of 15: Local Epoch [1/3] Loss: 0.2279, Accuracy: 88.49 %
Predictions - 1s: 51, 0s: 88
True Labels - 1s: 56, 0s: 83
Client 2 of 15: Local Epoch [1/3] Loss: 0.3373, Accuracy: 89.21 %
Predictions - 1s: 61, 0s: 78
True Labels - 1s: 60, 0s: 79
Client 13 of 15: Local Epoch [2/3] Loss: 0.2114, Accuracy: 90.65 %
Predictions - 1s: 49, 0s: 90
True Labels - 1s: 49, 0s: 90
Client 14 of 15: Local Epoch [1/3] Loss: 0.2075, Accuracy: 94.24 %
Predictions - 1s: 71, 0s: 68
True Labels - 1s: 71, 0s: 68
Client 7 of 15: Local Epoch [3/3] Loss: 0.1295, Accuracy: 97.12 %
Predictions - 1s: 64, 0s: 75
True Labels - 1s: 60, 0s: 79
Client 1 of 15: Local Epoch [2/3] Loss: 0.1681, Accuracy: 95.68 %
Predictions - 1s: 72, 0s: 67
True Labels - 1s: 66, 0s: 73
Client 11 of 15: Local Epoch [1/3] Loss: 0.2337, Accuracy: 92.81 %
Predictions - 1s: 46, 0s: 93
True Labels - 1s: 51, 0s: 88
Client 8 of 15: Local Epoch [1/3] Loss: 0.2523, Accuracy: 90.65 %
Predictions - 1s: 60, 0s: 79
True Labels - 1s: 55, 0s: 84
Client 12 of 15: Local Epoch [1/3] Loss: 0.3173, Accuracy: 84.89 %
Predictions - 1s: 67, 0s: 72
True Labels - 1s: 63, 0s: 76
Client 15 of 15: Local Epoch [1/3] Loss: 0.2805, Accuracy: 88.49 %
Predictions - 1s: 51, 0s: 88
True Labels - 1s: 53, 0s: 86
Client 4 of 15: Local Epoch [1/3] Loss: 0.3510, Accuracy: 85.61 %
Predictions - 1s: 58, 0s: 81
True Labels - 1s: 57, 0s: 82
Client 10 of 15: Local Epoch [1/3] Loss: 0.3159, Accuracy: 86.33 %
Predictions - 1s: 65, 0s: 74
True Labels - 1s: 65, 0s: 74
Client 9 of 15: Local Epoch [1/3] Loss: 0.3430, Accuracy: 87.05 %
Predictions - 1s: 51, 0s: 88
True Labels - 1s: 49, 0s: 90
Client 6 of 15: Local Epoch [3/3] Loss: 0.1661, Accuracy: 95.68 %
Predictions - 1s: 55, 0s: 84
True Labels - 1s: 57, 0s: 82
Client 5 of 15: Local Epoch [3/3] Loss: 0.2789, Accuracy: 87.05 %
Predictions - 1s: 59, 0s: 80
True Labels - 1s: 60, 0s: 79
Client 3 of 15: Local Epoch [2/3] Loss: 0.1445, Accuracy: 92.09 %
Predictions - 1s: 59, 0s: 80
True Labels - 1s: 56, 0s: 83
Client 2 of 15: Local Epoch [2/3] Loss: 0.2662, Accuracy: 89.21 %
Predictions - 1s: 58, 0s: 81
True Labels - 1s: 60, 0s: 79
Client 13 of 15: Local Epoch [3/3] Loss: 0.1690, Accuracy: 92.81 %
Predictions - 1s: 50, 0s: 89
True Labels - 1s: 49, 0s: 90
Client 14 of 15: Local Epoch [2/3] Loss: 0.1720, Accuracy: 93.53 %
Predictions - 1s: 62, 0s: 77
True Labels - 1s: 60, 0s: 79
Client 1 of 15: Local Epoch [3/3] Loss: 0.1355, Accuracy: 97.12 %
Predictions - 1s: 70, 0s: 69
True Labels - 1s: 66, 0s: 73
Client 11 of 15: Local Epoch [2/3] Loss: 0.1824, Accuracy: 95.68 %
Predictions - 1s: 53, 0s: 86
True Labels - 1s: 51, 0s: 88
Client 8 of 15: Local Epoch [2/3] Loss: 0.1809, Accuracy: 92.81 %
Predictions - 1s: 63, 0s: 76
True Labels - 1s: 63, 0s: 76
Client 15 of 15: Local Epoch [2/3] Loss: 0.2204, Accuracy: 92.81 %
Predictions - 1s: 67, 0s: 72
True Labels - 1s: 65, 0s: 74
Client 9 of 15: Local Epoch [2/3] Loss: 0.2482, Accuracy: 91.37 %
Predictions - 1s: 52, 0s: 87
True Labels - 1s: 53, 0s: 86
Client 4 of 15: Local Epoch [2/3] Loss: 0.2619, Accuracy: 89.21 %
Predictions - 1s: 61, 0s: 78
True Labels - 1s: 60, 0s: 79
Client 3 of 15: Local Epoch [3/3] Loss: 0.1179, Accuracy: 97.84 %
Predictions - 1s: 58, 0s: 81
True Labels - 1s: 57, 0s: 82
Client 10 of 15: Local Epoch [2/3] Loss: 0.2147, Accuracy: 92.09 %
Predictions - 1s: 57, 0s: 82
True Labels - 1s: 55, 0s: 84
Client 12 of 15: Local Epoch [2/3] Loss: 0.2085, Accuracy: 91.37 %
Predictions - 1s: 51, 0s: 88
True Labels - 1s: 56, 0s: 83
Client 2 of 15: Local Epoch [3/3] Loss: 0.2142, Accuracy: 92.09 %
Predictions - 1s: 69, 0s: 70
True Labels - 1s: 66, 0s: 73
Client 11 of 15: Local Epoch [3/3] Loss: 0.1271, Accuracy: 96.40 %
Predictions - 1s: 51, 0s: 88
True Labels - 1s: 51, 0s: 88
Client 8 of 15: Local Epoch [3/3] Loss: 0.1361, Accuracy: 95.68 %
Predictions - 1s: 50, 0s: 89
True Labels - 1s: 49, 0s: 90
Client 14 of 15: Local Epoch [3/3] Loss: 0.1193, Accuracy: 97.84 %
Predictions - 1s: 64, 0s: 75
True Labels - 1s: 63, 0s: 76
Client 15 of 15: Local Epoch [3/3] Loss: 0.1620, Accuracy: 94.96 %
Predictions - 1s: 52, 0s: 87
True Labels - 1s: 53, 0s: 86
Client 4 of 15: Local Epoch [3/3] Loss: 0.2637, Accuracy: 87.77 %
Predictions - 1s: 67, 0s: 72
True Labels - 1s: 65, 0s: 74
Client 9 of 15: Local Epoch [3/3] Loss: 0.2390, Accuracy: 91.37 %
Predictions - 1s: 63, 0s: 76
True Labels - 1s: 55, 0s: 84
Client 12 of 15: Local Epoch [3/3] Loss: 0.1749, Accuracy: 94.24 %
Predictions - 1s: 61, 0s: 78
True Labels - 1s: 57, 0s: 82
Client 10 of 15: Local Epoch [3/3] Loss: 0.1801, Accuracy: 94.24 %
-------------------------------
Round [3/4] Average Local Loss: 0.1742, Average Local Accuracy: 94.15 %
-------------------------------
-------- Validation --------
Predictions - 1s: 193, 0s: 328
True Labels - 1s: 202, 0s: 319
Round [3/4] Global Model Validation Loss: 0.2530, Validation Accuracy: 89.44 %
-------- Validation finished --------
Updated best model in round 3 saved with Validation Loss: 0.2530 and Validation Accuracy: 89.44 %
-------------------------------

Round 4 of 4
-------------------------------
Predictions - 1s: 50, 0s: 89
True Labels - 1s: 51, 0s: 88
Client 8 of 15: Local Epoch [1/3] Loss: 0.2589, Accuracy: 86.33 %
Predictions - 1s: 63, 0s: 76
True Labels - 1s: 57, 0s: 82
Client 5 of 15: Local Epoch [1/3] Loss: 0.4167, Accuracy: 79.86 %
Predictions - 1s: 58, 0s: 81
True Labels - 1s: 63, 0s: 76
Client 15 of 15: Local Epoch [1/3] Loss: 0.2361, Accuracy: 90.65 %
Predictions - 1s: 52, 0s: 87
True Labels - 1s: 51, 0s: 88
Client 8 of 15: Local Epoch [2/3] Loss: 0.1597, Accuracy: 94.96 %
Predictions - 1s: 58, 0s: 81
True Labels - 1s: 57, 0s: 82
Client 10 of 15: Local Epoch [1/3] Loss: 0.2644, Accuracy: 89.21 %
Predictions - 1s: 59, 0s: 80
True Labels - 1s: 60, 0s: 79
Client 1 of 15: Local Epoch [1/3] Loss: 0.1948, Accuracy: 92.09 %
Predictions - 1s: 45, 0s: 94
True Labels - 1s: 57, 0s: 82
Client 5 of 15: Local Epoch [2/3] Loss: 0.3200, Accuracy: 85.61 %
Predictions - 1s: 54, 0s: 85
True Labels - 1s: 60, 0s: 79
Client 13 of 15: Local Epoch [1/3] Loss: 0.2567, Accuracy: 89.93 %
Predictions - 1s: 50, 0s: 89
True Labels - 1s: 49, 0s: 90
Client 6 of 15: Local Epoch [1/3] Loss: 0.2301, Accuracy: 90.65 %
Predictions - 1s: 65, 0s: 74
True Labels - 1s: 63, 0s: 76
Client 15 of 15: Local Epoch [2/3] Loss: 0.1837, Accuracy: 94.24 %
Predictions - 1s: 48, 0s: 91
True Labels - 1s: 49, 0s: 90
Client 14 of 15: Local Epoch [1/3] Loss: 0.1705, Accuracy: 93.53 %
Predictions - 1s: 55, 0s: 84
True Labels - 1s: 51, 0s: 88
Client 8 of 15: Local Epoch [3/3] Loss: 0.1003, Accuracy: 97.12 %
Predictions - 1s: 59, 0s: 80
True Labels - 1s: 57, 0s: 82
Client 10 of 15: Local Epoch [2/3] Loss: 0.1931, Accuracy: 92.81 %
Predictions - 1s: 49, 0s: 90
True Labels - 1s: 53, 0s: 86
Client 4 of 15: Local Epoch [1/3] Loss: 0.3769, Accuracy: 87.05 %
Predictions - 1s: 60, 0s: 79
Predictions - 1s: 60, 0s: 79
True Labels - 1s: 55, 0s: 84
Client 12 of 15: Local Epoch [1/3] Loss: 0.2543, Accuracy: 89.21 %
Predictions - 1s: 54, 0s: 85
True Labels - 1s: 60, 0s: 79
True Labels - 1s: 56, 0s: 83
Client 3 of 15: Local Epoch [1/3] Loss: 0.1944, Accuracy: 92.81 %
Client 2 of 15: Local Epoch [1/3] Loss: 0.3370, Accuracy: 87.05 %
Predictions - 1s: 64, 0s: 75
True Labels - 1s: 65, 0s: 74
Client 9 of 15: Local Epoch [1/3] Loss: 0.3043, Accuracy: 87.77 %
Predictions - 1s: 69, 0s: 70
True Labels - 1s: 71, 0s: 68
Client 7 of 15: Local Epoch [1/3] Loss: 0.2138, Accuracy: 91.37 %
Predictions - 1s: 70, 0s: 69
True Labels - 1s: 66, 0s: 73
Client 11 of 15: Local Epoch [1/3] Loss: 0.2009, Accuracy: 92.81 %
Predictions - 1s: 63, 0s: 76
True Labels - 1s: 60, 0s: 79
Client 1 of 15: Local Epoch [2/3] Loss: 0.1440, Accuracy: 94.96 %
Predictions - 1s: 60, 0s: 79
True Labels - 1s: 57, 0s: 82
Client 5 of 15: Local Epoch [3/3] Loss: 0.2489, Accuracy: 90.65 %
Predictions - 1s: 63, 0s: 76
True Labels - 1s: 60, 0s: 79
Client 13 of 15: Local Epoch [2/3] Loss: 0.1550, Accuracy: 93.53 %
Predictions - 1s: 61, 0s: 78
True Labels - 1s: 63, 0s: 76
Client 15 of 15: Local Epoch [3/3] Loss: 0.1635, Accuracy: 94.24 %
Predictions - 1s: 51, 0s: 88
True Labels - 1s: 49, 0s: 90
Client 6 of 15: Local Epoch [2/3] Loss: 0.1784, Accuracy: 94.24 %
Predictions - 1s: 50, 0s: 89
True Labels - 1s: 49, 0s: 90
Client 14 of 15: Local Epoch [2/3] Loss: 0.1218, Accuracy: 97.84 %
Predictions - 1s: 58, 0s: 81
True Labels - 1s: 57, 0s: 82
Client 10 of 15: Local Epoch [3/3] Loss: 0.1692, Accuracy: 93.53 %
Predictions - 1s: 63, 0s: 76
True Labels - 1s: 55, 0s: 84
Client 12 of 15: Local Epoch [2/3] Loss: 0.1901, Accuracy: 92.81 %
Predictions - 1s: 60, 0s: 79
True Labels - 1s: 60, 0s: 79
Client 1 of 15: Local Epoch [3/3] Loss: 0.0785, Accuracy: 98.56 %
Predictions - 1s: 55, 0s: 84
True Labels - 1s: 56, 0s: 83
Client 2 of 15: Local Epoch [2/3] Loss: 0.2371, Accuracy: 92.09 %
Predictions - 1s: 65, 0s: 74
True Labels - 1s: 65, 0s: 74
Client 9 of 15: Local Epoch [2/3] Loss: 0.2338, Accuracy: 91.37 %
Predictions - 1s: 70, 0s: 69
True Labels - 1s: 66, 0s: 73
Client 11 of 15: Local Epoch [2/3] Loss: 0.1497, Accuracy: 94.24 %
Predictions - 1s: 61, 0s: 78
True Labels - 1s: 60, 0s: 79
Client 13 of 15: Local Epoch [3/3] Loss: 0.1470, Accuracy: 94.96 %
Predictions - 1s: 57, 0s: 82
True Labels - 1s: 53, 0s: 86
Client 4 of 15: Local Epoch [2/3] Loss: 0.2772, Accuracy: 88.49 %
Predictions - 1s: 52, 0s: 87
True Labels - 1s: 49, 0s: 90
Client 6 of 15: Local Epoch [3/3] Loss: 0.1338, Accuracy: 96.40 %
Predictions - 1s: 74, 0s: 65
True Labels - 1s: 71, 0s: 68
Client 7 of 15: Local Epoch [2/3] Loss: 0.1270, Accuracy: 97.84 %
Predictions - 1s: 57, 0s: 82
True Labels - 1s: 60, 0s: 79
Client 3 of 15: Local Epoch [2/3] Loss: 0.1405, Accuracy: 94.96 %
Predictions - 1s: 49, 0s: 90
True Labels - 1s: 49, 0s: 90
Client 14 of 15: Local Epoch [3/3] Loss: 0.1005, Accuracy: 98.56 %
Predictions - 1s: 60, 0s: 79
True Labels - 1s: 55, 0s: 84
Client 12 of 15: Local Epoch [3/3] Loss: 0.1518, Accuracy: 92.09 %
Predictions - 1s: 58, 0s: 81
True Labels - 1s: 56, 0s: 83
Client 2 of 15: Local Epoch [3/3] Loss: 0.2024, Accuracy: 92.81 %
Predictions - 1s: 61, 0s: 78
True Labels - 1s: 65, 0s: 74
Client 9 of 15: Local Epoch [3/3] Loss: 0.1947, Accuracy: 94.24 %
Predictions - 1s: 67, 0s: 72
True Labels - 1s: 66, 0s: 73
Client 11 of 15: Local Epoch [3/3] Loss: 0.0926, Accuracy: 97.84 %
Predictions - 1s: 48, 0s: 91
True Labels - 1s: 53, 0s: 86
Client 4 of 15: Local Epoch [3/3] Loss: 0.2529, Accuracy: 90.65 %
Predictions - 1s: 62, 0s: 77
True Labels - 1s: 60, 0s: 79
Client 3 of 15: Local Epoch [3/3] Loss: 0.0795, Accuracy: 98.56 %
Predictions - 1s: 67, 0s: 72
True Labels - 1s: 71, 0s: 68
Client 7 of 15: Local Epoch [3/3] Loss: 0.1010, Accuracy: 95.68 %
-------------------------------
Round [4/4] Average Local Loss: 0.1478, Average Local Accuracy: 95.06 %
-------------------------------
-------- Validation --------
Predictions - 1s: 193, 0s: 328
True Labels - 1s: 202, 0s: 319
Round [4/4] Global Model Validation Loss: 0.2421, Validation Accuracy: 89.83 %
-------- Validation finished --------
Updated best model in round 4 saved with Validation Loss: 0.2421 and Validation Accuracy: 89.83 %
-------------------------------
Best model in round 4 saved with Validation Loss: 0.2421 and Validation Accuracy: 89.83 %

-------- Training finished in 11:23 --------

Test flag enabled. Testing the model

-------- Loading best model from model_path --------
Loaded model bert-small from date 23-04-2024 01:44. Trained with Federated Learning technology.
Round 4, lr: 6e-05, optimizer: AdamW
Average train accuracy: 95.06 %, Validation accuracy: 89.83 %
-------- Best model loaded --------

-------- Creating Test Dataloader --------
Test Loader: 650 total sentences. 82 batches of size 8.
-------- Test Dataloader created --------

-------- Testing --------
Predictions - 1s: 250, 0s: 400
True Labels - 1s: 268, 0s: 382
NÂº of test samples: 650
Accuracy: 88.62%
Accuracy 2 : 88.62%
Precision: 88.65%
Recall: 87.75%
F1 Score: 88.13%
Classification report:
              precision    recall  f1-score   support

           0     0.8850    0.9267    0.9054       382
           1     0.8880    0.8284    0.8571       268

    accuracy                         0.8862       650
   macro avg     0.8865    0.8775    0.8813       650
weighted avg     0.8862    0.8862    0.8855       650

-------- Testing finished --------
