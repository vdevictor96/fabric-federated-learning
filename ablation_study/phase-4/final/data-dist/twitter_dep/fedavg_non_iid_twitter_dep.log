Current configuration:
{
    "concurrency_flag": true,
    "data_distribution": "non_iid",
    "dataset": "twitter_dep_balanced",
    "device": "cuda",
    "dp_delta": 0.003,
    "dp_epsilon": 0,
    "eval_batch_size": 4,
    "eval_flag": true,
    "eval_size": 0.2,
    "fed_alg": "fedavg",
    "layers": 3,
    "learning_rate": 6e-05,
    "max_length": 512,
    "ml_mode": "bcfl",
    "model": "bert_small",
    "model_name": "fedavg_non_iid_twitter_dep",
    "models_path": "/local/vpaloma/fabric-federated-learning/ablation_study/phase-4/final/data-dist/twitter_dep",
    "mu": 0.5,
    "num_clients": 20,
    "num_epochs": 3,
    "num_rounds": 4,
    "optimizer": "AdamW",
    "progress_bar_flag": false,
    "save_model": true,
    "scheduler": "linear",
    "scheduler_warmup_steps": 0,
    "seed": "random",
    "test_flag": true,
    "train_batch_size": 4,
    "train_size": 0.8
}
-------- Configuration loaded --------

-------- Setting device --------
cuda device selected and available.
-------- Device set --------

-------- Setting seed --------
seed set:  72875
-------- Seed set --------

-------- Creating Model --------
-------- Model created --------

-------- Setting Trainable Layers --------
Training the last 3 layers.

Total parameters count: 28764674
Trainable parameters count: 3416066
-------- Trainable Layers set --------

-------- Creating Tokenizer --------
-------- Tokenizer created --------

-------- Creating Train and Eval Dataloaders --------
Train Loader: 1078 total sentences. 270 batches of size 4.
Eval Loader: 270 total sentences. 68 batches of size 4.
-------- Train and Eval Dataloaders created --------

-------- Training --------
Training with Blockchain-Based Federated Learning technology.
Training without differential privacy.
Federated averaging algorithm selected.
Client 0: Label 0: 0, Label 1: 55
Client 1: Label 0: 0, Label 1: 55
Client 2: Label 0: 0, Label 1: 55
Client 3: Label 0: 0, Label 1: 55
Client 4: Label 0: 0, Label 1: 55
Client 5: Label 0: 0, Label 1: 55
Client 6: Label 0: 0, Label 1: 55
Client 7: Label 0: 0, Label 1: 54
Client 8: Label 0: 0, Label 1: 54
Client 9: Label 0: 0, Label 1: 54
Client 10: Label 0: 53, Label 1: 1
Client 11: Label 0: 53, Label 1: 1
Client 12: Label 0: 53, Label 1: 1
Client 13: Label 0: 53, Label 1: 1
Client 14: Label 0: 53, Label 1: 1
Client 15: Label 0: 53, Label 1: 1
Client 16: Label 0: 53, Label 1: 1
Client 17: Label 0: 53, Label 1: 1
Client 18: Label 0: 53, Label 1: 1
Client 19: Label 0: 44, Label 1: 1

Round 1 of 4
-------------------------------
Predictions - 1s: 55, 0s: 0
True Labels - 1s: 55, 0s: 0
Client 3 of 20: Local Epoch [1/3] Loss: 0.2934, Accuracy: 100.00 %
Predictions - 1s: 55, 0s: 0
True Labels - 1s: 55, 0s: 0
Client 3 of 20: Local Epoch [2/3] Loss: 0.0677, Accuracy: 100.00 %
Predictions - 1s: 4, 0s: 50
True Labels - 1s: 1, 0s: 53
Client 15 of 20: Local Epoch [1/3] Loss: 0.3941, Accuracy: 90.74 %
Predictions - 1s: 55, 0s: 0
True Labels - 1s: 55, 0s: 0
Client 3 of 20: Local Epoch [3/3] Loss: 0.0438, Accuracy: 100.00 %
Predictions - 1s: 4, 0s: 50
True Labels - 1s: 1, 0s: 53
Client 14 of 20: Local Epoch [1/3] Loss: 0.3824, Accuracy: 90.74 %
Predictions - 1s: 0, 0s: 54
True Labels - 1s: 1, 0s: 53
Client 15 of 20: Local Epoch [2/3] Loss: 0.1370, Accuracy: 98.15 %
Predictions - 1s: 8, 0s: 37
True Labels - 1s: 1, 0s: 44
Client 20 of 20: Local Epoch [1/3] Loss: 0.4305, Accuracy: 80.00 %
Predictions - 1s: 4, 0s: 50
True Labels - 1s: 1, 0s: 53
Client 17 of 20: Local Epoch [1/3] Loss: 0.3756, Accuracy: 90.74 %
Predictions - 1s: 0, 0s: 54
True Labels - 1s: 1, 0s: 53
Client 14 of 20: Local Epoch [2/3] Loss: 0.1354, Accuracy: 98.15 %
Predictions - 1s: 3, 0s: 51
True Labels - 1s: 1, 0s: 53
Client 19 of 20: Local Epoch [1/3] Loss: 0.3673, Accuracy: 92.59 %
Predictions - 1s: 7, 0s: 47
True Labels - 1s: 1, 0s: 53
Client 18 of 20: Local Epoch [1/3] Loss: 0.3933, Accuracy: 85.19 %
Predictions - 1s: 54, 0s: 1
True Labels - 1s: 55, 0s: 0
Client 1 of 20: Local Epoch [1/3] Loss: 0.3073, Accuracy: 98.18 %
Predictions - 1s: 54, 0s: 0
True Labels - 1s: 54, 0s: 0
Client 10 of 20: Local Epoch [1/3] Loss: 0.2898, Accuracy: 100.00 %
Predictions - 1s: 5, 0s: 49
True Labels - 1s: 1, 0s: 53
Client 16 of 20: Local Epoch [1/3] Loss: 0.3896, Accuracy: 88.89 %
Predictions - 1s: 51, 0s: 3
True Labels - 1s: 54, 0s: 0
Client 9 of 20: Local Epoch [1/3] Loss: 0.3024, Accuracy: 94.44 %
Predictions - 1s: 4, 0s: 50
True Labels - 1s: 1, 0s: 53
Client 12 of 20: Local Epoch [1/3] Loss: 0.3719, Accuracy: 90.74 %
Predictions - 1s: 3, 0s: 51
True Labels - 1s: 1, 0s: 53
Client 11 of 20: Local Epoch [1/3] Loss: 0.3674, Accuracy: 92.59 %
Predictions - 1s: 52, 0s: 3
True Labels - 1s: 55, 0s: 0
Client 7 of 20: Local Epoch [1/3] Loss: 0.3131, Accuracy: 94.55 %
Predictions - 1s: 53, 0s: 2
True Labels - 1s: 55, 0s: 0
Client 6 of 20: Local Epoch [1/3] Loss: 0.2933, Accuracy: 96.36 %
Predictions - 1s: 7, 0s: 47
True Labels - 1s: 1, 0s: 53
Client 13 of 20: Local Epoch [1/3] Loss: 0.3789, Accuracy: 85.19 %
Predictions - 1s: 53, 0s: 2
True Labels - 1s: 55, 0s: 0
Client 4 of 20: Local Epoch [1/3] Loss: 0.3065, Accuracy: 96.36 %
Predictions - 1s: 51, 0s: 3
True Labels - 1s: 54, 0s: 0
Client 8 of 20: Local Epoch [1/3] Loss: 0.3006, Accuracy: 94.44 %
Predictions - 1s: 52, 0s: 3
True Labels - 1s: 55, 0s: 0
Client 5 of 20: Local Epoch [1/3] Loss: 0.3006, Accuracy: 94.55 %
Predictions - 1s: 54, 0s: 1
True Labels - 1s: 55, 0s: 0
Client 2 of 20: Local Epoch [1/3] Loss: 0.2926, Accuracy: 98.18 %
Predictions - 1s: 0, 0s: 54
True Labels - 1s: 1, 0s: 53
Client 15 of 20: Local Epoch [3/3] Loss: 0.1040, Accuracy: 98.15 %
Predictions - 1s: 0, 0s: 54
True Labels - 1s: 1, 0s: 53
Client 17 of 20: Local Epoch [2/3] Loss: 0.1482, Accuracy: 98.15 %
Predictions - 1s: 0, 0s: 54
True Labels - 1s: 1, 0s: 53
Client 19 of 20: Local Epoch [2/3] Loss: 0.1353, Accuracy: 98.15 %
Predictions - 1s: 0, 0s: 54
True Labels - 1s: 1, 0s: 53
Client 14 of 20: Local Epoch [3/3] Loss: 0.1065, Accuracy: 98.15 %
Predictions - 1s: 55, 0s: 0
True Labels - 1s: 55, 0s: 0
Client 1 of 20: Local Epoch [2/3] Loss: 0.0685, Accuracy: 100.00 %
Predictions - 1s: 0, 0s: 54
True Labels - 1s: 1, 0s: 53
Client 18 of 20: Local Epoch [2/3] Loss: 0.1385, Accuracy: 98.15 %
Predictions - 1s: 54, 0s: 0
True Labels - 1s: 54, 0s: 0
Client 9 of 20: Local Epoch [2/3] Loss: 0.0692, Accuracy: 100.00 %
Predictions - 1s: 0, 0s: 54
True Labels - 1s: 1, 0s: 53
Client 17 of 20: Local Epoch [3/3] Loss: 0.1180, Accuracy: 98.15 %
Predictions - 1s: 54, 0s: 0
True Labels - 1s: 54, 0s: 0
Client 8 of 20: Local Epoch [2/3] Loss: 0.0667, Accuracy: 100.00 %
Predictions - 1s: 54, 0s: 0
True Labels - 1s: 54, 0s: 0
Client 10 of 20: Local Epoch [2/3] Loss: 0.0661, Accuracy: 100.00 %
Predictions - 1s: 55, 0s: 0
True Labels - 1s: 55, 0s: 0
Client 1 of 20: Local Epoch [3/3] Loss: 0.0430, Accuracy: 100.00 %
Predictions - 1s: 0, 0s: 54
True Labels - 1s: 1, 0s: 53
Client 19 of 20: Local Epoch [3/3] Loss: 0.1003, Accuracy: 98.15 %
Predictions - 1s: 0, 0s: 45
True Labels - 1s: 1, 0s: 44
Client 20 of 20: Local Epoch [2/3] Loss: 0.1703, Accuracy: 97.78 %
Predictions - 1s: 0, 0s: 54
True Labels - 1s: 1, 0s: 53
Client 18 of 20: Local Epoch [3/3] Loss: 0.1138, Accuracy: 98.15 %
Predictions - 1s: 0, 0s: 54
True Labels - 1s: 1, 0s: 53
Client 13 of 20: Local Epoch [2/3] Loss: 0.1321, Accuracy: 98.15 %
Predictions - 1s: 55, 0s: 0
True Labels - 1s: 55, 0s: 0
Client 7 of 20: Local Epoch [2/3] Loss: 0.0695, Accuracy: 100.00 %
Predictions - 1s: 54, 0s: 0
True Labels - 1s: 54, 0s: 0
Client 9 of 20: Local Epoch [3/3] Loss: 0.0442, Accuracy: 100.00 %
Predictions - 1s: 0, 0s: 54
True Labels - 1s: 1, 0s: 53
Client 16 of 20: Local Epoch [2/3] Loss: 0.1469, Accuracy: 98.15 %
Predictions - 1s: 0, 0s: 54
True Labels - 1s: 1, 0s: 53
Client 11 of 20: Local Epoch [2/3] Loss: 0.1225, Accuracy: 98.15 %
Predictions - 1s: 54, 0s: 0
True Labels - 1s: 54, 0s: 0
Client 8 of 20: Local Epoch [3/3] Loss: 0.0436, Accuracy: 100.00 %
Predictions - 1s: 54, 0s: 0
True Labels - 1s: 54, 0s: 0
Client 10 of 20: Local Epoch [3/3] Loss: 0.0416, Accuracy: 100.00 %
Predictions - 1s: 0, 0s: 45
True Labels - 1s: 1, 0s: 44
Client 20 of 20: Local Epoch [3/3] Loss: 0.1364, Accuracy: 97.78 %
Predictions - 1s: 55, 0s: 0
True Labels - 1s: 55, 0s: 0
Client 6 of 20: Local Epoch [2/3] Loss: 0.0625, Accuracy: 100.00 %
Predictions - 1s: 55, 0s: 0
True Labels - 1s: 55, 0s: 0
Client 5 of 20: Local Epoch [2/3] Loss: 0.0683, Accuracy: 100.00 %
Predictions - 1s: 0, 0s: 54
True Labels - 1s: 1, 0s: 53
Client 12 of 20: Local Epoch [2/3] Loss: 0.1306, Accuracy: 98.15 %
Predictions - 1s: 55, 0s: 0
True Labels - 1s: 55, 0s: 0
Client 2 of 20: Local Epoch [2/3] Loss: 0.0653, Accuracy: 100.00 %
Predictions - 1s: 55, 0s: 0
True Labels - 1s: 55, 0s: 0
Client 4 of 20: Local Epoch [2/3] Loss: 0.0679, Accuracy: 100.00 %
Predictions - 1s: 0, 0s: 54
True Labels - 1s: 1, 0s: 53
Client 13 of 20: Local Epoch [3/3] Loss: 0.1031, Accuracy: 98.15 %
Predictions - 1s: 55, 0s: 0
True Labels - 1s: 55, 0s: 0
Client 7 of 20: Local Epoch [3/3] Loss: 0.0449, Accuracy: 100.00 %
Predictions - 1s: 0, 0s: 54
True Labels - 1s: 1, 0s: 53
Client 16 of 20: Local Epoch [3/3] Loss: 0.1134, Accuracy: 98.15 %
Predictions - 1s: 0, 0s: 54
True Labels - 1s: 1, 0s: 53
Client 11 of 20: Local Epoch [3/3] Loss: 0.0939, Accuracy: 98.15 %
Predictions - 1s: 55, 0s: 0
True Labels - 1s: 55, 0s: 0
Client 5 of 20: Local Epoch [3/3] Loss: 0.0421, Accuracy: 100.00 %
Predictions - 1s: 55, 0s: 0
True Labels - 1s: 55, 0s: 0
Client 6 of 20: Local Epoch [3/3] Loss: 0.0405, Accuracy: 100.00 %
Predictions - 1s: 55, 0s: 0
True Labels - 1s: 55, 0s: 0
Client 2 of 20: Local Epoch [3/3] Loss: 0.0421, Accuracy: 100.00 %
Predictions - 1s: 55, 0s: 0
True Labels - 1s: 55, 0s: 0
Client 4 of 20: Local Epoch [3/3] Loss: 0.0409, Accuracy: 100.00 %
Predictions - 1s: 0, 0s: 54
True Labels - 1s: 1, 0s: 53
Client 12 of 20: Local Epoch [3/3] Loss: 0.1072, Accuracy: 98.15 %
-------------------------------
Round [1/4] Average Local Loss: 0.0762, Average Local Accuracy: 99.06 %
-------------------------------
