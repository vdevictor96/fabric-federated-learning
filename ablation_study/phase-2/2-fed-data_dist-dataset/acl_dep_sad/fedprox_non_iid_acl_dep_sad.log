Current configuration:
{
    "concurrency_flag": false,
    "data_distribution": "non_iid",
    "dataset": "acl_dep_sad",
    "device": "cuda:1",
    "dp_delta": 0.003,
    "dp_epsilon": 0,
    "eval_batch_size": 4,
    "eval_flag": true,
    "eval_size": 0.2,
    "fed_alg": "fedprox",
    "layers": 3,
    "learning_rate": 6e-05,
    "max_length": 512,
    "ml_mode": "fl",
    "model": "bert_small",
    "model_name": "fedprox_non_iid_acl_dep_sad",
    "models_path": "/local/vpaloma/fabric-federated-learning/ablation_study/phase-2/2-fed-data_dist-dataset/acl_dep_sad",
    "mu": 1,
    "num_clients": 20,
    "num_epochs": 3,
    "num_rounds": 4,
    "optimizer": "AdamW",
    "progress_bar_flag": false,
    "save_model": true,
    "scheduler": "linear",
    "scheduler_warmup_steps": 0,
    "seed": 0,
    "test_flag": true,
    "train_batch_size": 4,
    "train_size": 0.8
}
-------- Configuration loaded --------

-------- Setting device --------
cuda:1 device selected and available.
-------- Device set --------

-------- Setting seed --------
-------- Seed set --------

-------- Creating Model --------
-------- Model created --------

-------- Setting Trainable Layers --------
Training the last 3 layers.

Total parameters count: 28764674
Trainable parameters count: 3416066
-------- Trainable Layers set --------

-------- Creating Tokenizer --------
-------- Tokenizer created --------

-------- Creating Train and Eval Dataloaders --------
Train Loader: 2085 total sentences. 522 batches of size 4.
Eval Loader: 521 total sentences. 131 batches of size 4.
-------- Train and Eval Dataloaders created --------

-------- Training --------
Training with Federated Learning technology.
Training without differential privacy.
Federated proximal algorithm selected.
Using mu value of 1.
Client 0: Label 0: 61, Label 1: 159
Client 1: Label 0: 61, Label 1: 83
Client 2: Label 0: 61, Label 1: 49
Client 3: Label 0: 61, Label 1: 93
Client 4: Label 0: 61, Label 1: 217
Client 5: Label 0: 61, Label 1: 34
Client 6: Label 0: 61, Label 1: 17
Client 7: Label 0: 61, Label 1: 100
Client 8: Label 0: 61, Label 1: 10
Client 9: Label 0: 61, Label 1: 10
Client 10: Label 0: 61, Label 1: 10
Client 11: Label 0: 61, Label 1: 10
Client 12: Label 0: 61, Label 1: 10
Client 13: Label 0: 60, Label 1: 10
Client 14: Label 0: 60, Label 1: 10
Client 15: Label 0: 60, Label 1: 10
Client 16: Label 0: 60, Label 1: 10
Client 17: Label 0: 60, Label 1: 10
Client 18: Label 0: 60, Label 1: 10
Client 19: Label 0: 60, Label 1: 10
Total samples: 2085
Total counted samples: 2085
Total label 0: 1213
Total label 1: 872
Total counted label 0: 1213
Total counted label 1: 872

Round 1 of 4
-------------------------------
Predictions - 1s: 203, 0s: 17
True Labels - 1s: 159, 0s: 61
Client 1 of 20: Local Epoch [1/3] Loss: 0.6251, Accuracy: 70.91 %
Predictions - 1s: 209, 0s: 11
True Labels - 1s: 159, 0s: 61
Client 1 of 20: Local Epoch [2/3] Loss: 0.5300, Accuracy: 76.36 %
Predictions - 1s: 201, 0s: 19
True Labels - 1s: 159, 0s: 61
Client 1 of 20: Local Epoch [3/3] Loss: 0.5154, Accuracy: 79.09 %
Predictions - 1s: 84, 0s: 60
True Labels - 1s: 83, 0s: 61
Client 2 of 20: Local Epoch [1/3] Loss: 0.6891, Accuracy: 63.19 %
Predictions - 1s: 88, 0s: 56
True Labels - 1s: 83, 0s: 61
Client 2 of 20: Local Epoch [2/3] Loss: 0.5917, Accuracy: 90.97 %
Predictions - 1s: 99, 0s: 45
True Labels - 1s: 83, 0s: 61
Client 2 of 20: Local Epoch [3/3] Loss: 0.5669, Accuracy: 83.33 %
Predictions - 1s: 11, 0s: 99
True Labels - 1s: 49, 0s: 61
Client 3 of 20: Local Epoch [1/3] Loss: 0.7086, Accuracy: 54.55 %
Predictions - 1s: 50, 0s: 60
True Labels - 1s: 49, 0s: 61
Client 3 of 20: Local Epoch [2/3] Loss: 0.6406, Accuracy: 79.09 %
Predictions - 1s: 41, 0s: 69
True Labels - 1s: 49, 0s: 61
Client 3 of 20: Local Epoch [3/3] Loss: 0.5997, Accuracy: 83.64 %
Predictions - 1s: 110, 0s: 44
True Labels - 1s: 93, 0s: 61
Client 4 of 20: Local Epoch [1/3] Loss: 0.6718, Accuracy: 68.18 %
Predictions - 1s: 116, 0s: 38
True Labels - 1s: 93, 0s: 61
Client 4 of 20: Local Epoch [2/3] Loss: 0.5790, Accuracy: 81.17 %
Predictions - 1s: 105, 0s: 49
True Labels - 1s: 93, 0s: 61
Client 4 of 20: Local Epoch [3/3] Loss: 0.5622, Accuracy: 83.12 %
Predictions - 1s: 267, 0s: 11
True Labels - 1s: 217, 0s: 61
Client 5 of 20: Local Epoch [1/3] Loss: 0.5496, Accuracy: 76.26 %
Predictions - 1s: 262, 0s: 16
True Labels - 1s: 217, 0s: 61
Client 5 of 20: Local Epoch [2/3] Loss: 0.4690, Accuracy: 82.37 %
Predictions - 1s: 253, 0s: 25
True Labels - 1s: 217, 0s: 61
Client 5 of 20: Local Epoch [3/3] Loss: 0.4363, Accuracy: 85.61 %
Predictions - 1s: 3, 0s: 92
True Labels - 1s: 34, 0s: 61
Client 6 of 20: Local Epoch [1/3] Loss: 0.6509, Accuracy: 65.26 %
Predictions - 1s: 8, 0s: 87
True Labels - 1s: 34, 0s: 61
Client 6 of 20: Local Epoch [2/3] Loss: 0.5951, Accuracy: 70.53 %
Predictions - 1s: 11, 0s: 84
True Labels - 1s: 34, 0s: 61
Client 6 of 20: Local Epoch [3/3] Loss: 0.5749, Accuracy: 71.58 %
Predictions - 1s: 0, 0s: 78
True Labels - 1s: 17, 0s: 61
Client 7 of 20: Local Epoch [1/3] Loss: 0.6044, Accuracy: 78.21 %
Predictions - 1s: 0, 0s: 78
True Labels - 1s: 17, 0s: 61
Client 7 of 20: Local Epoch [2/3] Loss: 0.4877, Accuracy: 78.21 %
Predictions - 1s: 0, 0s: 78
True Labels - 1s: 17, 0s: 61
Client 7 of 20: Local Epoch [3/3] Loss: 0.4925, Accuracy: 78.21 %
Predictions - 1s: 145, 0s: 16
True Labels - 1s: 100, 0s: 61
Client 8 of 20: Local Epoch [1/3] Loss: 0.6798, Accuracy: 65.84 %
Predictions - 1s: 125, 0s: 36
True Labels - 1s: 100, 0s: 61
Client 8 of 20: Local Epoch [2/3] Loss: 0.5962, Accuracy: 79.50 %
Predictions - 1s: 129, 0s: 32
True Labels - 1s: 100, 0s: 61
Client 8 of 20: Local Epoch [3/3] Loss: 0.5689, Accuracy: 75.78 %
Predictions - 1s: 1, 0s: 70
True Labels - 1s: 10, 0s: 61
Client 9 of 20: Local Epoch [1/3] Loss: 0.4758, Accuracy: 84.51 %
Predictions - 1s: 0, 0s: 71
True Labels - 1s: 10, 0s: 61
Client 9 of 20: Local Epoch [2/3] Loss: 0.4104, Accuracy: 85.92 %
Predictions - 1s: 0, 0s: 71
True Labels - 1s: 10, 0s: 61
Client 9 of 20: Local Epoch [3/3] Loss: 0.3941, Accuracy: 85.92 %
Predictions - 1s: 1, 0s: 70
True Labels - 1s: 10, 0s: 61
Client 10 of 20: Local Epoch [1/3] Loss: 0.4959, Accuracy: 84.51 %
Predictions - 1s: 0, 0s: 71
True Labels - 1s: 10, 0s: 61
Client 10 of 20: Local Epoch [2/3] Loss: 0.4295, Accuracy: 85.92 %
Predictions - 1s: 0, 0s: 71
True Labels - 1s: 10, 0s: 61
Client 10 of 20: Local Epoch [3/3] Loss: 0.4042, Accuracy: 85.92 %
Predictions - 1s: 1, 0s: 70
True Labels - 1s: 10, 0s: 61
Client 11 of 20: Local Epoch [1/3] Loss: 0.4649, Accuracy: 87.32 %
Predictions - 1s: 0, 0s: 71
True Labels - 1s: 10, 0s: 61
Client 11 of 20: Local Epoch [2/3] Loss: 0.3754, Accuracy: 85.92 %
Predictions - 1s: 0, 0s: 71
True Labels - 1s: 10, 0s: 61
Client 11 of 20: Local Epoch [3/3] Loss: 0.3565, Accuracy: 85.92 %
Predictions - 1s: 0, 0s: 71
True Labels - 1s: 10, 0s: 61
Client 12 of 20: Local Epoch [1/3] Loss: 0.4754, Accuracy: 85.92 %
Predictions - 1s: 0, 0s: 71
True Labels - 1s: 10, 0s: 61
Client 12 of 20: Local Epoch [2/3] Loss: 0.4173, Accuracy: 85.92 %
Predictions - 1s: 0, 0s: 71
True Labels - 1s: 10, 0s: 61
Client 12 of 20: Local Epoch [3/3] Loss: 0.3998, Accuracy: 85.92 %
Predictions - 1s: 0, 0s: 71
True Labels - 1s: 10, 0s: 61
Client 13 of 20: Local Epoch [1/3] Loss: 0.4903, Accuracy: 85.92 %
Predictions - 1s: 0, 0s: 71
True Labels - 1s: 10, 0s: 61
Client 13 of 20: Local Epoch [2/3] Loss: 0.4061, Accuracy: 85.92 %
Predictions - 1s: 0, 0s: 71
True Labels - 1s: 10, 0s: 61
Client 13 of 20: Local Epoch [3/3] Loss: 0.3939, Accuracy: 85.92 %
Predictions - 1s: 2, 0s: 68
True Labels - 1s: 10, 0s: 60
Client 14 of 20: Local Epoch [1/3] Loss: 0.4885, Accuracy: 82.86 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 14 of 20: Local Epoch [2/3] Loss: 0.4202, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 14 of 20: Local Epoch [3/3] Loss: 0.4045, Accuracy: 85.71 %
Predictions - 1s: 2, 0s: 68
True Labels - 1s: 10, 0s: 60
Client 15 of 20: Local Epoch [1/3] Loss: 0.4951, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 15 of 20: Local Epoch [2/3] Loss: 0.4180, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 15 of 20: Local Epoch [3/3] Loss: 0.4210, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 16 of 20: Local Epoch [1/3] Loss: 0.4884, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 16 of 20: Local Epoch [2/3] Loss: 0.4066, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 16 of 20: Local Epoch [3/3] Loss: 0.3844, Accuracy: 85.71 %
Predictions - 1s: 1, 0s: 69
True Labels - 1s: 10, 0s: 60
Client 17 of 20: Local Epoch [1/3] Loss: 0.4718, Accuracy: 84.29 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 17 of 20: Local Epoch [2/3] Loss: 0.4061, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 17 of 20: Local Epoch [3/3] Loss: 0.3920, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 18 of 20: Local Epoch [1/3] Loss: 0.5013, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 18 of 20: Local Epoch [2/3] Loss: 0.4114, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 18 of 20: Local Epoch [3/3] Loss: 0.3890, Accuracy: 85.71 %
Predictions - 1s: 2, 0s: 68
True Labels - 1s: 10, 0s: 60
Client 19 of 20: Local Epoch [1/3] Loss: 0.4789, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 19 of 20: Local Epoch [2/3] Loss: 0.4102, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 19 of 20: Local Epoch [3/3] Loss: 0.4016, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 20 of 20: Local Epoch [1/3] Loss: 0.4724, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 20 of 20: Local Epoch [2/3] Loss: 0.3949, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 20 of 20: Local Epoch [3/3] Loss: 0.3948, Accuracy: 85.71 %
-------------------------------
Round [1/4] Average Local Loss: 0.4526, Average Local Accuracy: 83.50 %
-------------------------------
-------- Validation --------
Predictions - 1s: 12, 0s: 509
True Labels - 1s: 202, 0s: 319
Round [1/4] Global Model Validation Loss: 0.5770, Validation Accuracy: 63.53 %
-------- Validation finished --------
Updated best model in round 1 saved with Validation Loss: 0.5770 and Validation Accuracy: 63.53 %
-------------------------------

Round 2 of 4
-------------------------------
Predictions - 1s: 186, 0s: 34
True Labels - 1s: 159, 0s: 61
Client 1 of 20: Local Epoch [1/3] Loss: 0.5542, Accuracy: 76.82 %
Predictions - 1s: 174, 0s: 46
True Labels - 1s: 159, 0s: 61
Client 1 of 20: Local Epoch [2/3] Loss: 0.4830, Accuracy: 86.82 %
Predictions - 1s: 183, 0s: 37
True Labels - 1s: 159, 0s: 61
Client 1 of 20: Local Epoch [3/3] Loss: 0.4437, Accuracy: 86.36 %
Predictions - 1s: 88, 0s: 56
True Labels - 1s: 83, 0s: 61
Client 2 of 20: Local Epoch [1/3] Loss: 0.6107, Accuracy: 77.08 %
Predictions - 1s: 79, 0s: 65
True Labels - 1s: 83, 0s: 61
Client 2 of 20: Local Epoch [2/3] Loss: 0.5177, Accuracy: 86.11 %
Predictions - 1s: 91, 0s: 53
True Labels - 1s: 83, 0s: 61
Client 2 of 20: Local Epoch [3/3] Loss: 0.4921, Accuracy: 87.50 %
Predictions - 1s: 28, 0s: 82
True Labels - 1s: 49, 0s: 61
Client 3 of 20: Local Epoch [1/3] Loss: 0.6097, Accuracy: 73.64 %
Predictions - 1s: 43, 0s: 67
True Labels - 1s: 49, 0s: 61
Client 3 of 20: Local Epoch [2/3] Loss: 0.5415, Accuracy: 85.45 %
Predictions - 1s: 44, 0s: 66
True Labels - 1s: 49, 0s: 61
Client 3 of 20: Local Epoch [3/3] Loss: 0.5084, Accuracy: 84.55 %
Predictions - 1s: 93, 0s: 61
True Labels - 1s: 93, 0s: 61
Client 4 of 20: Local Epoch [1/3] Loss: 0.6003, Accuracy: 76.62 %
Predictions - 1s: 96, 0s: 58
True Labels - 1s: 93, 0s: 61
Client 4 of 20: Local Epoch [2/3] Loss: 0.5250, Accuracy: 86.36 %
Predictions - 1s: 101, 0s: 53
True Labels - 1s: 93, 0s: 61
Client 4 of 20: Local Epoch [3/3] Loss: 0.4738, Accuracy: 88.31 %
Predictions - 1s: 238, 0s: 40
True Labels - 1s: 217, 0s: 61
Client 5 of 20: Local Epoch [1/3] Loss: 0.4866, Accuracy: 84.53 %
Predictions - 1s: 240, 0s: 38
True Labels - 1s: 217, 0s: 61
Client 5 of 20: Local Epoch [2/3] Loss: 0.3838, Accuracy: 90.29 %
Predictions - 1s: 237, 0s: 41
True Labels - 1s: 217, 0s: 61
Client 5 of 20: Local Epoch [3/3] Loss: 0.3660, Accuracy: 89.21 %
Predictions - 1s: 13, 0s: 82
True Labels - 1s: 34, 0s: 61
Client 6 of 20: Local Epoch [1/3] Loss: 0.5751, Accuracy: 73.68 %
Predictions - 1s: 16, 0s: 79
True Labels - 1s: 34, 0s: 61
Client 6 of 20: Local Epoch [2/3] Loss: 0.4924, Accuracy: 78.95 %
Predictions - 1s: 23, 0s: 72
True Labels - 1s: 34, 0s: 61
Client 6 of 20: Local Epoch [3/3] Loss: 0.4645, Accuracy: 84.21 %
Predictions - 1s: 3, 0s: 75
True Labels - 1s: 17, 0s: 61
Client 7 of 20: Local Epoch [1/3] Loss: 0.4863, Accuracy: 79.49 %
Predictions - 1s: 1, 0s: 77
True Labels - 1s: 17, 0s: 61
Client 7 of 20: Local Epoch [2/3] Loss: 0.4441, Accuracy: 79.49 %
Predictions - 1s: 2, 0s: 76
True Labels - 1s: 17, 0s: 61
Client 7 of 20: Local Epoch [3/3] Loss: 0.3934, Accuracy: 80.77 %
Predictions - 1s: 106, 0s: 55
True Labels - 1s: 100, 0s: 61
Client 8 of 20: Local Epoch [1/3] Loss: 0.6302, Accuracy: 73.91 %
Predictions - 1s: 113, 0s: 48
True Labels - 1s: 100, 0s: 61
Client 8 of 20: Local Epoch [2/3] Loss: 0.5375, Accuracy: 81.99 %
Predictions - 1s: 109, 0s: 52
True Labels - 1s: 100, 0s: 61
Client 8 of 20: Local Epoch [3/3] Loss: 0.5086, Accuracy: 83.23 %
Predictions - 1s: 0, 0s: 71
True Labels - 1s: 10, 0s: 61
Client 9 of 20: Local Epoch [1/3] Loss: 0.3911, Accuracy: 85.92 %
Predictions - 1s: 1, 0s: 70
True Labels - 1s: 10, 0s: 61
Client 9 of 20: Local Epoch [2/3] Loss: 0.3296, Accuracy: 87.32 %
Predictions - 1s: 1, 0s: 70
True Labels - 1s: 10, 0s: 61
Client 9 of 20: Local Epoch [3/3] Loss: 0.3040, Accuracy: 87.32 %
Predictions - 1s: 0, 0s: 71
True Labels - 1s: 10, 0s: 61
Client 10 of 20: Local Epoch [1/3] Loss: 0.3792, Accuracy: 85.92 %
Predictions - 1s: 0, 0s: 71
True Labels - 1s: 10, 0s: 61
Client 10 of 20: Local Epoch [2/3] Loss: 0.3318, Accuracy: 85.92 %
Predictions - 1s: 0, 0s: 71
True Labels - 1s: 10, 0s: 61
Client 10 of 20: Local Epoch [3/3] Loss: 0.3272, Accuracy: 85.92 %
Predictions - 1s: 0, 0s: 71
True Labels - 1s: 10, 0s: 61
Client 11 of 20: Local Epoch [1/3] Loss: 0.3711, Accuracy: 85.92 %
Predictions - 1s: 0, 0s: 71
True Labels - 1s: 10, 0s: 61
Client 11 of 20: Local Epoch [2/3] Loss: 0.3036, Accuracy: 85.92 %
Predictions - 1s: 0, 0s: 71
True Labels - 1s: 10, 0s: 61
Client 11 of 20: Local Epoch [3/3] Loss: 0.2916, Accuracy: 85.92 %
Predictions - 1s: 0, 0s: 71
True Labels - 1s: 10, 0s: 61
Client 12 of 20: Local Epoch [1/3] Loss: 0.4110, Accuracy: 85.92 %
Predictions - 1s: 0, 0s: 71
True Labels - 1s: 10, 0s: 61
Client 12 of 20: Local Epoch [2/3] Loss: 0.3513, Accuracy: 85.92 %
Predictions - 1s: 1, 0s: 70
True Labels - 1s: 10, 0s: 61
Client 12 of 20: Local Epoch [3/3] Loss: 0.3609, Accuracy: 87.32 %
Predictions - 1s: 0, 0s: 71
True Labels - 1s: 10, 0s: 61
Client 13 of 20: Local Epoch [1/3] Loss: 0.3720, Accuracy: 85.92 %
Predictions - 1s: 0, 0s: 71
True Labels - 1s: 10, 0s: 61
Client 13 of 20: Local Epoch [2/3] Loss: 0.3466, Accuracy: 85.92 %
Predictions - 1s: 0, 0s: 71
True Labels - 1s: 10, 0s: 61
Client 13 of 20: Local Epoch [3/3] Loss: 0.3277, Accuracy: 85.92 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 14 of 20: Local Epoch [1/3] Loss: 0.4036, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 14 of 20: Local Epoch [2/3] Loss: 0.3577, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 14 of 20: Local Epoch [3/3] Loss: 0.3393, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 15 of 20: Local Epoch [1/3] Loss: 0.4071, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 15 of 20: Local Epoch [2/3] Loss: 0.3559, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 15 of 20: Local Epoch [3/3] Loss: 0.3278, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 16 of 20: Local Epoch [1/3] Loss: 0.3752, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 16 of 20: Local Epoch [2/3] Loss: 0.3470, Accuracy: 85.71 %
Predictions - 1s: 1, 0s: 69
True Labels - 1s: 10, 0s: 60
Client 16 of 20: Local Epoch [3/3] Loss: 0.3123, Accuracy: 87.14 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 17 of 20: Local Epoch [1/3] Loss: 0.3700, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 17 of 20: Local Epoch [2/3] Loss: 0.3278, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 17 of 20: Local Epoch [3/3] Loss: 0.3147, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 18 of 20: Local Epoch [1/3] Loss: 0.3922, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 18 of 20: Local Epoch [2/3] Loss: 0.3636, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 18 of 20: Local Epoch [3/3] Loss: 0.3134, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 19 of 20: Local Epoch [1/3] Loss: 0.3863, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 19 of 20: Local Epoch [2/3] Loss: 0.3170, Accuracy: 85.71 %
Predictions - 1s: 4, 0s: 66
True Labels - 1s: 10, 0s: 60
Client 19 of 20: Local Epoch [3/3] Loss: 0.2745, Accuracy: 91.43 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 20 of 20: Local Epoch [1/3] Loss: 0.4198, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 20 of 20: Local Epoch [2/3] Loss: 0.3419, Accuracy: 85.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 20 of 20: Local Epoch [3/3] Loss: 0.3144, Accuracy: 85.71 %
-------------------------------
Round [2/4] Average Local Loss: 0.3729, Average Local Accuracy: 86.18 %
-------------------------------
-------- Validation --------
Predictions - 1s: 67, 0s: 454
True Labels - 1s: 202, 0s: 319
Round [2/4] Global Model Validation Loss: 0.4798, Validation Accuracy: 73.70 %
-------- Validation finished --------
Updated best model in round 2 saved with Validation Loss: 0.4798 and Validation Accuracy: 73.70 %
-------------------------------

Round 3 of 4
-------------------------------
Predictions - 1s: 167, 0s: 53
True Labels - 1s: 159, 0s: 61
Client 1 of 20: Local Epoch [1/3] Loss: 0.4792, Accuracy: 84.55 %
Predictions - 1s: 169, 0s: 51
True Labels - 1s: 159, 0s: 61
Client 1 of 20: Local Epoch [2/3] Loss: 0.3858, Accuracy: 91.82 %
Predictions - 1s: 166, 0s: 54
True Labels - 1s: 159, 0s: 61
Client 1 of 20: Local Epoch [3/3] Loss: 0.3783, Accuracy: 89.55 %
Predictions - 1s: 86, 0s: 58
True Labels - 1s: 83, 0s: 61
Client 2 of 20: Local Epoch [1/3] Loss: 0.4991, Accuracy: 85.42 %
Predictions - 1s: 82, 0s: 62
True Labels - 1s: 83, 0s: 61
Client 2 of 20: Local Epoch [2/3] Loss: 0.4173, Accuracy: 89.58 %
Predictions - 1s: 85, 0s: 59
True Labels - 1s: 83, 0s: 61
Client 2 of 20: Local Epoch [3/3] Loss: 0.4170, Accuracy: 88.89 %
Predictions - 1s: 44, 0s: 66
True Labels - 1s: 49, 0s: 61
Client 3 of 20: Local Epoch [1/3] Loss: 0.4903, Accuracy: 80.91 %
Predictions - 1s: 44, 0s: 66
True Labels - 1s: 49, 0s: 61
Client 3 of 20: Local Epoch [2/3] Loss: 0.4395, Accuracy: 86.36 %
Predictions - 1s: 46, 0s: 64
True Labels - 1s: 49, 0s: 61
Client 3 of 20: Local Epoch [3/3] Loss: 0.4313, Accuracy: 84.55 %
Predictions - 1s: 94, 0s: 60
True Labels - 1s: 93, 0s: 61
Client 4 of 20: Local Epoch [1/3] Loss: 0.5332, Accuracy: 79.87 %
Predictions - 1s: 104, 0s: 50
True Labels - 1s: 93, 0s: 61
Client 4 of 20: Local Epoch [2/3] Loss: 0.4431, Accuracy: 88.96 %
Predictions - 1s: 104, 0s: 50
True Labels - 1s: 93, 0s: 61
Client 4 of 20: Local Epoch [3/3] Loss: 0.4064, Accuracy: 90.26 %
Predictions - 1s: 232, 0s: 46
True Labels - 1s: 217, 0s: 61
Client 5 of 20: Local Epoch [1/3] Loss: 0.4105, Accuracy: 87.41 %
Predictions - 1s: 229, 0s: 49
True Labels - 1s: 217, 0s: 61
Client 5 of 20: Local Epoch [2/3] Loss: 0.3258, Accuracy: 92.81 %
Predictions - 1s: 234, 0s: 44
True Labels - 1s: 217, 0s: 61
Client 5 of 20: Local Epoch [3/3] Loss: 0.3057, Accuracy: 91.73 %
Predictions - 1s: 20, 0s: 75
True Labels - 1s: 34, 0s: 61
Client 6 of 20: Local Epoch [1/3] Loss: 0.4727, Accuracy: 81.05 %
Predictions - 1s: 23, 0s: 72
True Labels - 1s: 34, 0s: 61
Client 6 of 20: Local Epoch [2/3] Loss: 0.4099, Accuracy: 84.21 %
Predictions - 1s: 31, 0s: 64
True Labels - 1s: 34, 0s: 61
Client 6 of 20: Local Epoch [3/3] Loss: 0.3891, Accuracy: 88.42 %
Predictions - 1s: 7, 0s: 71
True Labels - 1s: 17, 0s: 61
Client 7 of 20: Local Epoch [1/3] Loss: 0.4189, Accuracy: 84.62 %
Predictions - 1s: 6, 0s: 72
True Labels - 1s: 17, 0s: 61
Client 7 of 20: Local Epoch [2/3] Loss: 0.3871, Accuracy: 85.90 %
Predictions - 1s: 11, 0s: 67
True Labels - 1s: 17, 0s: 61
Client 7 of 20: Local Epoch [3/3] Loss: 0.3521, Accuracy: 89.74 %
Predictions - 1s: 99, 0s: 62
True Labels - 1s: 100, 0s: 61
Client 8 of 20: Local Epoch [1/3] Loss: 0.5258, Accuracy: 80.75 %
Predictions - 1s: 107, 0s: 54
True Labels - 1s: 100, 0s: 61
Client 8 of 20: Local Epoch [2/3] Loss: 0.4750, Accuracy: 86.96 %
Predictions - 1s: 102, 0s: 59
True Labels - 1s: 100, 0s: 61
Client 8 of 20: Local Epoch [3/3] Loss: 0.4470, Accuracy: 88.82 %
Predictions - 1s: 1, 0s: 70
True Labels - 1s: 10, 0s: 61
Client 9 of 20: Local Epoch [1/3] Loss: 0.3198, Accuracy: 87.32 %
Predictions - 1s: 3, 0s: 68
True Labels - 1s: 10, 0s: 61
Client 9 of 20: Local Epoch [2/3] Loss: 0.2652, Accuracy: 90.14 %
Predictions - 1s: 2, 0s: 69
True Labels - 1s: 10, 0s: 61
Client 9 of 20: Local Epoch [3/3] Loss: 0.2735, Accuracy: 88.73 %
Predictions - 1s: 1, 0s: 70
True Labels - 1s: 10, 0s: 61
Client 10 of 20: Local Epoch [1/3] Loss: 0.3509, Accuracy: 87.32 %
Predictions - 1s: 2, 0s: 69
True Labels - 1s: 10, 0s: 61
Client 10 of 20: Local Epoch [2/3] Loss: 0.2690, Accuracy: 88.73 %
Predictions - 1s: 2, 0s: 69
True Labels - 1s: 10, 0s: 61
Client 10 of 20: Local Epoch [3/3] Loss: 0.2642, Accuracy: 88.73 %
Predictions - 1s: 0, 0s: 71
True Labels - 1s: 10, 0s: 61
Client 11 of 20: Local Epoch [1/3] Loss: 0.3215, Accuracy: 85.92 %
Predictions - 1s: 3, 0s: 68
True Labels - 1s: 10, 0s: 61
Client 11 of 20: Local Epoch [2/3] Loss: 0.2349, Accuracy: 90.14 %
Predictions - 1s: 3, 0s: 68
True Labels - 1s: 10, 0s: 61
Client 11 of 20: Local Epoch [3/3] Loss: 0.2274, Accuracy: 90.14 %
Predictions - 1s: 0, 0s: 71
True Labels - 1s: 10, 0s: 61
Client 12 of 20: Local Epoch [1/3] Loss: 0.3596, Accuracy: 85.92 %
Predictions - 1s: 4, 0s: 67
True Labels - 1s: 10, 0s: 61
Client 12 of 20: Local Epoch [2/3] Loss: 0.3248, Accuracy: 91.55 %
Predictions - 1s: 2, 0s: 69
True Labels - 1s: 10, 0s: 61
Client 12 of 20: Local Epoch [3/3] Loss: 0.2874, Accuracy: 88.73 %
Predictions - 1s: 1, 0s: 70
True Labels - 1s: 10, 0s: 61
Client 13 of 20: Local Epoch [1/3] Loss: 0.3444, Accuracy: 84.51 %
Predictions - 1s: 0, 0s: 71
True Labels - 1s: 10, 0s: 61
Client 13 of 20: Local Epoch [2/3] Loss: 0.2860, Accuracy: 85.92 %
Predictions - 1s: 4, 0s: 67
True Labels - 1s: 10, 0s: 61
Client 13 of 20: Local Epoch [3/3] Loss: 0.2664, Accuracy: 91.55 %
Predictions - 1s: 2, 0s: 68
True Labels - 1s: 10, 0s: 60
Client 14 of 20: Local Epoch [1/3] Loss: 0.3148, Accuracy: 85.71 %
Predictions - 1s: 2, 0s: 68
True Labels - 1s: 10, 0s: 60
Client 14 of 20: Local Epoch [2/3] Loss: 0.3075, Accuracy: 85.71 %
Predictions - 1s: 6, 0s: 64
True Labels - 1s: 10, 0s: 60
Client 14 of 20: Local Epoch [3/3] Loss: 0.2673, Accuracy: 91.43 %
Predictions - 1s: 1, 0s: 69
True Labels - 1s: 10, 0s: 60
Client 15 of 20: Local Epoch [1/3] Loss: 0.3435, Accuracy: 87.14 %
Predictions - 1s: 3, 0s: 67
True Labels - 1s: 10, 0s: 60
Client 15 of 20: Local Epoch [2/3] Loss: 0.2853, Accuracy: 90.00 %
Predictions - 1s: 3, 0s: 67
True Labels - 1s: 10, 0s: 60
Client 15 of 20: Local Epoch [3/3] Loss: 0.2721, Accuracy: 90.00 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 16 of 20: Local Epoch [1/3] Loss: 0.3759, Accuracy: 85.71 %
Predictions - 1s: 3, 0s: 67
True Labels - 1s: 10, 0s: 60
Client 16 of 20: Local Epoch [2/3] Loss: 0.2840, Accuracy: 90.00 %
Predictions - 1s: 3, 0s: 67
True Labels - 1s: 10, 0s: 60
Client 16 of 20: Local Epoch [3/3] Loss: 0.2805, Accuracy: 90.00 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 17 of 20: Local Epoch [1/3] Loss: 0.3285, Accuracy: 85.71 %
Predictions - 1s: 2, 0s: 68
True Labels - 1s: 10, 0s: 60
Client 17 of 20: Local Epoch [2/3] Loss: 0.2882, Accuracy: 88.57 %
Predictions - 1s: 2, 0s: 68
True Labels - 1s: 10, 0s: 60
Client 17 of 20: Local Epoch [3/3] Loss: 0.2629, Accuracy: 88.57 %
Predictions - 1s: 1, 0s: 69
True Labels - 1s: 10, 0s: 60
Client 18 of 20: Local Epoch [1/3] Loss: 0.3315, Accuracy: 87.14 %
Predictions - 1s: 1, 0s: 69
True Labels - 1s: 10, 0s: 60
Client 18 of 20: Local Epoch [2/3] Loss: 0.2825, Accuracy: 87.14 %
Predictions - 1s: 3, 0s: 67
True Labels - 1s: 10, 0s: 60
Client 18 of 20: Local Epoch [3/3] Loss: 0.2654, Accuracy: 90.00 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 19 of 20: Local Epoch [1/3] Loss: 0.3332, Accuracy: 85.71 %
Predictions - 1s: 2, 0s: 68
True Labels - 1s: 10, 0s: 60
Client 19 of 20: Local Epoch [2/3] Loss: 0.2748, Accuracy: 88.57 %
Predictions - 1s: 7, 0s: 63
True Labels - 1s: 10, 0s: 60
Client 19 of 20: Local Epoch [3/3] Loss: 0.2309, Accuracy: 95.71 %
Predictions - 1s: 0, 0s: 70
True Labels - 1s: 10, 0s: 60
Client 20 of 20: Local Epoch [1/3] Loss: 0.3156, Accuracy: 85.71 %
Predictions - 1s: 3, 0s: 67
True Labels - 1s: 10, 0s: 60
Client 20 of 20: Local Epoch [2/3] Loss: 0.2742, Accuracy: 90.00 %
Predictions - 1s: 2, 0s: 68
True Labels - 1s: 10, 0s: 60
Client 20 of 20: Local Epoch [3/3] Loss: 0.2497, Accuracy: 88.57 %
-------------------------------
Round [3/4] Average Local Loss: 0.3137, Average Local Accuracy: 89.71 %
-------------------------------
-------- Validation --------
Predictions - 1s: 131, 0s: 390
True Labels - 1s: 202, 0s: 319
Round [3/4] Global Model Validation Loss: 0.3922, Validation Accuracy: 81.38 %
-------- Validation finished --------
Updated best model in round 3 saved with Validation Loss: 0.3922 and Validation Accuracy: 81.38 %
-------------------------------

Round 4 of 4
-------------------------------
Predictions - 1s: 169, 0s: 51
True Labels - 1s: 159, 0s: 61
Client 1 of 20: Local Epoch [1/3] Loss: 0.4245, Accuracy: 87.27 %
Predictions - 1s: 167, 0s: 53
True Labels - 1s: 159, 0s: 61
Client 1 of 20: Local Epoch [2/3] Loss: 0.3295, Accuracy: 91.82 %
Predictions - 1s: 162, 0s: 58
True Labels - 1s: 159, 0s: 61
Client 1 of 20: Local Epoch [3/3] Loss: 0.3199, Accuracy: 93.18 %
Predictions - 1s: 81, 0s: 63
True Labels - 1s: 83, 0s: 61
Client 2 of 20: Local Epoch [1/3] Loss: 0.4591, Accuracy: 86.11 %
Predictions - 1s: 81, 0s: 63
True Labels - 1s: 83, 0s: 61
Client 2 of 20: Local Epoch [2/3] Loss: 0.3631, Accuracy: 91.67 %
Predictions - 1s: 87, 0s: 57
True Labels - 1s: 83, 0s: 61
Client 2 of 20: Local Epoch [3/3] Loss: 0.3399, Accuracy: 91.67 %
Predictions - 1s: 47, 0s: 63
True Labels - 1s: 49, 0s: 61
Client 3 of 20: Local Epoch [1/3] Loss: 0.4676, Accuracy: 83.64 %
Predictions - 1s: 44, 0s: 66
True Labels - 1s: 49, 0s: 61
Client 3 of 20: Local Epoch [2/3] Loss: 0.3498, Accuracy: 86.36 %
Predictions - 1s: 47, 0s: 63
True Labels - 1s: 49, 0s: 61
Client 3 of 20: Local Epoch [3/3] Loss: 0.3571, Accuracy: 89.09 %
Predictions - 1s: 97, 0s: 57
True Labels - 1s: 93, 0s: 61
Client 4 of 20: Local Epoch [1/3] Loss: 0.4219, Accuracy: 87.01 %
Predictions - 1s: 95, 0s: 59
True Labels - 1s: 93, 0s: 61
Client 4 of 20: Local Epoch [2/3] Loss: 0.3636, Accuracy: 89.61 %
Predictions - 1s: 96, 0s: 58
True Labels - 1s: 93, 0s: 61
Client 4 of 20: Local Epoch [3/3] Loss: 0.3262, Accuracy: 92.86 %
Predictions - 1s: 227, 0s: 51
True Labels - 1s: 217, 0s: 61
Client 5 of 20: Local Epoch [1/3] Loss: 0.3091, Accuracy: 91.37 %
Predictions - 1s: 225, 0s: 53
True Labels - 1s: 217, 0s: 61
Client 5 of 20: Local Epoch [2/3] Loss: 0.2524, Accuracy: 92.81 %
Predictions - 1s: 219, 0s: 59
True Labels - 1s: 217, 0s: 61
Client 5 of 20: Local Epoch [3/3] Loss: 0.2402, Accuracy: 95.68 %
Predictions - 1s: 26, 0s: 69
True Labels - 1s: 34, 0s: 61
Client 6 of 20: Local Epoch [1/3] Loss: 0.4099, Accuracy: 83.16 %
Predictions - 1s: 28, 0s: 67
True Labels - 1s: 34, 0s: 61
Client 6 of 20: Local Epoch [2/3] Loss: 0.3679, Accuracy: 87.37 %
Predictions - 1s: 34, 0s: 61
True Labels - 1s: 34, 0s: 61
Client 6 of 20: Local Epoch [3/3] Loss: 0.3131, Accuracy: 91.58 %
Predictions - 1s: 10, 0s: 68
True Labels - 1s: 17, 0s: 61
Client 7 of 20: Local Epoch [1/3] Loss: 0.3827, Accuracy: 83.33 %
Predictions - 1s: 11, 0s: 67
True Labels - 1s: 17, 0s: 61
Client 7 of 20: Local Epoch [2/3] Loss: 0.3219, Accuracy: 89.74 %
Predictions - 1s: 10, 0s: 68
True Labels - 1s: 17, 0s: 61
Client 7 of 20: Local Epoch [3/3] Loss: 0.3017, Accuracy: 88.46 %
Predictions - 1s: 103, 0s: 58
True Labels - 1s: 100, 0s: 61
Client 8 of 20: Local Epoch [1/3] Loss: 0.4744, Accuracy: 80.75 %
Predictions - 1s: 105, 0s: 56
True Labels - 1s: 100, 0s: 61
Client 8 of 20: Local Epoch [2/3] Loss: 0.4398, Accuracy: 86.96 %
Predictions - 1s: 97, 0s: 64
True Labels - 1s: 100, 0s: 61
Client 8 of 20: Local Epoch [3/3] Loss: 0.4091, Accuracy: 88.20 %
Predictions - 1s: 5, 0s: 66
True Labels - 1s: 10, 0s: 61
Client 9 of 20: Local Epoch [1/3] Loss: 0.3153, Accuracy: 87.32 %
Predictions - 1s: 5, 0s: 66
True Labels - 1s: 10, 0s: 61
Client 9 of 20: Local Epoch [2/3] Loss: 0.2377, Accuracy: 92.96 %
Predictions - 1s: 6, 0s: 65
True Labels - 1s: 10, 0s: 61
Client 9 of 20: Local Epoch [3/3] Loss: 0.2243, Accuracy: 91.55 %
Predictions - 1s: 2, 0s: 69
True Labels - 1s: 10, 0s: 61
Client 10 of 20: Local Epoch [1/3] Loss: 0.2617, Accuracy: 88.73 %
Predictions - 1s: 8, 0s: 63
True Labels - 1s: 10, 0s: 61
Client 10 of 20: Local Epoch [2/3] Loss: 0.2189, Accuracy: 94.37 %
Predictions - 1s: 8, 0s: 63
True Labels - 1s: 10, 0s: 61
Client 10 of 20: Local Epoch [3/3] Loss: 0.1885, Accuracy: 97.18 %
Predictions - 1s: 4, 0s: 67
True Labels - 1s: 10, 0s: 61
Client 11 of 20: Local Epoch [1/3] Loss: 0.2298, Accuracy: 91.55 %
Predictions - 1s: 6, 0s: 65
True Labels - 1s: 10, 0s: 61
Client 11 of 20: Local Epoch [2/3] Loss: 0.1968, Accuracy: 94.37 %
Predictions - 1s: 9, 0s: 62
True Labels - 1s: 10, 0s: 61
Client 11 of 20: Local Epoch [3/3] Loss: 0.2003, Accuracy: 95.77 %
Predictions - 1s: 3, 0s: 68
True Labels - 1s: 10, 0s: 61
Client 12 of 20: Local Epoch [1/3] Loss: 0.3130, Accuracy: 90.14 %
Predictions - 1s: 3, 0s: 68
True Labels - 1s: 10, 0s: 61
Client 12 of 20: Local Epoch [2/3] Loss: 0.3169, Accuracy: 90.14 %
Predictions - 1s: 4, 0s: 67
True Labels - 1s: 10, 0s: 61
Client 12 of 20: Local Epoch [3/3] Loss: 0.2606, Accuracy: 91.55 %
Predictions - 1s: 4, 0s: 67
True Labels - 1s: 10, 0s: 61
Client 13 of 20: Local Epoch [1/3] Loss: 0.2766, Accuracy: 85.92 %
Predictions - 1s: 6, 0s: 65
True Labels - 1s: 10, 0s: 61
Client 13 of 20: Local Epoch [2/3] Loss: 0.2280, Accuracy: 94.37 %
Predictions - 1s: 6, 0s: 65
True Labels - 1s: 10, 0s: 61
Client 13 of 20: Local Epoch [3/3] Loss: 0.2391, Accuracy: 94.37 %
Predictions - 1s: 6, 0s: 64
True Labels - 1s: 10, 0s: 60
Client 14 of 20: Local Epoch [1/3] Loss: 0.3469, Accuracy: 88.57 %
Predictions - 1s: 4, 0s: 66
True Labels - 1s: 10, 0s: 60
Client 14 of 20: Local Epoch [2/3] Loss: 0.2822, Accuracy: 88.57 %
Predictions - 1s: 9, 0s: 61
True Labels - 1s: 10, 0s: 60
Client 14 of 20: Local Epoch [3/3] Loss: 0.2252, Accuracy: 95.71 %
Predictions - 1s: 4, 0s: 66
True Labels - 1s: 10, 0s: 60
Client 15 of 20: Local Epoch [1/3] Loss: 0.3201, Accuracy: 85.71 %
Predictions - 1s: 7, 0s: 63
True Labels - 1s: 10, 0s: 60
Client 15 of 20: Local Epoch [2/3] Loss: 0.2600, Accuracy: 90.00 %
Predictions - 1s: 6, 0s: 64
True Labels - 1s: 10, 0s: 60
Client 15 of 20: Local Epoch [3/3] Loss: 0.2331, Accuracy: 91.43 %
Predictions - 1s: 7, 0s: 63
True Labels - 1s: 10, 0s: 60
Client 16 of 20: Local Epoch [1/3] Loss: 0.2598, Accuracy: 92.86 %
Predictions - 1s: 5, 0s: 65
True Labels - 1s: 10, 0s: 60
Client 16 of 20: Local Epoch [2/3] Loss: 0.2361, Accuracy: 90.00 %
Predictions - 1s: 6, 0s: 64
True Labels - 1s: 10, 0s: 60
Client 16 of 20: Local Epoch [3/3] Loss: 0.2263, Accuracy: 91.43 %
Predictions - 1s: 7, 0s: 63
True Labels - 1s: 10, 0s: 60
Client 17 of 20: Local Epoch [1/3] Loss: 0.2820, Accuracy: 90.00 %
Predictions - 1s: 6, 0s: 64
True Labels - 1s: 10, 0s: 60
Client 17 of 20: Local Epoch [2/3] Loss: 0.2379, Accuracy: 91.43 %
Predictions - 1s: 8, 0s: 62
True Labels - 1s: 10, 0s: 60
Client 17 of 20: Local Epoch [3/3] Loss: 0.2144, Accuracy: 94.29 %
Predictions - 1s: 3, 0s: 67
True Labels - 1s: 10, 0s: 60
Client 18 of 20: Local Epoch [1/3] Loss: 0.2677, Accuracy: 90.00 %
Predictions - 1s: 4, 0s: 66
True Labels - 1s: 10, 0s: 60
Client 18 of 20: Local Epoch [2/3] Loss: 0.2475, Accuracy: 91.43 %
Predictions - 1s: 4, 0s: 66
True Labels - 1s: 10, 0s: 60
Client 18 of 20: Local Epoch [3/3] Loss: 0.2213, Accuracy: 91.43 %
Predictions - 1s: 5, 0s: 65
True Labels - 1s: 10, 0s: 60
Client 19 of 20: Local Epoch [1/3] Loss: 0.2382, Accuracy: 92.86 %
Predictions - 1s: 9, 0s: 61
True Labels - 1s: 10, 0s: 60
Client 19 of 20: Local Epoch [2/3] Loss: 0.2117, Accuracy: 95.71 %
Predictions - 1s: 5, 0s: 65
True Labels - 1s: 10, 0s: 60
Client 19 of 20: Local Epoch [3/3] Loss: 0.1949, Accuracy: 92.86 %
Predictions - 1s: 6, 0s: 64
True Labels - 1s: 10, 0s: 60
Client 20 of 20: Local Epoch [1/3] Loss: 0.2742, Accuracy: 88.57 %
Predictions - 1s: 6, 0s: 64
True Labels - 1s: 10, 0s: 60
Client 20 of 20: Local Epoch [2/3] Loss: 0.2426, Accuracy: 94.29 %
Predictions - 1s: 7, 0s: 63
True Labels - 1s: 10, 0s: 60
Client 20 of 20: Local Epoch [3/3] Loss: 0.2288, Accuracy: 92.86 %
-------------------------------
Round [4/4] Average Local Loss: 0.2632, Average Local Accuracy: 92.56 %
-------------------------------
-------- Validation --------
Predictions - 1s: 152, 0s: 369
True Labels - 1s: 202, 0s: 319
Round [4/4] Global Model Validation Loss: 0.3365, Validation Accuracy: 83.49 %
-------- Validation finished --------
Updated best model in round 4 saved with Validation Loss: 0.3365 and Validation Accuracy: 83.49 %
-------------------------------
Best model in round 4 saved with Validation Loss: 0.3365 and Validation Accuracy: 83.49 %

-------- Training finished in 2:57 --------

Test flag enabled. Testing the model

-------- Loading best model from model_path --------
Loaded model bert-small from date 16-03-2024 15:21. Trained with Federated Learning technology.
Round 4, lr: 6e-05, optimizer: AdamW
Average train accuracy: 92.56 %, Validation accuracy: 83.49 %
-------- Best model loaded --------

-------- Creating Test Dataloader --------
Test Loader: 650 total sentences. 82 batches of size 8.
-------- Test Dataloader created --------

-------- Testing --------
Predictions - 1s: 182, 0s: 468
True Labels - 1s: 268, 0s: 382
Nº of test samples: 650
Accuracy: 83.08%
Accuracy 2 : 83.08%
Precision: 86.23%
Recall: 80.15%
F1 Score: 81.31%
Classification report:
              precision    recall  f1-score   support

           0     0.7906    0.9686    0.8706       382
           1     0.9341    0.6343    0.7556       268

    accuracy                         0.8308       650
   macro avg     0.8623    0.8015    0.8131       650
weighted avg     0.8498    0.8308    0.8232       650

-------- Testing finished --------
