Current configuration:
{
    "concurrency_flag": false,
    "data_distribution": "iid",
    "dataset": "acl_dep_sad",
    "device": "cuda",
    "dp_delta": 0.003,
    "dp_epsilon": 0.5,
    "eval_batch_size": 4,
    "eval_flag": true,
    "eval_size": 0.2,
    "fed_alg": "fedavg",
    "layers": 3,
    "learning_rate": 0.06,
    "max_length": 512,
    "ml_mode": "fl",
    "model": "bert_small",
    "model_name": "fl_0.5_seed2_acl_dep_sad",
    "models_path": "/local/vpaloma/fabric-federated-learning/ablation_study/phase-2/1-ml_mode-dataset-dp/acl_dep_sad",
    "mu": 0.5,
    "num_clients": 5,
    "num_epochs": 3,
    "num_rounds": 4,
    "optimizer": "AdamW",
    "progress_bar_flag": false,
    "save_model": true,
    "scheduler": "linear",
    "scheduler_warmup_steps": 0,
    "seed": 221,
    "test_flag": true,
    "train_batch_size": 2,
    "train_size": 0.8
}
-------- Configuration loaded --------

-------- Setting device --------
cuda device selected and available.
-------- Device set --------

-------- Setting seed --------
-------- Seed set --------

-------- Creating Model --------
-------- Model created --------

-------- Setting Trainable Layers --------
Training the last 3 layers.

Total parameters count: 28764674
Trainable parameters count: 3416066
-------- Trainable Layers set --------

-------- Creating Tokenizer --------
-------- Tokenizer created --------

-------- Creating Train and Eval Dataloaders --------
Train Loader: 2085 total sentences. 1043 batches of size 2.
Eval Loader: 521 total sentences. 131 batches of size 4.
-------- Train and Eval Dataloaders created --------

-------- Training --------
Training with Federated Learning technology.
Training with differential privacy.
Federated averaging algorithm selected.

Round 1 of 4
-------------------------------
Predictions - 1s: 231, 0s: 186
True Labels - 1s: 192, 0s: 225
Predictions - Proportion of 1s: 0.5539568345323741, Proportion of 0s: 0.4460431654676259
True Labels - Proportion of 1s: 0.460431654676259, Proportion of 0s: 0.539568345323741
Client 1 of 5: Local Epoch [1/3] Loss: 5.3314, Accuracy: 50.84 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 259, 0s: 158
True Labels - 1s: 192, 0s: 225
Predictions - Proportion of 1s: 0.6211031175059952, Proportion of 0s: 0.37889688249400477
True Labels - Proportion of 1s: 0.460431654676259, Proportion of 0s: 0.539568345323741
Client 1 of 5: Local Epoch [2/3] Loss: 9.2118, Accuracy: 49.40 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 180, 0s: 237
True Labels - 1s: 192, 0s: 225
Predictions - Proportion of 1s: 0.4316546762589928, Proportion of 0s: 0.5683453237410072
True Labels - Proportion of 1s: 0.460431654676259, Proportion of 0s: 0.539568345323741
Client 1 of 5: Local Epoch [3/3] Loss: 8.6064, Accuracy: 48.68 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 156, 0s: 261
True Labels - 1s: 181, 0s: 236
Predictions - Proportion of 1s: 0.37410071942446044, Proportion of 0s: 0.6258992805755396
True Labels - Proportion of 1s: 0.434052757793765, Proportion of 0s: 0.565947242206235
Client 2 of 5: Local Epoch [1/3] Loss: 6.9009, Accuracy: 50.84 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 119, 0s: 298
True Labels - 1s: 181, 0s: 236
Predictions - Proportion of 1s: 0.2853717026378897, Proportion of 0s: 0.7146282973621103
True Labels - Proportion of 1s: 0.434052757793765, Proportion of 0s: 0.565947242206235
Client 2 of 5: Local Epoch [2/3] Loss: 8.2373, Accuracy: 52.04 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 189, 0s: 228
True Labels - 1s: 181, 0s: 236
Predictions - Proportion of 1s: 0.45323741007194246, Proportion of 0s: 0.5467625899280576
True Labels - Proportion of 1s: 0.434052757793765, Proportion of 0s: 0.565947242206235
Client 2 of 5: Local Epoch [3/3] Loss: 6.9927, Accuracy: 50.60 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 141, 0s: 276
True Labels - 1s: 158, 0s: 259
Predictions - Proportion of 1s: 0.3381294964028777, Proportion of 0s: 0.6618705035971223
True Labels - Proportion of 1s: 0.37889688249400477, Proportion of 0s: 0.6211031175059952
Client 3 of 5: Local Epoch [1/3] Loss: 5.4646, Accuracy: 57.07 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 158, 0s: 259
True Labels - 1s: 158, 0s: 259
Predictions - Proportion of 1s: 0.37889688249400477, Proportion of 0s: 0.6211031175059952
True Labels - Proportion of 1s: 0.37889688249400477, Proportion of 0s: 0.6211031175059952
Client 3 of 5: Local Epoch [2/3] Loss: 7.3706, Accuracy: 51.56 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 145, 0s: 272
True Labels - 1s: 158, 0s: 259
Predictions - Proportion of 1s: 0.34772182254196643, Proportion of 0s: 0.6522781774580336
True Labels - Proportion of 1s: 0.37889688249400477, Proportion of 0s: 0.6211031175059952
Client 3 of 5: Local Epoch [3/3] Loss: 7.3199, Accuracy: 54.20 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 250, 0s: 167
True Labels - 1s: 187, 0s: 230
Predictions - Proportion of 1s: 0.5995203836930456, Proportion of 0s: 0.40047961630695444
True Labels - Proportion of 1s: 0.44844124700239807, Proportion of 0s: 0.5515587529976019
Client 4 of 5: Local Epoch [1/3] Loss: 5.8071, Accuracy: 49.40 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 75, 0s: 342
True Labels - 1s: 187, 0s: 230
Predictions - Proportion of 1s: 0.17985611510791366, Proportion of 0s: 0.8201438848920863
True Labels - Proportion of 1s: 0.44844124700239807, Proportion of 0s: 0.5515587529976019
Client 4 of 5: Local Epoch [2/3] Loss: 9.8418, Accuracy: 54.92 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 134, 0s: 283
True Labels - 1s: 187, 0s: 230
Predictions - Proportion of 1s: 0.3213429256594724, Proportion of 0s: 0.6786570743405276
True Labels - Proportion of 1s: 0.44844124700239807, Proportion of 0s: 0.5515587529976019
Client 4 of 5: Local Epoch [3/3] Loss: 7.0341, Accuracy: 55.16 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 146, 0s: 271
True Labels - 1s: 156, 0s: 261
Predictions - Proportion of 1s: 0.3501199040767386, Proportion of 0s: 0.6498800959232613
True Labels - Proportion of 1s: 0.37410071942446044, Proportion of 0s: 0.6258992805755396
Client 5 of 5: Local Epoch [1/3] Loss: 6.0135, Accuracy: 55.40 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 180, 0s: 237
True Labels - 1s: 156, 0s: 261
Predictions - Proportion of 1s: 0.4316546762589928, Proportion of 0s: 0.5683453237410072
True Labels - Proportion of 1s: 0.37410071942446044, Proportion of 0s: 0.6258992805755396
Client 5 of 5: Local Epoch [2/3] Loss: 7.1435, Accuracy: 55.40 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 97, 0s: 320
True Labels - 1s: 156, 0s: 261
Predictions - Proportion of 1s: 0.23261390887290168, Proportion of 0s: 0.7673860911270983
True Labels - Proportion of 1s: 0.37410071942446044, Proportion of 0s: 0.6258992805755396
Client 5 of 5: Local Epoch [3/3] Loss: 7.2361, Accuracy: 55.16 %, Epsilon: 0.49, Delta: 0.0030
-------------------------------
Round [1/4] Average Local Loss: 7.4378, Average Local Accuracy: 52.76 %
-------------------------------
-------- Validation --------
Predictions - 1s: 489, 0s: 32
True Labels - 1s: 200, 0s: 321
Predictions - Proportion of 1s: 0.9385796545105566, Proportion of 0s: 0.061420345489443376
True Labels - Proportion of 1s: 0.3838771593090211, Proportion of 0s: 0.6161228406909789
Round [1/4] Global Model Validation Loss: 8.0941, Validation Accuracy: 39.54 %
-------- Validation finished --------
Updated best model in round 1 saved with Validation Loss: 8.094141047361664 and Validation Accuracy: 39.54 %
-------------------------------

Round 2 of 4
-------------------------------
Predictions - 1s: 116, 0s: 301
True Labels - 1s: 192, 0s: 225
Predictions - Proportion of 1s: 0.27817745803357313, Proportion of 0s: 0.7218225419664268
True Labels - Proportion of 1s: 0.460431654676259, Proportion of 0s: 0.539568345323741
Client 1 of 5: Local Epoch [1/3] Loss: 6.8572, Accuracy: 56.83 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 248, 0s: 169
True Labels - 1s: 192, 0s: 225
Predictions - Proportion of 1s: 0.5947242206235012, Proportion of 0s: 0.4052757793764988
True Labels - Proportion of 1s: 0.460431654676259, Proportion of 0s: 0.539568345323741
Client 1 of 5: Local Epoch [2/3] Loss: 9.1186, Accuracy: 48.68 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 127, 0s: 290
True Labels - 1s: 192, 0s: 225
Predictions - Proportion of 1s: 0.30455635491606714, Proportion of 0s: 0.6954436450839329
True Labels - Proportion of 1s: 0.460431654676259, Proportion of 0s: 0.539568345323741
Client 1 of 5: Local Epoch [3/3] Loss: 7.4786, Accuracy: 54.68 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 222, 0s: 195
True Labels - 1s: 181, 0s: 236
Predictions - Proportion of 1s: 0.5323741007194245, Proportion of 0s: 0.4676258992805755
True Labels - Proportion of 1s: 0.434052757793765, Proportion of 0s: 0.565947242206235
Client 2 of 5: Local Epoch [1/3] Loss: 7.6502, Accuracy: 40.77 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 245, 0s: 172
True Labels - 1s: 181, 0s: 236
Predictions - Proportion of 1s: 0.5875299760191847, Proportion of 0s: 0.41247002398081534
True Labels - Proportion of 1s: 0.434052757793765, Proportion of 0s: 0.565947242206235
Client 2 of 5: Local Epoch [2/3] Loss: 8.5241, Accuracy: 48.20 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 135, 0s: 282
True Labels - 1s: 181, 0s: 236
Predictions - Proportion of 1s: 0.3237410071942446, Proportion of 0s: 0.6762589928057554
True Labels - Proportion of 1s: 0.434052757793765, Proportion of 0s: 0.565947242206235
Client 2 of 5: Local Epoch [3/3] Loss: 7.6322, Accuracy: 53.00 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 205, 0s: 212
True Labels - 1s: 158, 0s: 259
Predictions - Proportion of 1s: 0.49160671462829736, Proportion of 0s: 0.5083932853717026
True Labels - Proportion of 1s: 0.37889688249400477, Proportion of 0s: 0.6211031175059952
Client 3 of 5: Local Epoch [1/3] Loss: 6.6412, Accuracy: 48.44 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 98, 0s: 319
True Labels - 1s: 158, 0s: 259
Predictions - Proportion of 1s: 0.23501199040767387, Proportion of 0s: 0.7649880095923262
True Labels - Proportion of 1s: 0.37889688249400477, Proportion of 0s: 0.6211031175059952
Client 3 of 5: Local Epoch [2/3] Loss: 9.0252, Accuracy: 52.04 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 140, 0s: 277
True Labels - 1s: 158, 0s: 259
Predictions - Proportion of 1s: 0.33573141486810554, Proportion of 0s: 0.6642685851318945
True Labels - Proportion of 1s: 0.37889688249400477, Proportion of 0s: 0.6211031175059952
Client 3 of 5: Local Epoch [3/3] Loss: 6.7707, Accuracy: 54.92 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 195, 0s: 222
True Labels - 1s: 187, 0s: 230
Predictions - Proportion of 1s: 0.4676258992805755, Proportion of 0s: 0.5323741007194245
True Labels - Proportion of 1s: 0.44844124700239807, Proportion of 0s: 0.5515587529976019
Client 4 of 5: Local Epoch [1/3] Loss: 6.7396, Accuracy: 50.12 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 199, 0s: 218
True Labels - 1s: 187, 0s: 230
Predictions - Proportion of 1s: 0.47721822541966424, Proportion of 0s: 0.5227817745803357
True Labels - Proportion of 1s: 0.44844124700239807, Proportion of 0s: 0.5515587529976019
Client 4 of 5: Local Epoch [2/3] Loss: 6.6761, Accuracy: 53.48 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 193, 0s: 224
True Labels - 1s: 187, 0s: 230
Predictions - Proportion of 1s: 0.4628297362110312, Proportion of 0s: 0.5371702637889688
True Labels - Proportion of 1s: 0.44844124700239807, Proportion of 0s: 0.5515587529976019
Client 4 of 5: Local Epoch [3/3] Loss: 7.4248, Accuracy: 53.00 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 127, 0s: 290
True Labels - 1s: 156, 0s: 261
Predictions - Proportion of 1s: 0.30455635491606714, Proportion of 0s: 0.6954436450839329
True Labels - Proportion of 1s: 0.37410071942446044, Proportion of 0s: 0.6258992805755396
Client 5 of 5: Local Epoch [1/3] Loss: 6.2352, Accuracy: 58.03 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 111, 0s: 306
True Labels - 1s: 156, 0s: 261
Predictions - Proportion of 1s: 0.26618705035971224, Proportion of 0s: 0.7338129496402878
True Labels - Proportion of 1s: 0.37410071942446044, Proportion of 0s: 0.6258992805755396
Client 5 of 5: Local Epoch [2/3] Loss: 8.2770, Accuracy: 55.64 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 111, 0s: 306
True Labels - 1s: 156, 0s: 261
Predictions - Proportion of 1s: 0.26618705035971224, Proportion of 0s: 0.7338129496402878
True Labels - Proportion of 1s: 0.37410071942446044, Proportion of 0s: 0.6258992805755396
Client 5 of 5: Local Epoch [3/3] Loss: 7.4282, Accuracy: 56.12 %, Epsilon: 0.49, Delta: 0.0030
-------------------------------
Round [2/4] Average Local Loss: 7.3469, Average Local Accuracy: 54.34 %
-------------------------------
-------- Validation --------
Predictions - 1s: 432, 0s: 89
True Labels - 1s: 200, 0s: 321
Predictions - Proportion of 1s: 0.8291746641074856, Proportion of 0s: 0.1708253358925144
True Labels - Proportion of 1s: 0.3838771593090211, Proportion of 0s: 0.6161228406909789
Round [2/4] Global Model Validation Loss: 5.7019, Validation Accuracy: 42.80 %
-------- Validation finished --------
Updated best model in round 2 saved with Validation Loss: 5.701913418575325 and Validation Accuracy: 42.80 %
-------------------------------

Round 3 of 4
-------------------------------
Predictions - 1s: 188, 0s: 229
True Labels - 1s: 192, 0s: 225
Predictions - Proportion of 1s: 0.45083932853717024, Proportion of 0s: 0.5491606714628298
True Labels - Proportion of 1s: 0.460431654676259, Proportion of 0s: 0.539568345323741
Client 1 of 5: Local Epoch [1/3] Loss: 6.5004, Accuracy: 48.20 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 173, 0s: 244
True Labels - 1s: 192, 0s: 225
Predictions - Proportion of 1s: 0.4148681055155875, Proportion of 0s: 0.5851318944844125
True Labels - Proportion of 1s: 0.460431654676259, Proportion of 0s: 0.539568345323741
Client 1 of 5: Local Epoch [2/3] Loss: 7.0685, Accuracy: 52.28 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 127, 0s: 290
True Labels - 1s: 192, 0s: 225
Predictions - Proportion of 1s: 0.30455635491606714, Proportion of 0s: 0.6954436450839329
True Labels - Proportion of 1s: 0.460431654676259, Proportion of 0s: 0.539568345323741
Client 1 of 5: Local Epoch [3/3] Loss: 7.5192, Accuracy: 54.68 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 212, 0s: 205
True Labels - 1s: 181, 0s: 236
Predictions - Proportion of 1s: 0.5083932853717026, Proportion of 0s: 0.49160671462829736
True Labels - Proportion of 1s: 0.434052757793765, Proportion of 0s: 0.565947242206235
Client 2 of 5: Local Epoch [1/3] Loss: 6.5628, Accuracy: 52.28 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 236, 0s: 181
True Labels - 1s: 181, 0s: 236
Predictions - Proportion of 1s: 0.565947242206235, Proportion of 0s: 0.434052757793765
True Labels - Proportion of 1s: 0.434052757793765, Proportion of 0s: 0.565947242206235
Client 2 of 5: Local Epoch [2/3] Loss: 10.0310, Accuracy: 43.65 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 175, 0s: 242
True Labels - 1s: 181, 0s: 236
Predictions - Proportion of 1s: 0.4196642685851319, Proportion of 0s: 0.580335731414868
True Labels - Proportion of 1s: 0.434052757793765, Proportion of 0s: 0.565947242206235
Client 2 of 5: Local Epoch [3/3] Loss: 7.8657, Accuracy: 46.76 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 210, 0s: 207
True Labels - 1s: 158, 0s: 259
Predictions - Proportion of 1s: 0.5035971223021583, Proportion of 0s: 0.49640287769784175
True Labels - Proportion of 1s: 0.37889688249400477, Proportion of 0s: 0.6211031175059952
Client 3 of 5: Local Epoch [1/3] Loss: 7.1941, Accuracy: 46.28 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 161, 0s: 256
True Labels - 1s: 158, 0s: 259
Predictions - Proportion of 1s: 0.38609112709832133, Proportion of 0s: 0.6139088729016786
True Labels - Proportion of 1s: 0.37889688249400477, Proportion of 0s: 0.6211031175059952
Client 3 of 5: Local Epoch [2/3] Loss: 8.4805, Accuracy: 51.80 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 53, 0s: 364
True Labels - 1s: 158, 0s: 259
Predictions - Proportion of 1s: 0.12709832134292565, Proportion of 0s: 0.8729016786570744
True Labels - Proportion of 1s: 0.37889688249400477, Proportion of 0s: 0.6211031175059952
Client 3 of 5: Local Epoch [3/3] Loss: 10.3397, Accuracy: 60.43 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 142, 0s: 275
True Labels - 1s: 187, 0s: 230
Predictions - Proportion of 1s: 0.3405275779376499, Proportion of 0s: 0.6594724220623501
True Labels - Proportion of 1s: 0.44844124700239807, Proportion of 0s: 0.5515587529976019
Client 4 of 5: Local Epoch [1/3] Loss: 6.2265, Accuracy: 58.03 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 162, 0s: 255
True Labels - 1s: 187, 0s: 230
Predictions - Proportion of 1s: 0.38848920863309355, Proportion of 0s: 0.6115107913669064
True Labels - Proportion of 1s: 0.44844124700239807, Proportion of 0s: 0.5515587529976019
Client 4 of 5: Local Epoch [2/3] Loss: 7.2335, Accuracy: 55.16 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 166, 0s: 251
True Labels - 1s: 187, 0s: 230
Predictions - Proportion of 1s: 0.3980815347721823, Proportion of 0s: 0.6019184652278178
True Labels - Proportion of 1s: 0.44844124700239807, Proportion of 0s: 0.5515587529976019
Client 4 of 5: Local Epoch [3/3] Loss: 7.4443, Accuracy: 53.72 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 113, 0s: 304
True Labels - 1s: 156, 0s: 261
Predictions - Proportion of 1s: 0.2709832134292566, Proportion of 0s: 0.7290167865707434
True Labels - Proportion of 1s: 0.37410071942446044, Proportion of 0s: 0.6258992805755396
Client 5 of 5: Local Epoch [1/3] Loss: 7.8522, Accuracy: 56.59 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 226, 0s: 191
True Labels - 1s: 156, 0s: 261
Predictions - Proportion of 1s: 0.5419664268585132, Proportion of 0s: 0.4580335731414868
True Labels - Proportion of 1s: 0.37410071942446044, Proportion of 0s: 0.6258992805755396
Client 5 of 5: Local Epoch [2/3] Loss: 8.3042, Accuracy: 49.64 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 251, 0s: 166
True Labels - 1s: 156, 0s: 261
Predictions - Proportion of 1s: 0.6019184652278178, Proportion of 0s: 0.3980815347721823
True Labels - Proportion of 1s: 0.37410071942446044, Proportion of 0s: 0.6258992805755396
Client 5 of 5: Local Epoch [3/3] Loss: 8.4268, Accuracy: 51.32 %, Epsilon: 0.49, Delta: 0.0030
-------------------------------
Round [3/4] Average Local Loss: 8.3191, Average Local Accuracy: 53.38 %
-------------------------------
-------- Validation --------
Predictions - 1s: 23, 0s: 498
True Labels - 1s: 200, 0s: 321
Predictions - Proportion of 1s: 0.044145873320537425, Proportion of 0s: 0.9558541266794626
True Labels - Proportion of 1s: 0.3838771593090211, Proportion of 0s: 0.6161228406909789
Round [3/4] Global Model Validation Loss: 6.3734, Validation Accuracy: 61.04 %
-------- Validation finished --------

Round 4 of 4
-------------------------------
Predictions - 1s: 258, 0s: 159
True Labels - 1s: 192, 0s: 225
Predictions - Proportion of 1s: 0.6187050359712231, Proportion of 0s: 0.381294964028777
True Labels - Proportion of 1s: 0.460431654676259, Proportion of 0s: 0.539568345323741
Client 1 of 5: Local Epoch [1/3] Loss: 7.7227, Accuracy: 48.20 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 242, 0s: 175
True Labels - 1s: 192, 0s: 225
Predictions - Proportion of 1s: 0.580335731414868, Proportion of 0s: 0.4196642685851319
True Labels - Proportion of 1s: 0.460431654676259, Proportion of 0s: 0.539568345323741
Client 1 of 5: Local Epoch [2/3] Loss: 8.7378, Accuracy: 48.68 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 261, 0s: 156
True Labels - 1s: 192, 0s: 225
Predictions - Proportion of 1s: 0.6258992805755396, Proportion of 0s: 0.37410071942446044
True Labels - Proportion of 1s: 0.460431654676259, Proportion of 0s: 0.539568345323741
Client 1 of 5: Local Epoch [3/3] Loss: 7.3575, Accuracy: 53.72 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 122, 0s: 295
True Labels - 1s: 181, 0s: 236
Predictions - Proportion of 1s: 0.29256594724220625, Proportion of 0s: 0.7074340527577938
True Labels - Proportion of 1s: 0.434052757793765, Proportion of 0s: 0.565947242206235
Client 2 of 5: Local Epoch [1/3] Loss: 7.2514, Accuracy: 50.84 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 161, 0s: 256
True Labels - 1s: 181, 0s: 236
Predictions - Proportion of 1s: 0.38609112709832133, Proportion of 0s: 0.6139088729016786
True Labels - Proportion of 1s: 0.434052757793765, Proportion of 0s: 0.565947242206235
Client 2 of 5: Local Epoch [2/3] Loss: 7.6093, Accuracy: 58.27 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 242, 0s: 175
True Labels - 1s: 181, 0s: 236
Predictions - Proportion of 1s: 0.580335731414868, Proportion of 0s: 0.4196642685851319
True Labels - Proportion of 1s: 0.434052757793765, Proportion of 0s: 0.565947242206235
Client 2 of 5: Local Epoch [3/3] Loss: 8.7993, Accuracy: 48.44 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 123, 0s: 294
True Labels - 1s: 158, 0s: 259
Predictions - Proportion of 1s: 0.2949640287769784, Proportion of 0s: 0.7050359712230215
True Labels - Proportion of 1s: 0.37889688249400477, Proportion of 0s: 0.6211031175059952
Client 3 of 5: Local Epoch [1/3] Loss: 6.4527, Accuracy: 53.72 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 118, 0s: 299
True Labels - 1s: 158, 0s: 259
Predictions - Proportion of 1s: 0.2829736211031175, Proportion of 0s: 0.7170263788968825
True Labels - Proportion of 1s: 0.37889688249400477, Proportion of 0s: 0.6211031175059952
Client 3 of 5: Local Epoch [2/3] Loss: 7.7830, Accuracy: 57.31 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 135, 0s: 282
True Labels - 1s: 158, 0s: 259
Predictions - Proportion of 1s: 0.3237410071942446, Proportion of 0s: 0.6762589928057554
True Labels - Proportion of 1s: 0.37889688249400477, Proportion of 0s: 0.6211031175059952
Client 3 of 5: Local Epoch [3/3] Loss: 8.0868, Accuracy: 55.64 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 136, 0s: 281
True Labels - 1s: 187, 0s: 230
Predictions - Proportion of 1s: 0.3261390887290168, Proportion of 0s: 0.6738609112709832
True Labels - Proportion of 1s: 0.44844124700239807, Proportion of 0s: 0.5515587529976019
Client 4 of 5: Local Epoch [1/3] Loss: 7.0238, Accuracy: 55.16 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 176, 0s: 241
True Labels - 1s: 187, 0s: 230
Predictions - Proportion of 1s: 0.42206235011990406, Proportion of 0s: 0.5779376498800959
True Labels - Proportion of 1s: 0.44844124700239807, Proportion of 0s: 0.5515587529976019
Client 4 of 5: Local Epoch [2/3] Loss: 9.6913, Accuracy: 49.40 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 213, 0s: 204
True Labels - 1s: 187, 0s: 230
Predictions - Proportion of 1s: 0.5107913669064749, Proportion of 0s: 0.4892086330935252
True Labels - Proportion of 1s: 0.44844124700239807, Proportion of 0s: 0.5515587529976019
Client 4 of 5: Local Epoch [3/3] Loss: 8.7324, Accuracy: 51.08 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 188, 0s: 229
True Labels - 1s: 156, 0s: 261
Predictions - Proportion of 1s: 0.45083932853717024, Proportion of 0s: 0.5491606714628298
True Labels - Proportion of 1s: 0.37410071942446044, Proportion of 0s: 0.6258992805755396
Client 5 of 5: Local Epoch [1/3] Loss: 8.2580, Accuracy: 47.24 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 128, 0s: 289
True Labels - 1s: 156, 0s: 261
Predictions - Proportion of 1s: 0.3069544364508393, Proportion of 0s: 0.6930455635491607
True Labels - Proportion of 1s: 0.37410071942446044, Proportion of 0s: 0.6258992805755396
Client 5 of 5: Local Epoch [2/3] Loss: 7.5180, Accuracy: 57.31 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 159, 0s: 258
True Labels - 1s: 156, 0s: 261
Predictions - Proportion of 1s: 0.381294964028777, Proportion of 0s: 0.6187050359712231
True Labels - Proportion of 1s: 0.37410071942446044, Proportion of 0s: 0.6258992805755396
Client 5 of 5: Local Epoch [3/3] Loss: 7.0675, Accuracy: 54.68 %, Epsilon: 0.49, Delta: 0.0030
-------------------------------
Round [4/4] Average Local Loss: 8.0087, Average Local Accuracy: 52.71 %
-------------------------------
-------- Validation --------
Predictions - 1s: 513, 0s: 8
True Labels - 1s: 200, 0s: 321
Predictions - Proportion of 1s: 0.9846449136276392, Proportion of 0s: 0.015355086372360844
True Labels - Proportion of 1s: 0.3838771593090211, Proportion of 0s: 0.6161228406909789
Round [4/4] Global Model Validation Loss: 13.1025, Validation Accuracy: 37.62 %
-------- Validation finished --------
Best model in round 2 saved with Validation Loss: 5.701913418575325 and Validation Accuracy: 42.80 %

-------- Training finished in 26:16 --------

Test flag enabled. Testing the model

-------- Loading best model from model_path --------
Loaded model bert-small from date 15-03-2024 10:07. Trained with Federated Learning technology.
Round 2, lr: 0.06, optimizer: AdamW
Average train accuracy: 54.34 %, Validation accuracy: 42.80 %
-------- Best model loaded --------

-------- Creating Test Dataloader --------
Test Loader: 650 total sentences. 82 batches of size 8.
-------- Test Dataloader created --------

-------- Testing --------
Predictions - 1s: 551, 0s: 99
True Labels - 1s: 268, 0s: 382
Predictions - Proportion of 1s: 0.8476923076923077, Proportion of 0s: 0.1523076923076923
True Labels - Proportion of 1s: 0.4123076923076923, Proportion of 0s: 0.5876923076923077
Nº of test samples: 650
Accuracy: 43.54%
Accuracy 2 : 43.54%
Precision: 49.30%
Recall: 49.62%
F1 Score: 39.44%
Classification report:
              precision    recall  f1-score   support

           0     0.5758    0.1492    0.2370       382
           1     0.4102    0.8433    0.5519       268

    accuracy                         0.4354       650
   macro avg     0.4930    0.4962    0.3944       650
weighted avg     0.5075    0.4354    0.3668       650

-------- Testing finished --------
