Current configuration:
{
    "concurrency_flag": false,
    "data_distribution": "iid",
    "dataset": "acl_dep_sad",
    "device": "cuda",
    "dp_delta": 0.003,
    "dp_epsilon": 1,
    "eval_batch_size": 4,
    "eval_flag": true,
    "eval_size": 0.2,
    "fed_alg": "fedavg",
    "layers": 3,
    "learning_rate": 0.06,
    "max_length": 512,
    "ml_mode": "fl",
    "model": "bert_small",
    "model_name": "fl_1_seed2_acl_dep_sad",
    "models_path": "/local/vpaloma/fabric-federated-learning/ablation_study/phase-2/1-ml_mode-dataset-dp/acl_dep_sad",
    "mu": 0.5,
    "num_clients": 5,
    "num_epochs": 3,
    "num_rounds": 4,
    "optimizer": "AdamW",
    "progress_bar_flag": false,
    "save_model": true,
    "scheduler": "linear",
    "scheduler_warmup_steps": 0,
    "seed": 221,
    "test_flag": true,
    "train_batch_size": 2,
    "train_size": 0.8
}
-------- Configuration loaded --------

-------- Setting device --------
cuda device selected and available.
-------- Device set --------

-------- Setting seed --------
-------- Seed set --------

-------- Creating Model --------
-------- Model created --------

-------- Setting Trainable Layers --------
Training the last 3 layers.

Total parameters count: 28764674
Trainable parameters count: 3416066
-------- Trainable Layers set --------

-------- Creating Tokenizer --------
-------- Tokenizer created --------

-------- Creating Train and Eval Dataloaders --------
Train Loader: 2085 total sentences. 1043 batches of size 2.
Eval Loader: 521 total sentences. 131 batches of size 4.
-------- Train and Eval Dataloaders created --------

-------- Training --------
Training with Federated Learning technology.
Training with differential privacy.
Federated averaging algorithm selected.

Round 1 of 4
-------------------------------
Predictions - 1s: 227, 0s: 190
True Labels - 1s: 192, 0s: 225
Predictions - Proportion of 1s: 0.5443645083932853, Proportion of 0s: 0.4556354916067146
True Labels - Proportion of 1s: 0.460431654676259, Proportion of 0s: 0.539568345323741
Client 1 of 5: Local Epoch [1/3] Loss: 5.3321, Accuracy: 52.76 %, Epsilon: 0.57, Delta: 0.0030
Predictions - 1s: 251, 0s: 166
True Labels - 1s: 192, 0s: 225
Predictions - Proportion of 1s: 0.6019184652278178, Proportion of 0s: 0.3980815347721823
True Labels - Proportion of 1s: 0.460431654676259, Proportion of 0s: 0.539568345323741
Client 1 of 5: Local Epoch [2/3] Loss: 8.7654, Accuracy: 48.44 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 168, 0s: 249
True Labels - 1s: 192, 0s: 225
Predictions - Proportion of 1s: 0.4028776978417266, Proportion of 0s: 0.5971223021582733
True Labels - Proportion of 1s: 0.460431654676259, Proportion of 0s: 0.539568345323741
Client 1 of 5: Local Epoch [3/3] Loss: 8.5580, Accuracy: 50.60 %, Epsilon: 1.00, Delta: 0.0030
Predictions - 1s: 150, 0s: 267
True Labels - 1s: 181, 0s: 236
Predictions - Proportion of 1s: 0.3597122302158273, Proportion of 0s: 0.6402877697841727
True Labels - Proportion of 1s: 0.434052757793765, Proportion of 0s: 0.565947242206235
Client 2 of 5: Local Epoch [1/3] Loss: 6.4225, Accuracy: 50.36 %, Epsilon: 0.57, Delta: 0.0030
Predictions - 1s: 130, 0s: 287
True Labels - 1s: 181, 0s: 236
Predictions - Proportion of 1s: 0.3117505995203837, Proportion of 0s: 0.6882494004796164
True Labels - Proportion of 1s: 0.434052757793765, Proportion of 0s: 0.565947242206235
Client 2 of 5: Local Epoch [2/3] Loss: 7.6761, Accuracy: 51.32 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 186, 0s: 231
True Labels - 1s: 181, 0s: 236
Predictions - Proportion of 1s: 0.4460431654676259, Proportion of 0s: 0.5539568345323741
True Labels - Proportion of 1s: 0.434052757793765, Proportion of 0s: 0.565947242206235
Client 2 of 5: Local Epoch [3/3] Loss: 7.1197, Accuracy: 51.32 %, Epsilon: 1.00, Delta: 0.0030
Predictions - 1s: 143, 0s: 274
True Labels - 1s: 158, 0s: 259
Predictions - Proportion of 1s: 0.34292565947242204, Proportion of 0s: 0.657074340527578
True Labels - Proportion of 1s: 0.37889688249400477, Proportion of 0s: 0.6211031175059952
Client 3 of 5: Local Epoch [1/3] Loss: 5.2455, Accuracy: 57.55 %, Epsilon: 0.57, Delta: 0.0030
Predictions - 1s: 166, 0s: 251
True Labels - 1s: 158, 0s: 259
Predictions - Proportion of 1s: 0.3980815347721823, Proportion of 0s: 0.6019184652278178
True Labels - Proportion of 1s: 0.37889688249400477, Proportion of 0s: 0.6211031175059952
Client 3 of 5: Local Epoch [2/3] Loss: 7.3668, Accuracy: 51.56 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 152, 0s: 265
True Labels - 1s: 158, 0s: 259
Predictions - Proportion of 1s: 0.3645083932853717, Proportion of 0s: 0.6354916067146283
True Labels - Proportion of 1s: 0.37889688249400477, Proportion of 0s: 0.6211031175059952
Client 3 of 5: Local Epoch [3/3] Loss: 7.2737, Accuracy: 53.48 %, Epsilon: 1.00, Delta: 0.0030
Predictions - 1s: 241, 0s: 176
True Labels - 1s: 187, 0s: 230
Predictions - Proportion of 1s: 0.5779376498800959, Proportion of 0s: 0.42206235011990406
True Labels - Proportion of 1s: 0.44844124700239807, Proportion of 0s: 0.5515587529976019
Client 4 of 5: Local Epoch [1/3] Loss: 5.6258, Accuracy: 50.12 %, Epsilon: 0.57, Delta: 0.0030
Predictions - 1s: 87, 0s: 330
True Labels - 1s: 187, 0s: 230
Predictions - Proportion of 1s: 0.20863309352517986, Proportion of 0s: 0.7913669064748201
True Labels - Proportion of 1s: 0.44844124700239807, Proportion of 0s: 0.5515587529976019
Client 4 of 5: Local Epoch [2/3] Loss: 9.5055, Accuracy: 53.48 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 150, 0s: 267
True Labels - 1s: 187, 0s: 230
Predictions - Proportion of 1s: 0.3597122302158273, Proportion of 0s: 0.6402877697841727
True Labels - Proportion of 1s: 0.44844124700239807, Proportion of 0s: 0.5515587529976019
Client 4 of 5: Local Epoch [3/3] Loss: 7.1418, Accuracy: 54.20 %, Epsilon: 1.00, Delta: 0.0030
Predictions - 1s: 146, 0s: 271
True Labels - 1s: 156, 0s: 261
Predictions - Proportion of 1s: 0.3501199040767386, Proportion of 0s: 0.6498800959232613
True Labels - Proportion of 1s: 0.37410071942446044, Proportion of 0s: 0.6258992805755396
Client 5 of 5: Local Epoch [1/3] Loss: 5.9093, Accuracy: 54.92 %, Epsilon: 0.57, Delta: 0.0030
Predictions - 1s: 165, 0s: 252
True Labels - 1s: 156, 0s: 261
Predictions - Proportion of 1s: 0.39568345323741005, Proportion of 0s: 0.60431654676259
True Labels - Proportion of 1s: 0.37410071942446044, Proportion of 0s: 0.6258992805755396
Client 5 of 5: Local Epoch [2/3] Loss: 6.9758, Accuracy: 54.20 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 112, 0s: 305
True Labels - 1s: 156, 0s: 261
Predictions - Proportion of 1s: 0.2685851318944844, Proportion of 0s: 0.7314148681055156
True Labels - Proportion of 1s: 0.37410071942446044, Proportion of 0s: 0.6258992805755396
Client 5 of 5: Local Epoch [3/3] Loss: 7.1783, Accuracy: 53.96 %, Epsilon: 1.00, Delta: 0.0030
-------------------------------
Round [1/4] Average Local Loss: 7.4543, Average Local Accuracy: 52.71 %
-------------------------------
-------- Validation --------
Predictions - 1s: 487, 0s: 34
True Labels - 1s: 200, 0s: 321
Predictions - Proportion of 1s: 0.9347408829174664, Proportion of 0s: 0.06525911708253358
True Labels - Proportion of 1s: 0.3838771593090211, Proportion of 0s: 0.6161228406909789
Round [1/4] Global Model Validation Loss: 8.1390, Validation Accuracy: 39.92 %
-------- Validation finished --------
Updated best model in round 1 saved with Validation Loss: 8.139031944002447 and Validation Accuracy: 39.92 %
-------------------------------

Round 2 of 4
-------------------------------
Predictions - 1s: 125, 0s: 292
True Labels - 1s: 192, 0s: 225
Predictions - Proportion of 1s: 0.2997601918465228, Proportion of 0s: 0.7002398081534772
True Labels - Proportion of 1s: 0.460431654676259, Proportion of 0s: 0.539568345323741
Client 1 of 5: Local Epoch [1/3] Loss: 6.6790, Accuracy: 55.64 %, Epsilon: 0.57, Delta: 0.0030
Predictions - 1s: 246, 0s: 171
True Labels - 1s: 192, 0s: 225
Predictions - Proportion of 1s: 0.5899280575539568, Proportion of 0s: 0.41007194244604317
True Labels - Proportion of 1s: 0.460431654676259, Proportion of 0s: 0.539568345323741
Client 1 of 5: Local Epoch [2/3] Loss: 8.8691, Accuracy: 48.68 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 127, 0s: 290
True Labels - 1s: 192, 0s: 225
Predictions - Proportion of 1s: 0.30455635491606714, Proportion of 0s: 0.6954436450839329
True Labels - Proportion of 1s: 0.460431654676259, Proportion of 0s: 0.539568345323741
Client 1 of 5: Local Epoch [3/3] Loss: 7.6234, Accuracy: 53.72 %, Epsilon: 1.00, Delta: 0.0030
Predictions - 1s: 212, 0s: 205
True Labels - 1s: 181, 0s: 236
Predictions - Proportion of 1s: 0.5083932853717026, Proportion of 0s: 0.49160671462829736
True Labels - Proportion of 1s: 0.434052757793765, Proportion of 0s: 0.565947242206235
Client 2 of 5: Local Epoch [1/3] Loss: 7.7702, Accuracy: 43.17 %, Epsilon: 0.57, Delta: 0.0030
Predictions - 1s: 230, 0s: 187
True Labels - 1s: 181, 0s: 236
Predictions - Proportion of 1s: 0.5515587529976019, Proportion of 0s: 0.44844124700239807
True Labels - Proportion of 1s: 0.434052757793765, Proportion of 0s: 0.565947242206235
Client 2 of 5: Local Epoch [2/3] Loss: 8.5275, Accuracy: 49.40 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 133, 0s: 284
True Labels - 1s: 181, 0s: 236
Predictions - Proportion of 1s: 0.31894484412470026, Proportion of 0s: 0.6810551558752997
True Labels - Proportion of 1s: 0.434052757793765, Proportion of 0s: 0.565947242206235
Client 2 of 5: Local Epoch [3/3] Loss: 7.7485, Accuracy: 53.48 %, Epsilon: 1.00, Delta: 0.0030
Predictions - 1s: 199, 0s: 218
True Labels - 1s: 158, 0s: 259
Predictions - Proportion of 1s: 0.47721822541966424, Proportion of 0s: 0.5227817745803357
True Labels - Proportion of 1s: 0.37889688249400477, Proportion of 0s: 0.6211031175059952
Client 3 of 5: Local Epoch [1/3] Loss: 6.1235, Accuracy: 49.88 %, Epsilon: 0.57, Delta: 0.0030
Predictions - 1s: 102, 0s: 315
True Labels - 1s: 158, 0s: 259
Predictions - Proportion of 1s: 0.2446043165467626, Proportion of 0s: 0.7553956834532374
True Labels - Proportion of 1s: 0.37889688249400477, Proportion of 0s: 0.6211031175059952
Client 3 of 5: Local Epoch [2/3] Loss: 9.0414, Accuracy: 53.00 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 157, 0s: 260
True Labels - 1s: 158, 0s: 259
Predictions - Proportion of 1s: 0.3764988009592326, Proportion of 0s: 0.6235011990407674
True Labels - Proportion of 1s: 0.37889688249400477, Proportion of 0s: 0.6211031175059952
Client 3 of 5: Local Epoch [3/3] Loss: 6.7640, Accuracy: 53.24 %, Epsilon: 1.00, Delta: 0.0030
Predictions - 1s: 183, 0s: 234
True Labels - 1s: 187, 0s: 230
Predictions - Proportion of 1s: 0.43884892086330934, Proportion of 0s: 0.5611510791366906
True Labels - Proportion of 1s: 0.44844124700239807, Proportion of 0s: 0.5515587529976019
Client 4 of 5: Local Epoch [1/3] Loss: 6.6523, Accuracy: 49.64 %, Epsilon: 0.57, Delta: 0.0030
Predictions - 1s: 200, 0s: 217
True Labels - 1s: 187, 0s: 230
Predictions - Proportion of 1s: 0.47961630695443647, Proportion of 0s: 0.5203836930455635
True Labels - Proportion of 1s: 0.44844124700239807, Proportion of 0s: 0.5515587529976019
Client 4 of 5: Local Epoch [2/3] Loss: 6.8756, Accuracy: 50.84 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 185, 0s: 232
True Labels - 1s: 187, 0s: 230
Predictions - Proportion of 1s: 0.44364508393285373, Proportion of 0s: 0.5563549160671463
True Labels - Proportion of 1s: 0.44844124700239807, Proportion of 0s: 0.5515587529976019
Client 4 of 5: Local Epoch [3/3] Loss: 7.2778, Accuracy: 53.00 %, Epsilon: 1.00, Delta: 0.0030
Predictions - 1s: 125, 0s: 292
True Labels - 1s: 156, 0s: 261
Predictions - Proportion of 1s: 0.2997601918465228, Proportion of 0s: 0.7002398081534772
True Labels - Proportion of 1s: 0.37410071942446044, Proportion of 0s: 0.6258992805755396
Client 5 of 5: Local Epoch [1/3] Loss: 6.2243, Accuracy: 56.59 %, Epsilon: 0.57, Delta: 0.0030
Predictions - 1s: 104, 0s: 313
True Labels - 1s: 156, 0s: 261
Predictions - Proportion of 1s: 0.24940047961630696, Proportion of 0s: 0.750599520383693
True Labels - Proportion of 1s: 0.37410071942446044, Proportion of 0s: 0.6258992805755396
Client 5 of 5: Local Epoch [2/3] Loss: 8.0892, Accuracy: 57.79 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 135, 0s: 282
True Labels - 1s: 156, 0s: 261
Predictions - Proportion of 1s: 0.3237410071942446, Proportion of 0s: 0.6762589928057554
True Labels - Proportion of 1s: 0.37410071942446044, Proportion of 0s: 0.6258992805755396
Client 5 of 5: Local Epoch [3/3] Loss: 7.0748, Accuracy: 53.24 %, Epsilon: 1.00, Delta: 0.0030
-------------------------------
Round [2/4] Average Local Loss: 7.2977, Average Local Accuracy: 53.33 %
-------------------------------
-------- Validation --------
Predictions - 1s: 430, 0s: 91
True Labels - 1s: 200, 0s: 321
Predictions - Proportion of 1s: 0.8253358925143954, Proportion of 0s: 0.1746641074856046
True Labels - Proportion of 1s: 0.3838771593090211, Proportion of 0s: 0.6161228406909789
Round [2/4] Global Model Validation Loss: 5.4559, Validation Accuracy: 42.03 %
-------- Validation finished --------
Updated best model in round 2 saved with Validation Loss: 5.4558521655907155 and Validation Accuracy: 42.03 %
-------------------------------

Round 3 of 4
-------------------------------
Predictions - 1s: 184, 0s: 233
True Labels - 1s: 192, 0s: 225
Predictions - Proportion of 1s: 0.4412470023980815, Proportion of 0s: 0.5587529976019184
True Labels - Proportion of 1s: 0.460431654676259, Proportion of 0s: 0.539568345323741
Client 1 of 5: Local Epoch [1/3] Loss: 6.9197, Accuracy: 46.76 %, Epsilon: 0.57, Delta: 0.0030
Predictions - 1s: 153, 0s: 264
True Labels - 1s: 192, 0s: 225
Predictions - Proportion of 1s: 0.3669064748201439, Proportion of 0s: 0.6330935251798561
True Labels - Proportion of 1s: 0.460431654676259, Proportion of 0s: 0.539568345323741
Client 1 of 5: Local Epoch [2/3] Loss: 7.5018, Accuracy: 54.68 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 138, 0s: 279
True Labels - 1s: 192, 0s: 225
Predictions - Proportion of 1s: 0.33093525179856115, Proportion of 0s: 0.6690647482014388
True Labels - Proportion of 1s: 0.460431654676259, Proportion of 0s: 0.539568345323741
Client 1 of 5: Local Epoch [3/3] Loss: 8.5043, Accuracy: 50.60 %, Epsilon: 1.00, Delta: 0.0030
Predictions - 1s: 199, 0s: 218
True Labels - 1s: 181, 0s: 236
Predictions - Proportion of 1s: 0.47721822541966424, Proportion of 0s: 0.5227817745803357
True Labels - Proportion of 1s: 0.434052757793765, Proportion of 0s: 0.565947242206235
Client 2 of 5: Local Epoch [1/3] Loss: 6.4437, Accuracy: 53.48 %, Epsilon: 0.57, Delta: 0.0030
Predictions - 1s: 215, 0s: 202
True Labels - 1s: 181, 0s: 236
Predictions - Proportion of 1s: 0.5155875299760192, Proportion of 0s: 0.4844124700239808
True Labels - Proportion of 1s: 0.434052757793765, Proportion of 0s: 0.565947242206235
Client 2 of 5: Local Epoch [2/3] Loss: 9.2357, Accuracy: 46.76 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 160, 0s: 257
True Labels - 1s: 181, 0s: 236
Predictions - Proportion of 1s: 0.38369304556354916, Proportion of 0s: 0.6163069544364509
True Labels - Proportion of 1s: 0.434052757793765, Proportion of 0s: 0.565947242206235
Client 2 of 5: Local Epoch [3/3] Loss: 6.9658, Accuracy: 51.32 %, Epsilon: 1.00, Delta: 0.0030
Predictions - 1s: 190, 0s: 227
True Labels - 1s: 158, 0s: 259
Predictions - Proportion of 1s: 0.4556354916067146, Proportion of 0s: 0.5443645083932853
True Labels - Proportion of 1s: 0.37889688249400477, Proportion of 0s: 0.6211031175059952
Client 3 of 5: Local Epoch [1/3] Loss: 6.8347, Accuracy: 46.76 %, Epsilon: 0.57, Delta: 0.0030
Predictions - 1s: 152, 0s: 265
True Labels - 1s: 158, 0s: 259
Predictions - Proportion of 1s: 0.3645083932853717, Proportion of 0s: 0.6354916067146283
True Labels - Proportion of 1s: 0.37889688249400477, Proportion of 0s: 0.6211031175059952
Client 3 of 5: Local Epoch [2/3] Loss: 9.2728, Accuracy: 50.60 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 64, 0s: 353
True Labels - 1s: 158, 0s: 259
Predictions - Proportion of 1s: 0.15347721822541965, Proportion of 0s: 0.8465227817745803
True Labels - Proportion of 1s: 0.37889688249400477, Proportion of 0s: 0.6211031175059952
Client 3 of 5: Local Epoch [3/3] Loss: 9.7907, Accuracy: 59.23 %, Epsilon: 1.00, Delta: 0.0030
Predictions - 1s: 145, 0s: 272
True Labels - 1s: 187, 0s: 230
Predictions - Proportion of 1s: 0.34772182254196643, Proportion of 0s: 0.6522781774580336
True Labels - Proportion of 1s: 0.44844124700239807, Proportion of 0s: 0.5515587529976019
Client 4 of 5: Local Epoch [1/3] Loss: 5.9595, Accuracy: 60.19 %, Epsilon: 0.57, Delta: 0.0030
Predictions - 1s: 168, 0s: 249
True Labels - 1s: 187, 0s: 230
Predictions - Proportion of 1s: 0.4028776978417266, Proportion of 0s: 0.5971223021582733
True Labels - Proportion of 1s: 0.44844124700239807, Proportion of 0s: 0.5515587529976019
Client 4 of 5: Local Epoch [2/3] Loss: 7.1604, Accuracy: 55.16 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 154, 0s: 263
True Labels - 1s: 187, 0s: 230
Predictions - Proportion of 1s: 0.36930455635491605, Proportion of 0s: 0.6306954436450839
True Labels - Proportion of 1s: 0.44844124700239807, Proportion of 0s: 0.5515587529976019
Client 4 of 5: Local Epoch [3/3] Loss: 7.1033, Accuracy: 54.20 %, Epsilon: 1.00, Delta: 0.0030
Predictions - 1s: 112, 0s: 305
True Labels - 1s: 156, 0s: 261
Predictions - Proportion of 1s: 0.2685851318944844, Proportion of 0s: 0.7314148681055156
True Labels - Proportion of 1s: 0.37410071942446044, Proportion of 0s: 0.6258992805755396
Client 5 of 5: Local Epoch [1/3] Loss: 7.8348, Accuracy: 54.92 %, Epsilon: 0.57, Delta: 0.0030
Predictions - 1s: 209, 0s: 208
True Labels - 1s: 156, 0s: 261
Predictions - Proportion of 1s: 0.5011990407673861, Proportion of 0s: 0.4988009592326139
True Labels - Proportion of 1s: 0.37410071942446044, Proportion of 0s: 0.6258992805755396
Client 5 of 5: Local Epoch [2/3] Loss: 8.4270, Accuracy: 52.76 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 226, 0s: 191
True Labels - 1s: 156, 0s: 261
Predictions - Proportion of 1s: 0.5419664268585132, Proportion of 0s: 0.4580335731414868
True Labels - Proportion of 1s: 0.37410071942446044, Proportion of 0s: 0.6258992805755396
Client 5 of 5: Local Epoch [3/3] Loss: 8.0047, Accuracy: 53.00 %, Epsilon: 1.00, Delta: 0.0030
-------------------------------
Round [3/4] Average Local Loss: 8.0738, Average Local Accuracy: 53.67 %
-------------------------------
-------- Validation --------
Predictions - 1s: 23, 0s: 498
True Labels - 1s: 200, 0s: 321
Predictions - Proportion of 1s: 0.044145873320537425, Proportion of 0s: 0.9558541266794626
True Labels - Proportion of 1s: 0.3838771593090211, Proportion of 0s: 0.6161228406909789
Round [3/4] Global Model Validation Loss: 6.4593, Validation Accuracy: 61.04 %
-------- Validation finished --------

Round 4 of 4
-------------------------------
Predictions - 1s: 250, 0s: 167
True Labels - 1s: 192, 0s: 225
Predictions - Proportion of 1s: 0.5995203836930456, Proportion of 0s: 0.40047961630695444
True Labels - Proportion of 1s: 0.460431654676259, Proportion of 0s: 0.539568345323741
Client 1 of 5: Local Epoch [1/3] Loss: 7.7531, Accuracy: 48.68 %, Epsilon: 0.57, Delta: 0.0030
Predictions - 1s: 242, 0s: 175
True Labels - 1s: 192, 0s: 225
Predictions - Proportion of 1s: 0.580335731414868, Proportion of 0s: 0.4196642685851319
True Labels - Proportion of 1s: 0.460431654676259, Proportion of 0s: 0.539568345323741
Client 1 of 5: Local Epoch [2/3] Loss: 8.7288, Accuracy: 50.60 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 252, 0s: 165
True Labels - 1s: 192, 0s: 225
Predictions - Proportion of 1s: 0.60431654676259, Proportion of 0s: 0.39568345323741005
True Labels - Proportion of 1s: 0.460431654676259, Proportion of 0s: 0.539568345323741
Client 1 of 5: Local Epoch [3/3] Loss: 7.1984, Accuracy: 53.96 %, Epsilon: 1.00, Delta: 0.0030
Predictions - 1s: 132, 0s: 285
True Labels - 1s: 181, 0s: 236
Predictions - Proportion of 1s: 0.31654676258992803, Proportion of 0s: 0.6834532374100719
True Labels - Proportion of 1s: 0.434052757793765, Proportion of 0s: 0.565947242206235
Client 2 of 5: Local Epoch [1/3] Loss: 7.1747, Accuracy: 50.84 %, Epsilon: 0.57, Delta: 0.0030
Predictions - 1s: 173, 0s: 244
True Labels - 1s: 181, 0s: 236
Predictions - Proportion of 1s: 0.4148681055155875, Proportion of 0s: 0.5851318944844125
True Labels - Proportion of 1s: 0.434052757793765, Proportion of 0s: 0.565947242206235
Client 2 of 5: Local Epoch [2/3] Loss: 7.9020, Accuracy: 55.88 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 234, 0s: 183
True Labels - 1s: 181, 0s: 236
Predictions - Proportion of 1s: 0.5611510791366906, Proportion of 0s: 0.43884892086330934
True Labels - Proportion of 1s: 0.434052757793765, Proportion of 0s: 0.565947242206235
Client 2 of 5: Local Epoch [3/3] Loss: 9.1314, Accuracy: 48.92 %, Epsilon: 1.00, Delta: 0.0030
Predictions - 1s: 126, 0s: 291
True Labels - 1s: 158, 0s: 259
Predictions - Proportion of 1s: 0.302158273381295, Proportion of 0s: 0.697841726618705
True Labels - Proportion of 1s: 0.37889688249400477, Proportion of 0s: 0.6211031175059952
Client 3 of 5: Local Epoch [1/3] Loss: 6.6487, Accuracy: 54.92 %, Epsilon: 0.57, Delta: 0.0030
Predictions - 1s: 114, 0s: 303
True Labels - 1s: 158, 0s: 259
Predictions - Proportion of 1s: 0.2733812949640288, Proportion of 0s: 0.7266187050359713
True Labels - Proportion of 1s: 0.37889688249400477, Proportion of 0s: 0.6211031175059952
Client 3 of 5: Local Epoch [2/3] Loss: 7.7886, Accuracy: 56.83 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 165, 0s: 252
True Labels - 1s: 158, 0s: 259
Predictions - Proportion of 1s: 0.39568345323741005, Proportion of 0s: 0.60431654676259
True Labels - Proportion of 1s: 0.37889688249400477, Proportion of 0s: 0.6211031175059952
Client 3 of 5: Local Epoch [3/3] Loss: 7.8106, Accuracy: 52.28 %, Epsilon: 1.00, Delta: 0.0030
Predictions - 1s: 139, 0s: 278
True Labels - 1s: 187, 0s: 230
Predictions - Proportion of 1s: 0.3333333333333333, Proportion of 0s: 0.6666666666666666
True Labels - Proportion of 1s: 0.44844124700239807, Proportion of 0s: 0.5515587529976019
Client 4 of 5: Local Epoch [1/3] Loss: 7.1200, Accuracy: 53.48 %, Epsilon: 0.57, Delta: 0.0030
Predictions - 1s: 189, 0s: 228
True Labels - 1s: 187, 0s: 230
Predictions - Proportion of 1s: 0.45323741007194246, Proportion of 0s: 0.5467625899280576
True Labels - Proportion of 1s: 0.44844124700239807, Proportion of 0s: 0.5515587529976019
Client 4 of 5: Local Epoch [2/3] Loss: 9.5406, Accuracy: 47.24 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 211, 0s: 206
True Labels - 1s: 187, 0s: 230
Predictions - Proportion of 1s: 0.5059952038369304, Proportion of 0s: 0.4940047961630695
True Labels - Proportion of 1s: 0.44844124700239807, Proportion of 0s: 0.5515587529976019
Client 4 of 5: Local Epoch [3/3] Loss: 8.6182, Accuracy: 49.64 %, Epsilon: 1.00, Delta: 0.0030
Predictions - 1s: 194, 0s: 223
True Labels - 1s: 156, 0s: 261
Predictions - Proportion of 1s: 0.46522781774580335, Proportion of 0s: 0.5347721822541966
True Labels - Proportion of 1s: 0.37410071942446044, Proportion of 0s: 0.6258992805755396
Client 5 of 5: Local Epoch [1/3] Loss: 9.1371, Accuracy: 44.84 %, Epsilon: 0.57, Delta: 0.0030
Predictions - 1s: 131, 0s: 286
True Labels - 1s: 156, 0s: 261
Predictions - Proportion of 1s: 0.31414868105515587, Proportion of 0s: 0.6858513189448441
True Labels - Proportion of 1s: 0.37410071942446044, Proportion of 0s: 0.6258992805755396
Client 5 of 5: Local Epoch [2/3] Loss: 7.1232, Accuracy: 60.91 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 147, 0s: 270
True Labels - 1s: 156, 0s: 261
Predictions - Proportion of 1s: 0.35251798561151076, Proportion of 0s: 0.6474820143884892
True Labels - Proportion of 1s: 0.37410071942446044, Proportion of 0s: 0.6258992805755396
Client 5 of 5: Local Epoch [3/3] Loss: 7.0399, Accuracy: 55.16 %, Epsilon: 1.00, Delta: 0.0030
-------------------------------
Round [4/4] Average Local Loss: 7.9597, Average Local Accuracy: 51.99 %
-------------------------------
-------- Validation --------
Predictions - 1s: 514, 0s: 7
True Labels - 1s: 200, 0s: 321
Predictions - Proportion of 1s: 0.9865642994241842, Proportion of 0s: 0.013435700575815739
True Labels - Proportion of 1s: 0.3838771593090211, Proportion of 0s: 0.6161228406909789
Round [4/4] Global Model Validation Loss: 13.9656, Validation Accuracy: 37.43 %
-------- Validation finished --------
Best model in round 2 saved with Validation Loss: 5.4558521655907155 and Validation Accuracy: 42.03 %

-------- Training finished in 26:43 --------

Test flag enabled. Testing the model

-------- Loading best model from model_path --------
Loaded model bert-small from date 15-03-2024 10:07. Trained with Federated Learning technology.
Round 2, lr: 0.06, optimizer: AdamW
Average train accuracy: 53.33 %, Validation accuracy: 42.03 %
-------- Best model loaded --------

-------- Creating Test Dataloader --------
Test Loader: 650 total sentences. 82 batches of size 8.
-------- Test Dataloader created --------

-------- Testing --------
Predictions - 1s: 531, 0s: 119
True Labels - 1s: 268, 0s: 382
Predictions - Proportion of 1s: 0.816923076923077, Proportion of 0s: 0.18307692307692308
True Labels - Proportion of 1s: 0.4123076923076923, Proportion of 0s: 0.5876923076923077
NÂº of test samples: 650
Accuracy: 45.69%
Accuracy 2 : 45.69%
Precision: 52.09%
Recall: 51.29%
F1 Score: 42.68%
Classification report:
              precision    recall  f1-score   support

           0     0.6218    0.1937    0.2954       382
           1     0.4200    0.8321    0.5582       268

    accuracy                         0.4569       650
   macro avg     0.5209    0.5129    0.4268       650
weighted avg     0.5386    0.4569    0.4038       650

-------- Testing finished --------
