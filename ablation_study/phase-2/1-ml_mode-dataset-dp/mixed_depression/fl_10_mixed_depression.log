Current configuration:
{
    "concurrency_flag": false,
    "data_distribution": "iid",
    "dataset": "mixed_depression",
    "device": "cuda",
    "dp_delta": 0.003,
    "dp_epsilon": 10,
    "eval_batch_size": 4,
    "eval_flag": true,
    "eval_size": 0.2,
    "fed_alg": "fedavg",
    "layers": 3,
    "learning_rate": 0.0006,
    "max_length": 512,
    "ml_mode": "fl",
    "model": "bert_small",
    "model_name": "fl_10_mixed_depression",
    "models_path": "/local/vpaloma/fabric-federated-learning/ablation_study/phase-2/1-ml_mode-dataset-dp/mixed_depression",
    "mu": 0.5,
    "num_clients": 5,
    "num_epochs": 3,
    "num_rounds": 4,
    "optimizer": "AdamW",
    "progress_bar_flag": false,
    "save_model": true,
    "scheduler": "linear",
    "scheduler_warmup_steps": 0,
    "seed": 0,
    "test_flag": true,
    "train_batch_size": 4,
    "train_size": 0.8
}
-------- Configuration loaded --------

-------- Setting device --------
cuda device selected and available.
-------- Device set --------

-------- Setting seed --------
-------- Seed set --------

-------- Creating Model --------
-------- Model created --------

-------- Setting Trainable Layers --------
Training the last 3 layers.

Total parameters count: 28764674
Trainable parameters count: 3416066
-------- Trainable Layers set --------

-------- Creating Tokenizer --------
-------- Tokenizer created --------

-------- Creating Train and Eval Dataloaders --------
Train Loader: 1806 total sentences. 452 batches of size 4.
Eval Loader: 452 total sentences. 113 batches of size 4.
-------- Train and Eval Dataloaders created --------

-------- Training --------
Training with Federated Learning technology.
Training with differential privacy.
Federated averaging algorithm selected.

Round 1 of 4
-------------------------------
Predictions - 1s: 10, 0s: 351
True Labels - 1s: 185, 0s: 176
Predictions - Proportion of 1s: 0.027700831024930747, Proportion of 0s: 0.9722991689750693
True Labels - Proportion of 1s: 0.5124653739612188, Proportion of 0s: 0.48753462603878117
Client 1 of 5: Local Epoch [1/3] Loss: 0.7346, Accuracy: 50.97 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 29, 0s: 332
True Labels - 1s: 185, 0s: 176
Predictions - Proportion of 1s: 0.08033240997229917, Proportion of 0s: 0.9196675900277008
True Labels - Proportion of 1s: 0.5124653739612188, Proportion of 0s: 0.48753462603878117
Client 1 of 5: Local Epoch [2/3] Loss: 0.6783, Accuracy: 54.57 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 34, 0s: 327
True Labels - 1s: 185, 0s: 176
Predictions - Proportion of 1s: 0.09418282548476455, Proportion of 0s: 0.9058171745152355
True Labels - Proportion of 1s: 0.5124653739612188, Proportion of 0s: 0.48753462603878117
Client 1 of 5: Local Epoch [3/3] Loss: 0.6734, Accuracy: 55.96 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 107, 0s: 254
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.296398891966759, Proportion of 0s: 0.703601108033241
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 2 of 5: Local Epoch [1/3] Loss: 0.6966, Accuracy: 57.34 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 139, 0s: 222
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.3850415512465374, Proportion of 0s: 0.6149584487534626
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 2 of 5: Local Epoch [2/3] Loss: 0.6577, Accuracy: 62.88 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 171, 0s: 190
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.47368421052631576, Proportion of 0s: 0.5263157894736842
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 2 of 5: Local Epoch [3/3] Loss: 0.6434, Accuracy: 63.43 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 36, 0s: 325
True Labels - 1s: 197, 0s: 164
Predictions - Proportion of 1s: 0.0997229916897507, Proportion of 0s: 0.9002770083102493
True Labels - Proportion of 1s: 0.5457063711911357, Proportion of 0s: 0.45429362880886426
Client 3 of 5: Local Epoch [1/3] Loss: 0.7146, Accuracy: 52.63 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 197, 0s: 164
True Labels - 1s: 197, 0s: 164
Predictions - Proportion of 1s: 0.5457063711911357, Proportion of 0s: 0.45429362880886426
True Labels - Proportion of 1s: 0.5457063711911357, Proportion of 0s: 0.45429362880886426
Client 3 of 5: Local Epoch [2/3] Loss: 0.6588, Accuracy: 62.33 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 321, 0s: 40
True Labels - 1s: 197, 0s: 164
Predictions - Proportion of 1s: 0.889196675900277, Proportion of 0s: 0.11080332409972299
True Labels - Proportion of 1s: 0.5457063711911357, Proportion of 0s: 0.45429362880886426
Client 3 of 5: Local Epoch [3/3] Loss: 0.6564, Accuracy: 57.89 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 90, 0s: 271
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.24930747922437674, Proportion of 0s: 0.7506925207756233
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 4 of 5: Local Epoch [1/3] Loss: 0.6906, Accuracy: 57.06 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 158, 0s: 203
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.4376731301939058, Proportion of 0s: 0.5623268698060941
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 4 of 5: Local Epoch [2/3] Loss: 0.6394, Accuracy: 66.48 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 145, 0s: 216
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.40166204986149584, Proportion of 0s: 0.5983379501385041
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 4 of 5: Local Epoch [3/3] Loss: 0.6181, Accuracy: 70.08 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 14, 0s: 348
True Labels - 1s: 183, 0s: 179
Predictions - Proportion of 1s: 0.03867403314917127, Proportion of 0s: 0.9613259668508287
True Labels - Proportion of 1s: 0.505524861878453, Proportion of 0s: 0.494475138121547
Client 5 of 5: Local Epoch [1/3] Loss: 0.7307, Accuracy: 50.00 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 13, 0s: 349
True Labels - 1s: 183, 0s: 179
Predictions - Proportion of 1s: 0.03591160220994475, Proportion of 0s: 0.9640883977900553
True Labels - Proportion of 1s: 0.505524861878453, Proportion of 0s: 0.494475138121547
Client 5 of 5: Local Epoch [2/3] Loss: 0.7133, Accuracy: 50.83 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 12, 0s: 350
True Labels - 1s: 183, 0s: 179
Predictions - Proportion of 1s: 0.03314917127071823, Proportion of 0s: 0.9668508287292817
True Labels - Proportion of 1s: 0.505524861878453, Proportion of 0s: 0.494475138121547
Client 5 of 5: Local Epoch [3/3] Loss: 0.7051, Accuracy: 51.66 %, Epsilon: 10.00, Delta: 0.0030
-------------------------------
Round [1/4] Average Local Loss: 0.6593, Average Local Accuracy: 59.81 %
-------------------------------
-------- Validation --------
Predictions - 1s: 136, 0s: 316
True Labels - 1s: 242, 0s: 210
Predictions - Proportion of 1s: 0.3008849557522124, Proportion of 0s: 0.6991150442477876
True Labels - Proportion of 1s: 0.5353982300884956, Proportion of 0s: 0.4646017699115044
Round [1/4] Global Model Validation Loss: 0.6380, Validation Accuracy: 69.47 %
-------- Validation finished --------
Updated best model in round 1 saved with Validation Loss: 0.6379652123535628 and Validation Accuracy: 69.47 %
-------------------------------

Round 2 of 4
-------------------------------
Predictions - 1s: 212, 0s: 149
True Labels - 1s: 185, 0s: 176
Predictions - Proportion of 1s: 0.5872576177285319, Proportion of 0s: 0.41274238227146814
True Labels - Proportion of 1s: 0.5124653739612188, Proportion of 0s: 0.48753462603878117
Client 1 of 5: Local Epoch [1/3] Loss: 0.6432, Accuracy: 63.71 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 156, 0s: 205
True Labels - 1s: 185, 0s: 176
Predictions - Proportion of 1s: 0.43213296398891965, Proportion of 0s: 0.5678670360110804
True Labels - Proportion of 1s: 0.5124653739612188, Proportion of 0s: 0.48753462603878117
Client 1 of 5: Local Epoch [2/3] Loss: 0.6148, Accuracy: 69.81 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 162, 0s: 199
True Labels - 1s: 185, 0s: 176
Predictions - Proportion of 1s: 0.4487534626038781, Proportion of 0s: 0.5512465373961218
True Labels - Proportion of 1s: 0.5124653739612188, Proportion of 0s: 0.48753462603878117
Client 1 of 5: Local Epoch [3/3] Loss: 0.5869, Accuracy: 74.79 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 240, 0s: 121
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.6648199445983379, Proportion of 0s: 0.33518005540166207
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 2 of 5: Local Epoch [1/3] Loss: 0.6382, Accuracy: 62.05 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 303, 0s: 58
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.8393351800554016, Proportion of 0s: 0.16066481994459833
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 2 of 5: Local Epoch [2/3] Loss: 0.6289, Accuracy: 59.56 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 272, 0s: 89
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.7534626038781164, Proportion of 0s: 0.24653739612188366
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 2 of 5: Local Epoch [3/3] Loss: 0.6129, Accuracy: 64.82 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 271, 0s: 90
True Labels - 1s: 197, 0s: 164
Predictions - Proportion of 1s: 0.7506925207756233, Proportion of 0s: 0.24930747922437674
True Labels - Proportion of 1s: 0.5457063711911357, Proportion of 0s: 0.45429362880886426
Client 3 of 5: Local Epoch [1/3] Loss: 0.6458, Accuracy: 62.33 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 334, 0s: 27
True Labels - 1s: 197, 0s: 164
Predictions - Proportion of 1s: 0.925207756232687, Proportion of 0s: 0.07479224376731301
True Labels - Proportion of 1s: 0.5457063711911357, Proportion of 0s: 0.45429362880886426
Client 3 of 5: Local Epoch [2/3] Loss: 0.6413, Accuracy: 57.62 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 356, 0s: 5
True Labels - 1s: 197, 0s: 164
Predictions - Proportion of 1s: 0.9861495844875346, Proportion of 0s: 0.013850415512465374
True Labels - Proportion of 1s: 0.5457063711911357, Proportion of 0s: 0.45429362880886426
Client 3 of 5: Local Epoch [3/3] Loss: 0.6604, Accuracy: 55.96 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 124, 0s: 237
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.34349030470914127, Proportion of 0s: 0.6565096952908587
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 4 of 5: Local Epoch [1/3] Loss: 0.6243, Accuracy: 67.59 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 188, 0s: 173
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.5207756232686981, Proportion of 0s: 0.4792243767313019
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 4 of 5: Local Epoch [2/3] Loss: 0.6024, Accuracy: 69.81 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 208, 0s: 153
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.5761772853185596, Proportion of 0s: 0.42382271468144045
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 4 of 5: Local Epoch [3/3] Loss: 0.5957, Accuracy: 70.36 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 85, 0s: 277
True Labels - 1s: 183, 0s: 179
Predictions - Proportion of 1s: 0.23480662983425415, Proportion of 0s: 0.7651933701657458
True Labels - Proportion of 1s: 0.505524861878453, Proportion of 0s: 0.494475138121547
Client 5 of 5: Local Epoch [1/3] Loss: 0.6631, Accuracy: 62.98 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 60, 0s: 302
True Labels - 1s: 183, 0s: 179
Predictions - Proportion of 1s: 0.16574585635359115, Proportion of 0s: 0.8342541436464088
True Labels - Proportion of 1s: 0.505524861878453, Proportion of 0s: 0.494475138121547
Client 5 of 5: Local Epoch [2/3] Loss: 0.6576, Accuracy: 59.39 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 62, 0s: 300
True Labels - 1s: 183, 0s: 179
Predictions - Proportion of 1s: 0.1712707182320442, Proportion of 0s: 0.8287292817679558
True Labels - Proportion of 1s: 0.505524861878453, Proportion of 0s: 0.494475138121547
Client 5 of 5: Local Epoch [3/3] Loss: 0.6485, Accuracy: 60.50 %, Epsilon: 10.00, Delta: 0.0030
-------------------------------
Round [2/4] Average Local Loss: 0.6209, Average Local Accuracy: 65.29 %
-------------------------------
-------- Validation --------
Predictions - 1s: 265, 0s: 187
True Labels - 1s: 242, 0s: 210
Predictions - Proportion of 1s: 0.5862831858407079, Proportion of 0s: 0.413716814159292
True Labels - Proportion of 1s: 0.5353982300884956, Proportion of 0s: 0.4646017699115044
Round [2/4] Global Model Validation Loss: 0.5875, Validation Accuracy: 74.56 %
-------- Validation finished --------
Updated best model in round 2 saved with Validation Loss: 0.5874524058493893 and Validation Accuracy: 74.56 %
-------------------------------

Round 3 of 4
-------------------------------
Predictions - 1s: 250, 0s: 111
True Labels - 1s: 185, 0s: 176
Predictions - Proportion of 1s: 0.6925207756232687, Proportion of 0s: 0.3074792243767313
True Labels - Proportion of 1s: 0.5124653739612188, Proportion of 0s: 0.48753462603878117
Client 1 of 5: Local Epoch [1/3] Loss: 0.6083, Accuracy: 65.93 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 237, 0s: 124
True Labels - 1s: 185, 0s: 176
Predictions - Proportion of 1s: 0.6565096952908587, Proportion of 0s: 0.34349030470914127
True Labels - Proportion of 1s: 0.5124653739612188, Proportion of 0s: 0.48753462603878117
Client 1 of 5: Local Epoch [2/3] Loss: 0.5800, Accuracy: 70.08 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 236, 0s: 125
True Labels - 1s: 185, 0s: 176
Predictions - Proportion of 1s: 0.6537396121883656, Proportion of 0s: 0.3462603878116344
True Labels - Proportion of 1s: 0.5124653739612188, Proportion of 0s: 0.48753462603878117
Client 1 of 5: Local Epoch [3/3] Loss: 0.5677, Accuracy: 69.25 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 186, 0s: 175
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.5152354570637119, Proportion of 0s: 0.48476454293628807
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 2 of 5: Local Epoch [1/3] Loss: 0.5920, Accuracy: 71.47 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 224, 0s: 137
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.6204986149584487, Proportion of 0s: 0.37950138504155123
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 2 of 5: Local Epoch [2/3] Loss: 0.5780, Accuracy: 71.47 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 222, 0s: 139
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.6149584487534626, Proportion of 0s: 0.3850415512465374
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 2 of 5: Local Epoch [3/3] Loss: 0.5743, Accuracy: 69.81 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 313, 0s: 48
True Labels - 1s: 197, 0s: 164
Predictions - Proportion of 1s: 0.8670360110803325, Proportion of 0s: 0.1329639889196676
True Labels - Proportion of 1s: 0.5457063711911357, Proportion of 0s: 0.45429362880886426
Client 3 of 5: Local Epoch [1/3] Loss: 0.6247, Accuracy: 62.33 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 351, 0s: 10
True Labels - 1s: 197, 0s: 164
Predictions - Proportion of 1s: 0.9722991689750693, Proportion of 0s: 0.027700831024930747
True Labels - Proportion of 1s: 0.5457063711911357, Proportion of 0s: 0.45429362880886426
Client 3 of 5: Local Epoch [2/3] Loss: 0.6624, Accuracy: 56.79 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 352, 0s: 9
True Labels - 1s: 197, 0s: 164
Predictions - Proportion of 1s: 0.9750692520775623, Proportion of 0s: 0.024930747922437674
True Labels - Proportion of 1s: 0.5457063711911357, Proportion of 0s: 0.45429362880886426
Client 3 of 5: Local Epoch [3/3] Loss: 0.6738, Accuracy: 55.96 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 223, 0s: 138
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.6177285318559557, Proportion of 0s: 0.38227146814404434
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 4 of 5: Local Epoch [1/3] Loss: 0.5957, Accuracy: 70.08 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 250, 0s: 111
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.6925207756232687, Proportion of 0s: 0.3074792243767313
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 4 of 5: Local Epoch [2/3] Loss: 0.5693, Accuracy: 70.91 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 257, 0s: 104
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.7119113573407202, Proportion of 0s: 0.2880886426592798
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 4 of 5: Local Epoch [3/3] Loss: 0.5659, Accuracy: 71.75 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 185, 0s: 177
True Labels - 1s: 183, 0s: 179
Predictions - Proportion of 1s: 0.511049723756906, Proportion of 0s: 0.4889502762430939
True Labels - Proportion of 1s: 0.505524861878453, Proportion of 0s: 0.494475138121547
Client 5 of 5: Local Epoch [1/3] Loss: 0.6182, Accuracy: 67.96 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 125, 0s: 237
True Labels - 1s: 183, 0s: 179
Predictions - Proportion of 1s: 0.3453038674033149, Proportion of 0s: 0.6546961325966851
True Labels - Proportion of 1s: 0.505524861878453, Proportion of 0s: 0.494475138121547
Client 5 of 5: Local Epoch [2/3] Loss: 0.6049, Accuracy: 67.40 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 138, 0s: 224
True Labels - 1s: 183, 0s: 179
Predictions - Proportion of 1s: 0.3812154696132597, Proportion of 0s: 0.6187845303867403
True Labels - Proportion of 1s: 0.505524861878453, Proportion of 0s: 0.494475138121547
Client 5 of 5: Local Epoch [3/3] Loss: 0.6002, Accuracy: 69.89 %, Epsilon: 10.00, Delta: 0.0030
-------------------------------
Round [3/4] Average Local Loss: 0.5964, Average Local Accuracy: 67.33 %
-------------------------------
-------- Validation --------
Predictions - 1s: 292, 0s: 160
True Labels - 1s: 242, 0s: 210
Predictions - Proportion of 1s: 0.6460176991150443, Proportion of 0s: 0.35398230088495575
True Labels - Proportion of 1s: 0.5353982300884956, Proportion of 0s: 0.4646017699115044
Round [3/4] Global Model Validation Loss: 0.5503, Validation Accuracy: 73.45 %
-------- Validation finished --------
Updated best model in round 3 saved with Validation Loss: 0.5503244758707232 and Validation Accuracy: 73.45 %
-------------------------------

Round 4 of 4
-------------------------------
Predictions - 1s: 239, 0s: 122
True Labels - 1s: 185, 0s: 176
Predictions - Proportion of 1s: 0.6620498614958449, Proportion of 0s: 0.3379501385041551
True Labels - Proportion of 1s: 0.5124653739612188, Proportion of 0s: 0.48753462603878117
Client 1 of 5: Local Epoch [1/3] Loss: 0.5678, Accuracy: 70.64 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 255, 0s: 106
True Labels - 1s: 185, 0s: 176
Predictions - Proportion of 1s: 0.7063711911357341, Proportion of 0s: 0.29362880886426596
True Labels - Proportion of 1s: 0.5124653739612188, Proportion of 0s: 0.48753462603878117
Client 1 of 5: Local Epoch [2/3] Loss: 0.5697, Accuracy: 68.42 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 236, 0s: 125
True Labels - 1s: 185, 0s: 176
Predictions - Proportion of 1s: 0.6537396121883656, Proportion of 0s: 0.3462603878116344
True Labels - Proportion of 1s: 0.5124653739612188, Proportion of 0s: 0.48753462603878117
Client 1 of 5: Local Epoch [3/3] Loss: 0.5526, Accuracy: 72.02 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 211, 0s: 150
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.5844875346260388, Proportion of 0s: 0.4155124653739612
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 2 of 5: Local Epoch [1/3] Loss: 0.5675, Accuracy: 73.41 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 245, 0s: 116
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.6786703601108033, Proportion of 0s: 0.32132963988919666
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 2 of 5: Local Epoch [2/3] Loss: 0.5564, Accuracy: 71.19 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 230, 0s: 131
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.6371191135734072, Proportion of 0s: 0.3628808864265928
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 2 of 5: Local Epoch [3/3] Loss: 0.5345, Accuracy: 72.58 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 280, 0s: 81
True Labels - 1s: 197, 0s: 164
Predictions - Proportion of 1s: 0.775623268698061, Proportion of 0s: 0.22437673130193905
True Labels - Proportion of 1s: 0.5457063711911357, Proportion of 0s: 0.45429362880886426
Client 3 of 5: Local Epoch [1/3] Loss: 0.5821, Accuracy: 65.93 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 337, 0s: 24
True Labels - 1s: 197, 0s: 164
Predictions - Proportion of 1s: 0.9335180055401662, Proportion of 0s: 0.0664819944598338
True Labels - Proportion of 1s: 0.5457063711911357, Proportion of 0s: 0.45429362880886426
Client 3 of 5: Local Epoch [2/3] Loss: 0.6776, Accuracy: 61.22 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 337, 0s: 24
True Labels - 1s: 197, 0s: 164
Predictions - Proportion of 1s: 0.9335180055401662, Proportion of 0s: 0.0664819944598338
True Labels - Proportion of 1s: 0.5457063711911357, Proportion of 0s: 0.45429362880886426
Client 3 of 5: Local Epoch [3/3] Loss: 0.7028, Accuracy: 59.56 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 240, 0s: 121
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.6648199445983379, Proportion of 0s: 0.33518005540166207
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 4 of 5: Local Epoch [1/3] Loss: 0.5427, Accuracy: 72.58 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 254, 0s: 107
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.703601108033241, Proportion of 0s: 0.296398891966759
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 4 of 5: Local Epoch [2/3] Loss: 0.5491, Accuracy: 73.13 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 249, 0s: 112
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.6897506925207756, Proportion of 0s: 0.31024930747922436
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 4 of 5: Local Epoch [3/3] Loss: 0.5434, Accuracy: 72.30 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 225, 0s: 137
True Labels - 1s: 183, 0s: 179
Predictions - Proportion of 1s: 0.6215469613259669, Proportion of 0s: 0.3784530386740331
True Labels - Proportion of 1s: 0.505524861878453, Proportion of 0s: 0.494475138121547
Client 5 of 5: Local Epoch [1/3] Loss: 0.6187, Accuracy: 65.75 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 224, 0s: 138
True Labels - 1s: 183, 0s: 179
Predictions - Proportion of 1s: 0.6187845303867403, Proportion of 0s: 0.3812154696132597
True Labels - Proportion of 1s: 0.505524861878453, Proportion of 0s: 0.494475138121547
Client 5 of 5: Local Epoch [2/3] Loss: 0.5996, Accuracy: 68.78 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 232, 0s: 130
True Labels - 1s: 183, 0s: 179
Predictions - Proportion of 1s: 0.6408839779005525, Proportion of 0s: 0.35911602209944754
True Labels - Proportion of 1s: 0.505524861878453, Proportion of 0s: 0.494475138121547
Client 5 of 5: Local Epoch [3/3] Loss: 0.5979, Accuracy: 67.68 %, Epsilon: 10.00, Delta: 0.0030
-------------------------------
Round [4/4] Average Local Loss: 0.5863, Average Local Accuracy: 68.83 %
-------------------------------
-------- Validation --------
Predictions - 1s: 317, 0s: 135
True Labels - 1s: 242, 0s: 210
Predictions - Proportion of 1s: 0.7013274336283186, Proportion of 0s: 0.29867256637168144
True Labels - Proportion of 1s: 0.5353982300884956, Proportion of 0s: 0.4646017699115044
Round [4/4] Global Model Validation Loss: 0.5392, Validation Accuracy: 73.23 %
-------- Validation finished --------
Updated best model in round 4 saved with Validation Loss: 0.5391755292637158 and Validation Accuracy: 73.23 %
-------------------------------
Best model in round 4 saved with Validation Loss: 0.5391755292637158 and Validation Accuracy: 73.23 %

-------- Training finished in 22:36 --------

Test flag enabled. Testing the model

-------- Loading best model from model_path --------
Loaded model bert-small from date 15-03-2024 09:33. Trained with Federated Learning technology.
Round 4, lr: 0.0006, optimizer: AdamW
Average train accuracy: 68.83 %, Validation accuracy: 73.23 %
-------- Best model loaded --------

-------- Creating Test Dataloader --------
Test Loader: 564 total sentences. 71 batches of size 8.
-------- Test Dataloader created --------

-------- Testing --------
Predictions - 1s: 357, 0s: 207
True Labels - 1s: 296, 0s: 268
Predictions - Proportion of 1s: 0.6329787234042553, Proportion of 0s: 0.3670212765957447
True Labels - Proportion of 1s: 0.524822695035461, Proportion of 0s: 0.475177304964539
NÂº of test samples: 564
Accuracy: 73.23%
Accuracy 2 : 73.23%
Precision: 74.28%
Recall: 72.62%
F1 Score: 72.54%
Classification report:
              precision    recall  f1-score   support

           0     0.7826    0.6045    0.6821       268
           1     0.7031    0.8480    0.7688       296

    accuracy                         0.7323       564
   macro avg     0.7428    0.7262    0.7254       564
weighted avg     0.7409    0.7323    0.7276       564

-------- Testing finished --------
