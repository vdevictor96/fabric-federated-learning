Current configuration:
{
    "concurrency_flag": false,
    "data_distribution": "iid",
    "dataset": "mixed_depression",
    "device": "cuda",
    "dp_delta": 0.003,
    "dp_epsilon": 10,
    "eval_batch_size": 4,
    "eval_flag": true,
    "eval_size": 0.2,
    "fed_alg": "fedavg",
    "layers": 3,
    "learning_rate": 0.0006,
    "max_length": 512,
    "ml_mode": "fl",
    "model": "bert_small",
    "model_name": "fl_10_seed3_mixed_depression",
    "models_path": "/local/vpaloma/fabric-federated-learning/ablation_study/phase-2/1-ml_mode-dataset-dp/mixed_depression",
    "mu": 0.5,
    "num_clients": 5,
    "num_epochs": 3,
    "num_rounds": 4,
    "optimizer": "AdamW",
    "progress_bar_flag": false,
    "save_model": true,
    "scheduler": "linear",
    "scheduler_warmup_steps": 0,
    "seed": 331,
    "test_flag": true,
    "train_batch_size": 4,
    "train_size": 0.8
}
-------- Configuration loaded --------

-------- Setting device --------
cuda device selected and available.
-------- Device set --------

-------- Setting seed --------
-------- Seed set --------

-------- Creating Model --------
-------- Model created --------

-------- Setting Trainable Layers --------
Training the last 3 layers.

Total parameters count: 28764674
Trainable parameters count: 3416066
-------- Trainable Layers set --------

-------- Creating Tokenizer --------
-------- Tokenizer created --------

-------- Creating Train and Eval Dataloaders --------
Train Loader: 1806 total sentences. 452 batches of size 4.
Eval Loader: 452 total sentences. 113 batches of size 4.
-------- Train and Eval Dataloaders created --------

-------- Training --------
Training with Federated Learning technology.
Training with differential privacy.
Federated averaging algorithm selected.

Round 1 of 4
-------------------------------
Predictions - 1s: 51, 0s: 310
True Labels - 1s: 177, 0s: 184
Predictions - Proportion of 1s: 0.14127423822714683, Proportion of 0s: 0.8587257617728532
True Labels - Proportion of 1s: 0.4903047091412742, Proportion of 0s: 0.5096952908587258
Client 1 of 5: Local Epoch [1/3] Loss: 0.6942, Accuracy: 56.79 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 27, 0s: 334
True Labels - 1s: 177, 0s: 184
Predictions - Proportion of 1s: 0.07479224376731301, Proportion of 0s: 0.925207756232687
True Labels - Proportion of 1s: 0.4903047091412742, Proportion of 0s: 0.5096952908587258
Client 1 of 5: Local Epoch [2/3] Loss: 0.6796, Accuracy: 58.45 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 38, 0s: 323
True Labels - 1s: 177, 0s: 184
Predictions - Proportion of 1s: 0.10526315789473684, Proportion of 0s: 0.8947368421052632
True Labels - Proportion of 1s: 0.4903047091412742, Proportion of 0s: 0.5096952908587258
Client 1 of 5: Local Epoch [3/3] Loss: 0.6704, Accuracy: 58.17 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 177, 0s: 184
True Labels - 1s: 196, 0s: 165
Predictions - Proportion of 1s: 0.4903047091412742, Proportion of 0s: 0.5096952908587258
True Labels - Proportion of 1s: 0.5429362880886427, Proportion of 0s: 0.45706371191135736
Client 2 of 5: Local Epoch [1/3] Loss: 0.6986, Accuracy: 52.08 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 321, 0s: 40
True Labels - 1s: 196, 0s: 165
Predictions - Proportion of 1s: 0.889196675900277, Proportion of 0s: 0.11080332409972299
True Labels - Proportion of 1s: 0.5429362880886427, Proportion of 0s: 0.45706371191135736
Client 2 of 5: Local Epoch [2/3] Loss: 0.6786, Accuracy: 56.51 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 357, 0s: 4
True Labels - 1s: 196, 0s: 165
Predictions - Proportion of 1s: 0.9889196675900277, Proportion of 0s: 0.0110803324099723
True Labels - Proportion of 1s: 0.5429362880886427, Proportion of 0s: 0.45706371191135736
Client 2 of 5: Local Epoch [3/3] Loss: 0.6871, Accuracy: 53.74 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 72, 0s: 289
True Labels - 1s: 180, 0s: 181
Predictions - Proportion of 1s: 0.1994459833795014, Proportion of 0s: 0.8005540166204986
True Labels - Proportion of 1s: 0.4986149584487535, Proportion of 0s: 0.5013850415512465
Client 3 of 5: Local Epoch [1/3] Loss: 0.6954, Accuracy: 54.02 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 39, 0s: 322
True Labels - 1s: 180, 0s: 181
Predictions - Proportion of 1s: 0.10803324099722991, Proportion of 0s: 0.8919667590027701
True Labels - Proportion of 1s: 0.4986149584487535, Proportion of 0s: 0.5013850415512465
Client 3 of 5: Local Epoch [2/3] Loss: 0.6990, Accuracy: 54.85 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 50, 0s: 311
True Labels - 1s: 180, 0s: 181
Predictions - Proportion of 1s: 0.13850415512465375, Proportion of 0s: 0.8614958448753463
True Labels - Proportion of 1s: 0.4986149584487535, Proportion of 0s: 0.5013850415512465
Client 3 of 5: Local Epoch [3/3] Loss: 0.6776, Accuracy: 58.45 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 226, 0s: 135
True Labels - 1s: 205, 0s: 156
Predictions - Proportion of 1s: 0.6260387811634349, Proportion of 0s: 0.3739612188365651
True Labels - Proportion of 1s: 0.5678670360110804, Proportion of 0s: 0.43213296398891965
Client 4 of 5: Local Epoch [1/3] Loss: 0.6830, Accuracy: 55.96 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 358, 0s: 3
True Labels - 1s: 205, 0s: 156
Predictions - Proportion of 1s: 0.9916897506925207, Proportion of 0s: 0.008310249307479225
True Labels - Proportion of 1s: 0.5678670360110804, Proportion of 0s: 0.43213296398891965
Client 4 of 5: Local Epoch [2/3] Loss: 0.7118, Accuracy: 55.96 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 361, 0s: 0
True Labels - 1s: 205, 0s: 156
Predictions - Proportion of 1s: 1.0, Proportion of 0s: 0.0
True Labels - Proportion of 1s: 0.5678670360110804, Proportion of 0s: 0.43213296398891965
Client 4 of 5: Local Epoch [3/3] Loss: 0.7581, Accuracy: 56.79 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 133, 0s: 229
True Labels - 1s: 191, 0s: 171
Predictions - Proportion of 1s: 0.3674033149171271, Proportion of 0s: 0.6325966850828729
True Labels - Proportion of 1s: 0.5276243093922652, Proportion of 0s: 0.4723756906077348
Client 5 of 5: Local Epoch [1/3] Loss: 0.7015, Accuracy: 55.80 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 163, 0s: 199
True Labels - 1s: 191, 0s: 171
Predictions - Proportion of 1s: 0.45027624309392267, Proportion of 0s: 0.5497237569060773
True Labels - Proportion of 1s: 0.5276243093922652, Proportion of 0s: 0.4723756906077348
Client 5 of 5: Local Epoch [2/3] Loss: 0.6697, Accuracy: 58.01 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 232, 0s: 130
True Labels - 1s: 191, 0s: 171
Predictions - Proportion of 1s: 0.6408839779005525, Proportion of 0s: 0.35911602209944754
True Labels - Proportion of 1s: 0.5276243093922652, Proportion of 0s: 0.4723756906077348
Client 5 of 5: Local Epoch [3/3] Loss: 0.6524, Accuracy: 63.81 %, Epsilon: 10.00, Delta: 0.0030
-------------------------------
Round [1/4] Average Local Loss: 0.6891, Average Local Accuracy: 58.19 %
-------------------------------
-------- Validation --------
Predictions - 1s: 272, 0s: 180
True Labels - 1s: 236, 0s: 216
Predictions - Proportion of 1s: 0.6017699115044248, Proportion of 0s: 0.39823008849557523
True Labels - Proportion of 1s: 0.5221238938053098, Proportion of 0s: 0.4778761061946903
Round [1/4] Global Model Validation Loss: 0.6393, Validation Accuracy: 65.04 %
-------- Validation finished --------
Updated best model in round 1 saved with Validation Loss: 0.6393491665346432 and Validation Accuracy: 65.04 %
-------------------------------

Round 2 of 4
-------------------------------
Predictions - 1s: 257, 0s: 104
True Labels - 1s: 177, 0s: 184
Predictions - Proportion of 1s: 0.7119113573407202, Proportion of 0s: 0.2880886426592798
True Labels - Proportion of 1s: 0.4903047091412742, Proportion of 0s: 0.5096952908587258
Client 1 of 5: Local Epoch [1/3] Loss: 0.6369, Accuracy: 63.43 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 139, 0s: 222
True Labels - 1s: 177, 0s: 184
Predictions - Proportion of 1s: 0.3850415512465374, Proportion of 0s: 0.6149584487534626
True Labels - Proportion of 1s: 0.4903047091412742, Proportion of 0s: 0.5096952908587258
Client 1 of 5: Local Epoch [2/3] Loss: 0.6068, Accuracy: 67.31 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 134, 0s: 227
True Labels - 1s: 177, 0s: 184
Predictions - Proportion of 1s: 0.37119113573407203, Proportion of 0s: 0.628808864265928
True Labels - Proportion of 1s: 0.4903047091412742, Proportion of 0s: 0.5096952908587258
Client 1 of 5: Local Epoch [3/3] Loss: 0.5824, Accuracy: 71.47 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 278, 0s: 83
True Labels - 1s: 196, 0s: 165
Predictions - Proportion of 1s: 0.7700831024930748, Proportion of 0s: 0.2299168975069252
True Labels - Proportion of 1s: 0.5429362880886427, Proportion of 0s: 0.45706371191135736
Client 2 of 5: Local Epoch [1/3] Loss: 0.6392, Accuracy: 62.88 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 324, 0s: 37
True Labels - 1s: 196, 0s: 165
Predictions - Proportion of 1s: 0.8975069252077562, Proportion of 0s: 0.10249307479224377
True Labels - Proportion of 1s: 0.5429362880886427, Proportion of 0s: 0.45706371191135736
Client 2 of 5: Local Epoch [2/3] Loss: 0.6335, Accuracy: 61.22 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 346, 0s: 15
True Labels - 1s: 196, 0s: 165
Predictions - Proportion of 1s: 0.9584487534626038, Proportion of 0s: 0.04155124653739612
True Labels - Proportion of 1s: 0.5429362880886427, Proportion of 0s: 0.45706371191135736
Client 2 of 5: Local Epoch [3/3] Loss: 0.6547, Accuracy: 56.79 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 303, 0s: 58
True Labels - 1s: 180, 0s: 181
Predictions - Proportion of 1s: 0.8393351800554016, Proportion of 0s: 0.16066481994459833
True Labels - Proportion of 1s: 0.4986149584487535, Proportion of 0s: 0.5013850415512465
Client 3 of 5: Local Epoch [1/3] Loss: 0.6761, Accuracy: 53.19 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 230, 0s: 131
True Labels - 1s: 180, 0s: 181
Predictions - Proportion of 1s: 0.6371191135734072, Proportion of 0s: 0.3628808864265928
True Labels - Proportion of 1s: 0.4986149584487535, Proportion of 0s: 0.5013850415512465
Client 3 of 5: Local Epoch [2/3] Loss: 0.6242, Accuracy: 65.65 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 206, 0s: 155
True Labels - 1s: 180, 0s: 181
Predictions - Proportion of 1s: 0.5706371191135734, Proportion of 0s: 0.4293628808864266
True Labels - Proportion of 1s: 0.4986149584487535, Proportion of 0s: 0.5013850415512465
Client 3 of 5: Local Epoch [3/3] Loss: 0.6028, Accuracy: 68.98 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 348, 0s: 13
True Labels - 1s: 205, 0s: 156
Predictions - Proportion of 1s: 0.96398891966759, Proportion of 0s: 0.036011080332409975
True Labels - Proportion of 1s: 0.5678670360110804, Proportion of 0s: 0.43213296398891965
Client 4 of 5: Local Epoch [1/3] Loss: 0.6708, Accuracy: 56.51 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 361, 0s: 0
True Labels - 1s: 205, 0s: 156
Predictions - Proportion of 1s: 1.0, Proportion of 0s: 0.0
True Labels - Proportion of 1s: 0.5678670360110804, Proportion of 0s: 0.43213296398891965
Client 4 of 5: Local Epoch [2/3] Loss: 0.7868, Accuracy: 56.79 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 361, 0s: 0
True Labels - 1s: 205, 0s: 156
Predictions - Proportion of 1s: 1.0, Proportion of 0s: 0.0
True Labels - Proportion of 1s: 0.5678670360110804, Proportion of 0s: 0.43213296398891965
Client 4 of 5: Local Epoch [3/3] Loss: 0.8614, Accuracy: 56.79 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 249, 0s: 113
True Labels - 1s: 191, 0s: 171
Predictions - Proportion of 1s: 0.6878453038674033, Proportion of 0s: 0.31215469613259667
True Labels - Proportion of 1s: 0.5276243093922652, Proportion of 0s: 0.4723756906077348
Client 5 of 5: Local Epoch [1/3] Loss: 0.6429, Accuracy: 62.43 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 305, 0s: 57
True Labels - 1s: 191, 0s: 171
Predictions - Proportion of 1s: 0.8425414364640884, Proportion of 0s: 0.1574585635359116
True Labels - Proportion of 1s: 0.5276243093922652, Proportion of 0s: 0.4723756906077348
Client 5 of 5: Local Epoch [2/3] Loss: 0.6395, Accuracy: 61.88 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 317, 0s: 45
True Labels - 1s: 191, 0s: 171
Predictions - Proportion of 1s: 0.8756906077348067, Proportion of 0s: 0.12430939226519337
True Labels - Proportion of 1s: 0.5276243093922652, Proportion of 0s: 0.4723756906077348
Client 5 of 5: Local Epoch [3/3] Loss: 0.6489, Accuracy: 56.91 %, Epsilon: 10.00, Delta: 0.0030
-------------------------------
Round [2/4] Average Local Loss: 0.6700, Average Local Accuracy: 62.18 %
-------------------------------
-------- Validation --------
Predictions - 1s: 374, 0s: 78
True Labels - 1s: 236, 0s: 216
Predictions - Proportion of 1s: 0.827433628318584, Proportion of 0s: 0.17256637168141592
True Labels - Proportion of 1s: 0.5221238938053098, Proportion of 0s: 0.4778761061946903
Round [2/4] Global Model Validation Loss: 0.6176, Validation Accuracy: 63.72 %
-------- Validation finished --------
Updated best model in round 2 saved with Validation Loss: 0.617622598610093 and Validation Accuracy: 63.72 %
-------------------------------

Round 3 of 4
-------------------------------
Predictions - 1s: 278, 0s: 83
True Labels - 1s: 177, 0s: 184
Predictions - Proportion of 1s: 0.7700831024930748, Proportion of 0s: 0.2299168975069252
True Labels - Proportion of 1s: 0.4903047091412742, Proportion of 0s: 0.5096952908587258
Client 1 of 5: Local Epoch [1/3] Loss: 0.6245, Accuracy: 62.60 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 190, 0s: 171
True Labels - 1s: 177, 0s: 184
Predictions - Proportion of 1s: 0.5263157894736842, Proportion of 0s: 0.47368421052631576
True Labels - Proportion of 1s: 0.4903047091412742, Proportion of 0s: 0.5096952908587258
Client 1 of 5: Local Epoch [2/3] Loss: 0.5475, Accuracy: 73.68 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 153, 0s: 208
True Labels - 1s: 177, 0s: 184
Predictions - Proportion of 1s: 0.42382271468144045, Proportion of 0s: 0.5761772853185596
True Labels - Proportion of 1s: 0.4903047091412742, Proportion of 0s: 0.5096952908587258
Client 1 of 5: Local Epoch [3/3] Loss: 0.5296, Accuracy: 73.41 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 285, 0s: 76
True Labels - 1s: 196, 0s: 165
Predictions - Proportion of 1s: 0.7894736842105263, Proportion of 0s: 0.21052631578947367
True Labels - Proportion of 1s: 0.5429362880886427, Proportion of 0s: 0.45706371191135736
Client 2 of 5: Local Epoch [1/3] Loss: 0.6090, Accuracy: 63.71 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 312, 0s: 49
True Labels - 1s: 196, 0s: 165
Predictions - Proportion of 1s: 0.8642659279778393, Proportion of 0s: 0.13573407202216067
True Labels - Proportion of 1s: 0.5429362880886427, Proportion of 0s: 0.45706371191135736
Client 2 of 5: Local Epoch [2/3] Loss: 0.6394, Accuracy: 61.22 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 332, 0s: 29
True Labels - 1s: 196, 0s: 165
Predictions - Proportion of 1s: 0.9196675900277008, Proportion of 0s: 0.08033240997229917
True Labels - Proportion of 1s: 0.5429362880886427, Proportion of 0s: 0.45706371191135736
Client 2 of 5: Local Epoch [3/3] Loss: 0.6591, Accuracy: 60.66 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 340, 0s: 21
True Labels - 1s: 180, 0s: 181
Predictions - Proportion of 1s: 0.9418282548476454, Proportion of 0s: 0.05817174515235457
True Labels - Proportion of 1s: 0.4986149584487535, Proportion of 0s: 0.5013850415512465
Client 3 of 5: Local Epoch [1/3] Loss: 0.7186, Accuracy: 55.68 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 313, 0s: 48
True Labels - 1s: 180, 0s: 181
Predictions - Proportion of 1s: 0.8670360110803325, Proportion of 0s: 0.1329639889196676
True Labels - Proportion of 1s: 0.4986149584487535, Proportion of 0s: 0.5013850415512465
Client 3 of 5: Local Epoch [2/3] Loss: 0.6571, Accuracy: 58.17 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 300, 0s: 61
True Labels - 1s: 180, 0s: 181
Predictions - Proportion of 1s: 0.8310249307479224, Proportion of 0s: 0.16897506925207756
True Labels - Proportion of 1s: 0.4986149584487535, Proportion of 0s: 0.5013850415512465
Client 3 of 5: Local Epoch [3/3] Loss: 0.6502, Accuracy: 61.77 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 354, 0s: 7
True Labels - 1s: 205, 0s: 156
Predictions - Proportion of 1s: 0.9806094182825484, Proportion of 0s: 0.019390581717451522
True Labels - Proportion of 1s: 0.5678670360110804, Proportion of 0s: 0.43213296398891965
Client 4 of 5: Local Epoch [1/3] Loss: 0.6955, Accuracy: 58.73 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 361, 0s: 0
True Labels - 1s: 205, 0s: 156
Predictions - Proportion of 1s: 1.0, Proportion of 0s: 0.0
True Labels - Proportion of 1s: 0.5678670360110804, Proportion of 0s: 0.43213296398891965
Client 4 of 5: Local Epoch [2/3] Loss: 0.8956, Accuracy: 56.79 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 361, 0s: 0
True Labels - 1s: 205, 0s: 156
Predictions - Proportion of 1s: 1.0, Proportion of 0s: 0.0
True Labels - Proportion of 1s: 0.5678670360110804, Proportion of 0s: 0.43213296398891965
Client 4 of 5: Local Epoch [3/3] Loss: 1.0216, Accuracy: 56.79 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 336, 0s: 26
True Labels - 1s: 191, 0s: 171
Predictions - Proportion of 1s: 0.9281767955801105, Proportion of 0s: 0.0718232044198895
True Labels - Proportion of 1s: 0.5276243093922652, Proportion of 0s: 0.4723756906077348
Client 5 of 5: Local Epoch [1/3] Loss: 0.6794, Accuracy: 57.18 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 348, 0s: 14
True Labels - 1s: 191, 0s: 171
Predictions - Proportion of 1s: 0.9613259668508287, Proportion of 0s: 0.03867403314917127
True Labels - Proportion of 1s: 0.5276243093922652, Proportion of 0s: 0.4723756906077348
Client 5 of 5: Local Epoch [2/3] Loss: 0.7222, Accuracy: 56.08 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 349, 0s: 13
True Labels - 1s: 191, 0s: 171
Predictions - Proportion of 1s: 0.9640883977900553, Proportion of 0s: 0.03591160220994475
True Labels - Proportion of 1s: 0.5276243093922652, Proportion of 0s: 0.4723756906077348
Client 5 of 5: Local Epoch [3/3] Loss: 0.7059, Accuracy: 56.35 %, Epsilon: 10.00, Delta: 0.0030
-------------------------------
Round [3/4] Average Local Loss: 0.7133, Average Local Accuracy: 61.80 %
-------------------------------
-------- Validation --------
Predictions - 1s: 402, 0s: 50
True Labels - 1s: 236, 0s: 216
Predictions - Proportion of 1s: 0.8893805309734514, Proportion of 0s: 0.11061946902654868
True Labels - Proportion of 1s: 0.5221238938053098, Proportion of 0s: 0.4778761061946903
Round [3/4] Global Model Validation Loss: 0.6584, Validation Accuracy: 61.06 %
-------- Validation finished --------

Round 4 of 4
-------------------------------
Predictions - 1s: 251, 0s: 110
True Labels - 1s: 177, 0s: 184
Predictions - Proportion of 1s: 0.6952908587257618, Proportion of 0s: 0.3047091412742382
True Labels - Proportion of 1s: 0.4903047091412742, Proportion of 0s: 0.5096952908587258
Client 1 of 5: Local Epoch [1/3] Loss: 0.5904, Accuracy: 67.87 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 179, 0s: 182
True Labels - 1s: 177, 0s: 184
Predictions - Proportion of 1s: 0.49584487534626037, Proportion of 0s: 0.5041551246537396
True Labels - Proportion of 1s: 0.4903047091412742, Proportion of 0s: 0.5096952908587258
Client 1 of 5: Local Epoch [2/3] Loss: 0.5276, Accuracy: 74.52 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 162, 0s: 199
True Labels - 1s: 177, 0s: 184
Predictions - Proportion of 1s: 0.4487534626038781, Proportion of 0s: 0.5512465373961218
True Labels - Proportion of 1s: 0.4903047091412742, Proportion of 0s: 0.5096952908587258
Client 1 of 5: Local Epoch [3/3] Loss: 0.4902, Accuracy: 79.22 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 308, 0s: 53
True Labels - 1s: 196, 0s: 165
Predictions - Proportion of 1s: 0.853185595567867, Proportion of 0s: 0.14681440443213298
True Labels - Proportion of 1s: 0.5429362880886427, Proportion of 0s: 0.45706371191135736
Client 2 of 5: Local Epoch [1/3] Loss: 0.6423, Accuracy: 65.10 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 327, 0s: 34
True Labels - 1s: 196, 0s: 165
Predictions - Proportion of 1s: 0.9058171745152355, Proportion of 0s: 0.09418282548476455
True Labels - Proportion of 1s: 0.5429362880886427, Proportion of 0s: 0.45706371191135736
Client 2 of 5: Local Epoch [2/3] Loss: 0.8217, Accuracy: 60.94 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 338, 0s: 23
True Labels - 1s: 196, 0s: 165
Predictions - Proportion of 1s: 0.9362880886426593, Proportion of 0s: 0.06371191135734072
True Labels - Proportion of 1s: 0.5429362880886427, Proportion of 0s: 0.45706371191135736
Client 2 of 5: Local Epoch [3/3] Loss: 0.9116, Accuracy: 59.56 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 313, 0s: 48
True Labels - 1s: 180, 0s: 181
Predictions - Proportion of 1s: 0.8670360110803325, Proportion of 0s: 0.1329639889196676
True Labels - Proportion of 1s: 0.4986149584487535, Proportion of 0s: 0.5013850415512465
Client 3 of 5: Local Epoch [1/3] Loss: 0.7134, Accuracy: 59.83 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 261, 0s: 100
True Labels - 1s: 180, 0s: 181
Predictions - Proportion of 1s: 0.7229916897506925, Proportion of 0s: 0.2770083102493075
True Labels - Proportion of 1s: 0.4986149584487535, Proportion of 0s: 0.5013850415512465
Client 3 of 5: Local Epoch [2/3] Loss: 0.6228, Accuracy: 65.93 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 230, 0s: 131
True Labels - 1s: 180, 0s: 181
Predictions - Proportion of 1s: 0.6371191135734072, Proportion of 0s: 0.3628808864265928
True Labels - Proportion of 1s: 0.4986149584487535, Proportion of 0s: 0.5013850415512465
Client 3 of 5: Local Epoch [3/3] Loss: 0.5811, Accuracy: 71.19 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 331, 0s: 30
True Labels - 1s: 205, 0s: 156
Predictions - Proportion of 1s: 0.9168975069252078, Proportion of 0s: 0.08310249307479224
True Labels - Proportion of 1s: 0.5678670360110804, Proportion of 0s: 0.43213296398891965
Client 4 of 5: Local Epoch [1/3] Loss: 0.6892, Accuracy: 62.88 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 355, 0s: 6
True Labels - 1s: 205, 0s: 156
Predictions - Proportion of 1s: 0.9833795013850416, Proportion of 0s: 0.01662049861495845
True Labels - Proportion of 1s: 0.5678670360110804, Proportion of 0s: 0.43213296398891965
Client 4 of 5: Local Epoch [2/3] Loss: 0.9066, Accuracy: 58.45 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 359, 0s: 2
True Labels - 1s: 205, 0s: 156
Predictions - Proportion of 1s: 0.9944598337950139, Proportion of 0s: 0.00554016620498615
True Labels - Proportion of 1s: 0.5678670360110804, Proportion of 0s: 0.43213296398891965
Client 4 of 5: Local Epoch [3/3] Loss: 0.9862, Accuracy: 57.34 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 328, 0s: 34
True Labels - 1s: 191, 0s: 171
Predictions - Proportion of 1s: 0.9060773480662984, Proportion of 0s: 0.09392265193370165
True Labels - Proportion of 1s: 0.5276243093922652, Proportion of 0s: 0.4723756906077348
Client 5 of 5: Local Epoch [1/3] Loss: 0.7316, Accuracy: 58.84 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 312, 0s: 50
True Labels - 1s: 191, 0s: 171
Predictions - Proportion of 1s: 0.861878453038674, Proportion of 0s: 0.13812154696132597
True Labels - Proportion of 1s: 0.5276243093922652, Proportion of 0s: 0.4723756906077348
Client 5 of 5: Local Epoch [2/3] Loss: 0.7101, Accuracy: 63.26 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 315, 0s: 47
True Labels - 1s: 191, 0s: 171
Predictions - Proportion of 1s: 0.8701657458563536, Proportion of 0s: 0.1298342541436464
True Labels - Proportion of 1s: 0.5276243093922652, Proportion of 0s: 0.4723756906077348
Client 5 of 5: Local Epoch [3/3] Loss: 0.7344, Accuracy: 62.43 %, Epsilon: 10.00, Delta: 0.0030
-------------------------------
Round [4/4] Average Local Loss: 0.7407, Average Local Accuracy: 65.95 %
-------------------------------
-------- Validation --------
Predictions - 1s: 348, 0s: 104
True Labels - 1s: 236, 0s: 216
Predictions - Proportion of 1s: 0.7699115044247787, Proportion of 0s: 0.23008849557522124
True Labels - Proportion of 1s: 0.5221238938053098, Proportion of 0s: 0.4778761061946903
Round [4/4] Global Model Validation Loss: 0.6404, Validation Accuracy: 69.03 %
-------- Validation finished --------
Best model in round 2 saved with Validation Loss: 0.617622598610093 and Validation Accuracy: 63.72 %

-------- Training finished in 22:48 --------

Test flag enabled. Testing the model

-------- Loading best model from model_path --------
Loaded model bert-small from date 15-03-2024 09:33. Trained with Federated Learning technology.
Round 2, lr: 0.0006, optimizer: AdamW
Average train accuracy: 62.18 %, Validation accuracy: 63.72 %
-------- Best model loaded --------

-------- Creating Test Dataloader --------
Test Loader: 564 total sentences. 71 batches of size 8.
-------- Test Dataloader created --------

-------- Testing --------
Predictions - 1s: 463, 0s: 101
True Labels - 1s: 296, 0s: 268
Predictions - Proportion of 1s: 0.8209219858156028, Proportion of 0s: 0.17907801418439717
True Labels - Proportion of 1s: 0.524822695035461, Proportion of 0s: 0.475177304964539
NÂº of test samples: 564
Accuracy: 64.72%
Accuracy 2 : 64.72%
Precision: 72.32%
Recall: 63.16%
F1 Score: 59.93%
Classification report:
              precision    recall  f1-score   support

           0     0.8416    0.3172    0.4607       268
           1     0.6048    0.9459    0.7378       296

    accuracy                         0.6472       564
   macro avg     0.7232    0.6316    0.5993       564
weighted avg     0.7173    0.6472    0.6061       564

-------- Testing finished --------
