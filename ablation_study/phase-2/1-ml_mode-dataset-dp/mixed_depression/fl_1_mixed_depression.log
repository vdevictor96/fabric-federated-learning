Current configuration:
{
    "concurrency_flag": false,
    "data_distribution": "iid",
    "dataset": "mixed_depression",
    "device": "cuda",
    "dp_delta": 0.003,
    "dp_epsilon": 1,
    "eval_batch_size": 4,
    "eval_flag": true,
    "eval_size": 0.2,
    "fed_alg": "fedavg",
    "layers": 3,
    "learning_rate": 0.0006,
    "max_length": 512,
    "ml_mode": "fl",
    "model": "bert_small",
    "model_name": "fl_1_mixed_depression",
    "models_path": "/local/vpaloma/fabric-federated-learning/ablation_study/phase-2/1-ml_mode-dataset-dp/mixed_depression",
    "mu": 0.5,
    "num_clients": 5,
    "num_epochs": 3,
    "num_rounds": 4,
    "optimizer": "AdamW",
    "progress_bar_flag": false,
    "save_model": true,
    "scheduler": "linear",
    "scheduler_warmup_steps": 0,
    "seed": 0,
    "test_flag": true,
    "train_batch_size": 4,
    "train_size": 0.8
}
-------- Configuration loaded --------

-------- Setting device --------
cuda device selected and available.
-------- Device set --------

-------- Setting seed --------
-------- Seed set --------

-------- Creating Model --------
-------- Model created --------

-------- Setting Trainable Layers --------
Training the last 3 layers.

Total parameters count: 28764674
Trainable parameters count: 3416066
-------- Trainable Layers set --------

-------- Creating Tokenizer --------
-------- Tokenizer created --------

-------- Creating Train and Eval Dataloaders --------
Train Loader: 1806 total sentences. 452 batches of size 4.
Eval Loader: 452 total sentences. 113 batches of size 4.
-------- Train and Eval Dataloaders created --------

-------- Training --------
Training with Federated Learning technology.
Training with differential privacy.
Federated averaging algorithm selected.

Round 1 of 4
-------------------------------
Predictions - 1s: 9, 0s: 352
True Labels - 1s: 185, 0s: 176
Predictions - Proportion of 1s: 0.024930747922437674, Proportion of 0s: 0.9750692520775623
True Labels - Proportion of 1s: 0.5124653739612188, Proportion of 0s: 0.48753462603878117
Client 1 of 5: Local Epoch [1/3] Loss: 0.7312, Accuracy: 50.69 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 15, 0s: 346
True Labels - 1s: 185, 0s: 176
Predictions - Proportion of 1s: 0.04155124653739612, Proportion of 0s: 0.9584487534626038
True Labels - Proportion of 1s: 0.5124653739612188, Proportion of 0s: 0.48753462603878117
Client 1 of 5: Local Epoch [2/3] Loss: 0.6965, Accuracy: 51.25 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 14, 0s: 347
True Labels - 1s: 185, 0s: 176
Predictions - Proportion of 1s: 0.038781163434903045, Proportion of 0s: 0.961218836565097
True Labels - Proportion of 1s: 0.5124653739612188, Proportion of 0s: 0.48753462603878117
Client 1 of 5: Local Epoch [3/3] Loss: 0.6972, Accuracy: 51.52 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 39, 0s: 322
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.10803324099722991, Proportion of 0s: 0.8919667590027701
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 2 of 5: Local Epoch [1/3] Loss: 0.7049, Accuracy: 51.80 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 47, 0s: 314
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.13019390581717452, Proportion of 0s: 0.8698060941828255
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 2 of 5: Local Epoch [2/3] Loss: 0.6852, Accuracy: 53.46 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 77, 0s: 284
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.21329639889196675, Proportion of 0s: 0.7867036011080333
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 2 of 5: Local Epoch [3/3] Loss: 0.6766, Accuracy: 56.23 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 29, 0s: 332
True Labels - 1s: 197, 0s: 164
Predictions - Proportion of 1s: 0.08033240997229917, Proportion of 0s: 0.9196675900277008
True Labels - Proportion of 1s: 0.5457063711911357, Proportion of 0s: 0.45429362880886426
Client 3 of 5: Local Epoch [1/3] Loss: 0.7212, Accuracy: 50.14 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 131, 0s: 230
True Labels - 1s: 197, 0s: 164
Predictions - Proportion of 1s: 0.3628808864265928, Proportion of 0s: 0.6371191135734072
True Labels - Proportion of 1s: 0.5457063711911357, Proportion of 0s: 0.45429362880886426
Client 3 of 5: Local Epoch [2/3] Loss: 0.6842, Accuracy: 56.79 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 207, 0s: 154
True Labels - 1s: 197, 0s: 164
Predictions - Proportion of 1s: 0.5734072022160664, Proportion of 0s: 0.4265927977839335
True Labels - Proportion of 1s: 0.5457063711911357, Proportion of 0s: 0.45429362880886426
Client 3 of 5: Local Epoch [3/3] Loss: 0.6776, Accuracy: 56.79 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 39, 0s: 322
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.10803324099722991, Proportion of 0s: 0.8919667590027701
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 4 of 5: Local Epoch [1/3] Loss: 0.6995, Accuracy: 50.69 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 82, 0s: 279
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.22714681440443213, Proportion of 0s: 0.7728531855955678
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 4 of 5: Local Epoch [2/3] Loss: 0.6657, Accuracy: 59.83 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 69, 0s: 292
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.19113573407202217, Proportion of 0s: 0.8088642659279779
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 4 of 5: Local Epoch [3/3] Loss: 0.6540, Accuracy: 62.33 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 12, 0s: 350
True Labels - 1s: 183, 0s: 179
Predictions - Proportion of 1s: 0.03314917127071823, Proportion of 0s: 0.9668508287292817
True Labels - Proportion of 1s: 0.505524861878453, Proportion of 0s: 0.494475138121547
Client 5 of 5: Local Epoch [1/3] Loss: 0.7332, Accuracy: 50.00 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 12, 0s: 350
True Labels - 1s: 183, 0s: 179
Predictions - Proportion of 1s: 0.03314917127071823, Proportion of 0s: 0.9668508287292817
True Labels - Proportion of 1s: 0.505524861878453, Proportion of 0s: 0.494475138121547
Client 5 of 5: Local Epoch [2/3] Loss: 0.7163, Accuracy: 50.00 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 10, 0s: 352
True Labels - 1s: 183, 0s: 179
Predictions - Proportion of 1s: 0.027624309392265192, Proportion of 0s: 0.9723756906077348
True Labels - Proportion of 1s: 0.505524861878453, Proportion of 0s: 0.494475138121547
Client 5 of 5: Local Epoch [3/3] Loss: 0.7177, Accuracy: 50.00 %, Epsilon: 0.99, Delta: 0.0030
-------------------------------
Round [1/4] Average Local Loss: 0.6846, Average Local Accuracy: 55.37 %
-------------------------------
-------- Validation --------
Predictions - 1s: 60, 0s: 392
True Labels - 1s: 242, 0s: 210
Predictions - Proportion of 1s: 0.13274336283185842, Proportion of 0s: 0.8672566371681416
True Labels - Proportion of 1s: 0.5353982300884956, Proportion of 0s: 0.4646017699115044
Round [1/4] Global Model Validation Loss: 0.6731, Validation Accuracy: 57.52 %
-------- Validation finished --------
Updated best model in round 1 saved with Validation Loss: 0.6731329367751568 and Validation Accuracy: 57.52 %
-------------------------------

Round 2 of 4
-------------------------------
Predictions - 1s: 103, 0s: 258
True Labels - 1s: 185, 0s: 176
Predictions - Proportion of 1s: 0.2853185595567867, Proportion of 0s: 0.7146814404432132
True Labels - Proportion of 1s: 0.5124653739612188, Proportion of 0s: 0.48753462603878117
Client 1 of 5: Local Epoch [1/3] Loss: 0.6725, Accuracy: 62.88 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 88, 0s: 273
True Labels - 1s: 185, 0s: 176
Predictions - Proportion of 1s: 0.24376731301939059, Proportion of 0s: 0.7562326869806094
True Labels - Proportion of 1s: 0.5124653739612188, Proportion of 0s: 0.48753462603878117
Client 1 of 5: Local Epoch [2/3] Loss: 0.6615, Accuracy: 58.73 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 98, 0s: 263
True Labels - 1s: 185, 0s: 176
Predictions - Proportion of 1s: 0.27146814404432135, Proportion of 0s: 0.7285318559556787
True Labels - Proportion of 1s: 0.5124653739612188, Proportion of 0s: 0.48753462603878117
Client 1 of 5: Local Epoch [3/3] Loss: 0.6392, Accuracy: 67.04 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 111, 0s: 250
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.3074792243767313, Proportion of 0s: 0.6925207756232687
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 2 of 5: Local Epoch [1/3] Loss: 0.6674, Accuracy: 60.66 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 155, 0s: 206
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.4293628808864266, Proportion of 0s: 0.5706371191135734
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 2 of 5: Local Epoch [2/3] Loss: 0.6531, Accuracy: 63.43 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 152, 0s: 209
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.42105263157894735, Proportion of 0s: 0.5789473684210527
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 2 of 5: Local Epoch [3/3] Loss: 0.6506, Accuracy: 65.37 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 150, 0s: 211
True Labels - 1s: 197, 0s: 164
Predictions - Proportion of 1s: 0.4155124653739612, Proportion of 0s: 0.5844875346260388
True Labels - Proportion of 1s: 0.5457063711911357, Proportion of 0s: 0.45429362880886426
Client 3 of 5: Local Epoch [1/3] Loss: 0.6752, Accuracy: 58.17 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 211, 0s: 150
True Labels - 1s: 197, 0s: 164
Predictions - Proportion of 1s: 0.5844875346260388, Proportion of 0s: 0.4155124653739612
True Labels - Proportion of 1s: 0.5457063711911357, Proportion of 0s: 0.45429362880886426
Client 3 of 5: Local Epoch [2/3] Loss: 0.6601, Accuracy: 63.99 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 280, 0s: 81
True Labels - 1s: 197, 0s: 164
Predictions - Proportion of 1s: 0.775623268698061, Proportion of 0s: 0.22437673130193905
True Labels - Proportion of 1s: 0.5457063711911357, Proportion of 0s: 0.45429362880886426
Client 3 of 5: Local Epoch [3/3] Loss: 0.6433, Accuracy: 64.27 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 67, 0s: 294
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.18559556786703602, Proportion of 0s: 0.814404432132964
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 4 of 5: Local Epoch [1/3] Loss: 0.6654, Accuracy: 60.11 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 97, 0s: 264
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.26869806094182824, Proportion of 0s: 0.7313019390581718
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 4 of 5: Local Epoch [2/3] Loss: 0.6513, Accuracy: 64.54 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 99, 0s: 262
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.2742382271468144, Proportion of 0s: 0.7257617728531855
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 4 of 5: Local Epoch [3/3] Loss: 0.6478, Accuracy: 66.20 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 36, 0s: 326
True Labels - 1s: 183, 0s: 179
Predictions - Proportion of 1s: 0.09944751381215469, Proportion of 0s: 0.9005524861878453
True Labels - Proportion of 1s: 0.505524861878453, Proportion of 0s: 0.494475138121547
Client 5 of 5: Local Epoch [1/3] Loss: 0.6957, Accuracy: 52.76 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 24, 0s: 338
True Labels - 1s: 183, 0s: 179
Predictions - Proportion of 1s: 0.06629834254143646, Proportion of 0s: 0.9337016574585635
True Labels - Proportion of 1s: 0.505524861878453, Proportion of 0s: 0.494475138121547
Client 5 of 5: Local Epoch [2/3] Loss: 0.7005, Accuracy: 52.76 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 24, 0s: 338
True Labels - 1s: 183, 0s: 179
Predictions - Proportion of 1s: 0.06629834254143646, Proportion of 0s: 0.9337016574585635
True Labels - Proportion of 1s: 0.505524861878453, Proportion of 0s: 0.494475138121547
Client 5 of 5: Local Epoch [3/3] Loss: 0.6947, Accuracy: 53.87 %, Epsilon: 0.99, Delta: 0.0030
-------------------------------
Round [2/4] Average Local Loss: 0.6551, Average Local Accuracy: 63.35 %
-------------------------------
-------- Validation --------
Predictions - 1s: 144, 0s: 308
True Labels - 1s: 242, 0s: 210
Predictions - Proportion of 1s: 0.3185840707964602, Proportion of 0s: 0.6814159292035398
True Labels - Proportion of 1s: 0.5353982300884956, Proportion of 0s: 0.4646017699115044
Round [2/4] Global Model Validation Loss: 0.6399, Validation Accuracy: 70.35 %
-------- Validation finished --------
Updated best model in round 2 saved with Validation Loss: 0.6399081064536508 and Validation Accuracy: 70.35 %
-------------------------------

Round 3 of 4
-------------------------------
Predictions - 1s: 166, 0s: 195
True Labels - 1s: 185, 0s: 176
Predictions - Proportion of 1s: 0.4598337950138504, Proportion of 0s: 0.5401662049861495
True Labels - Proportion of 1s: 0.5124653739612188, Proportion of 0s: 0.48753462603878117
Client 1 of 5: Local Epoch [1/3] Loss: 0.6496, Accuracy: 63.16 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 188, 0s: 173
True Labels - 1s: 185, 0s: 176
Predictions - Proportion of 1s: 0.5207756232686981, Proportion of 0s: 0.4792243767313019
True Labels - Proportion of 1s: 0.5124653739612188, Proportion of 0s: 0.48753462603878117
Client 1 of 5: Local Epoch [2/3] Loss: 0.6260, Accuracy: 69.25 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 179, 0s: 182
True Labels - 1s: 185, 0s: 176
Predictions - Proportion of 1s: 0.49584487534626037, Proportion of 0s: 0.5041551246537396
True Labels - Proportion of 1s: 0.5124653739612188, Proportion of 0s: 0.48753462603878117
Client 1 of 5: Local Epoch [3/3] Loss: 0.6215, Accuracy: 68.98 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 114, 0s: 247
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.3157894736842105, Proportion of 0s: 0.6842105263157895
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 2 of 5: Local Epoch [1/3] Loss: 0.6424, Accuracy: 64.27 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 144, 0s: 217
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.3988919667590028, Proportion of 0s: 0.6011080332409973
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 2 of 5: Local Epoch [2/3] Loss: 0.6281, Accuracy: 68.14 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 146, 0s: 215
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.40443213296398894, Proportion of 0s: 0.5955678670360111
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 2 of 5: Local Epoch [3/3] Loss: 0.6293, Accuracy: 69.81 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 233, 0s: 128
True Labels - 1s: 197, 0s: 164
Predictions - Proportion of 1s: 0.6454293628808865, Proportion of 0s: 0.3545706371191136
True Labels - Proportion of 1s: 0.5457063711911357, Proportion of 0s: 0.45429362880886426
Client 3 of 5: Local Epoch [1/3] Loss: 0.6444, Accuracy: 64.54 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 301, 0s: 60
True Labels - 1s: 197, 0s: 164
Predictions - Proportion of 1s: 0.8337950138504155, Proportion of 0s: 0.16620498614958448
True Labels - Proportion of 1s: 0.5457063711911357, Proportion of 0s: 0.45429362880886426
Client 3 of 5: Local Epoch [2/3] Loss: 0.6365, Accuracy: 60.66 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 307, 0s: 54
True Labels - 1s: 197, 0s: 164
Predictions - Proportion of 1s: 0.850415512465374, Proportion of 0s: 0.14958448753462603
True Labels - Proportion of 1s: 0.5457063711911357, Proportion of 0s: 0.45429362880886426
Client 3 of 5: Local Epoch [3/3] Loss: 0.6260, Accuracy: 62.33 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 112, 0s: 249
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.31024930747922436, Proportion of 0s: 0.6897506925207756
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 4 of 5: Local Epoch [1/3] Loss: 0.6447, Accuracy: 66.48 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 170, 0s: 191
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.4709141274238227, Proportion of 0s: 0.5290858725761773
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 4 of 5: Local Epoch [2/3] Loss: 0.6226, Accuracy: 69.81 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 181, 0s: 180
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.5013850415512465, Proportion of 0s: 0.4986149584487535
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 4 of 5: Local Epoch [3/3] Loss: 0.6163, Accuracy: 73.41 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 75, 0s: 287
True Labels - 1s: 183, 0s: 179
Predictions - Proportion of 1s: 0.20718232044198895, Proportion of 0s: 0.7928176795580111
True Labels - Proportion of 1s: 0.505524861878453, Proportion of 0s: 0.494475138121547
Client 5 of 5: Local Epoch [1/3] Loss: 0.6671, Accuracy: 59.12 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 41, 0s: 321
True Labels - 1s: 183, 0s: 179
Predictions - Proportion of 1s: 0.1132596685082873, Proportion of 0s: 0.8867403314917127
True Labels - Proportion of 1s: 0.505524861878453, Proportion of 0s: 0.494475138121547
Client 5 of 5: Local Epoch [2/3] Loss: 0.6763, Accuracy: 57.46 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 53, 0s: 309
True Labels - 1s: 183, 0s: 179
Predictions - Proportion of 1s: 0.1464088397790055, Proportion of 0s: 0.8535911602209945
True Labels - Proportion of 1s: 0.505524861878453, Proportion of 0s: 0.494475138121547
Client 5 of 5: Local Epoch [3/3] Loss: 0.6689, Accuracy: 55.80 %, Epsilon: 0.99, Delta: 0.0030
-------------------------------
Round [3/4] Average Local Loss: 0.6324, Average Local Accuracy: 66.06 %
-------------------------------
-------- Validation --------
Predictions - 1s: 189, 0s: 263
True Labels - 1s: 242, 0s: 210
Predictions - Proportion of 1s: 0.41814159292035397, Proportion of 0s: 0.581858407079646
True Labels - Proportion of 1s: 0.5353982300884956, Proportion of 0s: 0.4646017699115044
Round [3/4] Global Model Validation Loss: 0.6109, Validation Accuracy: 74.56 %
-------- Validation finished --------
Updated best model in round 3 saved with Validation Loss: 0.6109236768916645 and Validation Accuracy: 74.56 %
-------------------------------

Round 4 of 4
-------------------------------
Predictions - 1s: 171, 0s: 190
True Labels - 1s: 185, 0s: 176
Predictions - Proportion of 1s: 0.47368421052631576, Proportion of 0s: 0.5263157894736842
True Labels - Proportion of 1s: 0.5124653739612188, Proportion of 0s: 0.48753462603878117
Client 1 of 5: Local Epoch [1/3] Loss: 0.6136, Accuracy: 71.75 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 173, 0s: 188
True Labels - 1s: 185, 0s: 176
Predictions - Proportion of 1s: 0.4792243767313019, Proportion of 0s: 0.5207756232686981
True Labels - Proportion of 1s: 0.5124653739612188, Proportion of 0s: 0.48753462603878117
Client 1 of 5: Local Epoch [2/3] Loss: 0.6001, Accuracy: 70.64 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 158, 0s: 203
True Labels - 1s: 185, 0s: 176
Predictions - Proportion of 1s: 0.4376731301939058, Proportion of 0s: 0.5623268698060941
True Labels - Proportion of 1s: 0.5124653739612188, Proportion of 0s: 0.48753462603878117
Client 1 of 5: Local Epoch [3/3] Loss: 0.5923, Accuracy: 69.81 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 151, 0s: 210
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.4182825484764543, Proportion of 0s: 0.5817174515235457
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 2 of 5: Local Epoch [1/3] Loss: 0.6208, Accuracy: 68.98 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 193, 0s: 168
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.5346260387811634, Proportion of 0s: 0.46537396121883656
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 2 of 5: Local Epoch [2/3] Loss: 0.6004, Accuracy: 70.08 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 193, 0s: 168
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.5346260387811634, Proportion of 0s: 0.46537396121883656
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 2 of 5: Local Epoch [3/3] Loss: 0.5932, Accuracy: 70.64 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 205, 0s: 156
True Labels - 1s: 197, 0s: 164
Predictions - Proportion of 1s: 0.5678670360110804, Proportion of 0s: 0.43213296398891965
True Labels - Proportion of 1s: 0.5457063711911357, Proportion of 0s: 0.45429362880886426
Client 3 of 5: Local Epoch [1/3] Loss: 0.6223, Accuracy: 65.65 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 315, 0s: 46
True Labels - 1s: 197, 0s: 164
Predictions - Proportion of 1s: 0.8725761772853186, Proportion of 0s: 0.12742382271468145
True Labels - Proportion of 1s: 0.5457063711911357, Proportion of 0s: 0.45429362880886426
Client 3 of 5: Local Epoch [2/3] Loss: 0.6281, Accuracy: 61.22 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 326, 0s: 35
True Labels - 1s: 197, 0s: 164
Predictions - Proportion of 1s: 0.9030470914127424, Proportion of 0s: 0.09695290858725762
True Labels - Proportion of 1s: 0.5457063711911357, Proportion of 0s: 0.45429362880886426
Client 3 of 5: Local Epoch [3/3] Loss: 0.6299, Accuracy: 59.28 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 145, 0s: 216
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.40166204986149584, Proportion of 0s: 0.5983379501385041
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 4 of 5: Local Epoch [1/3] Loss: 0.6054, Accuracy: 73.41 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 190, 0s: 171
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.5263157894736842, Proportion of 0s: 0.47368421052631576
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 4 of 5: Local Epoch [2/3] Loss: 0.5950, Accuracy: 74.79 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 193, 0s: 168
True Labels - 1s: 189, 0s: 172
Predictions - Proportion of 1s: 0.5346260387811634, Proportion of 0s: 0.46537396121883656
True Labels - Proportion of 1s: 0.5235457063711911, Proportion of 0s: 0.47645429362880887
Client 4 of 5: Local Epoch [3/3] Loss: 0.5968, Accuracy: 70.64 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 144, 0s: 218
True Labels - 1s: 183, 0s: 179
Predictions - Proportion of 1s: 0.39779005524861877, Proportion of 0s: 0.6022099447513812
True Labels - Proportion of 1s: 0.505524861878453, Proportion of 0s: 0.494475138121547
Client 5 of 5: Local Epoch [1/3] Loss: 0.6495, Accuracy: 63.81 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 140, 0s: 222
True Labels - 1s: 183, 0s: 179
Predictions - Proportion of 1s: 0.3867403314917127, Proportion of 0s: 0.6132596685082873
True Labels - Proportion of 1s: 0.505524861878453, Proportion of 0s: 0.494475138121547
Client 5 of 5: Local Epoch [2/3] Loss: 0.6371, Accuracy: 63.81 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 153, 0s: 209
True Labels - 1s: 183, 0s: 179
Predictions - Proportion of 1s: 0.42265193370165743, Proportion of 0s: 0.5773480662983426
True Labels - Proportion of 1s: 0.505524861878453, Proportion of 0s: 0.494475138121547
Client 5 of 5: Local Epoch [3/3] Loss: 0.6324, Accuracy: 65.19 %, Epsilon: 0.99, Delta: 0.0030
-------------------------------
Round [4/4] Average Local Loss: 0.6089, Average Local Accuracy: 67.11 %
-------------------------------
-------- Validation --------
Predictions - 1s: 251, 0s: 201
True Labels - 1s: 242, 0s: 210
Predictions - Proportion of 1s: 0.5553097345132744, Proportion of 0s: 0.4446902654867257
True Labels - Proportion of 1s: 0.5353982300884956, Proportion of 0s: 0.4646017699115044
Round [4/4] Global Model Validation Loss: 0.5851, Validation Accuracy: 74.12 %
-------- Validation finished --------
Updated best model in round 4 saved with Validation Loss: 0.585111965647841 and Validation Accuracy: 74.12 %
-------------------------------
Best model in round 4 saved with Validation Loss: 0.585111965647841 and Validation Accuracy: 74.12 %

-------- Training finished in 21:29 --------

Test flag enabled. Testing the model

-------- Loading best model from model_path --------
Loaded model bert-small from date 15-03-2024 09:33. Trained with Federated Learning technology.
Round 4, lr: 0.0006, optimizer: AdamW
Average train accuracy: 67.11 %, Validation accuracy: 74.12 %
-------- Best model loaded --------

-------- Creating Test Dataloader --------
Test Loader: 564 total sentences. 71 batches of size 8.
-------- Test Dataloader created --------

-------- Testing --------
Predictions - 1s: 289, 0s: 275
True Labels - 1s: 296, 0s: 268
Predictions - Proportion of 1s: 0.5124113475177305, Proportion of 0s: 0.4875886524822695
True Labels - Proportion of 1s: 0.524822695035461, Proportion of 0s: 0.475177304964539
NÂº of test samples: 564
Accuracy: 73.58%
Accuracy 2 : 73.58%
Precision: 73.53%
Recall: 73.58%
F1 Score: 73.54%
Classification report:
              precision    recall  f1-score   support

           0     0.7164    0.7351    0.7256       268
           1     0.7543    0.7365    0.7453       296

    accuracy                         0.7358       564
   macro avg     0.7353    0.7358    0.7354       564
weighted avg     0.7363    0.7358    0.7359       564

-------- Testing finished --------
