Current configuration:
{
    "concurrency_flag": false,
    "data_distribution": "iid",
    "dataset": "mixed_depression",
    "device": "cuda",
    "dp_delta": 0.003,
    "dp_epsilon": 10,
    "eval_batch_size": 4,
    "eval_flag": true,
    "eval_size": 0.2,
    "fed_alg": "fedavg",
    "layers": 3,
    "learning_rate": 0.0006,
    "max_length": 512,
    "ml_mode": "fl",
    "model": "bert_small",
    "model_name": "fl_10_seed2_mixed_depression",
    "models_path": "/local/vpaloma/fabric-federated-learning/ablation_study/phase-2/1-ml_mode-dataset-dp/mixed_depression",
    "mu": 0.5,
    "num_clients": 5,
    "num_epochs": 3,
    "num_rounds": 4,
    "optimizer": "AdamW",
    "progress_bar_flag": false,
    "save_model": true,
    "scheduler": "linear",
    "scheduler_warmup_steps": 0,
    "seed": 221,
    "test_flag": true,
    "train_batch_size": 4,
    "train_size": 0.8
}
-------- Configuration loaded --------

-------- Setting device --------
cuda device selected and available.
-------- Device set --------

-------- Setting seed --------
-------- Seed set --------

-------- Creating Model --------
-------- Model created --------

-------- Setting Trainable Layers --------
Training the last 3 layers.

Total parameters count: 28764674
Trainable parameters count: 3416066
-------- Trainable Layers set --------

-------- Creating Tokenizer --------
-------- Tokenizer created --------

-------- Creating Train and Eval Dataloaders --------
Train Loader: 1806 total sentences. 452 batches of size 4.
Eval Loader: 452 total sentences. 113 batches of size 4.
-------- Train and Eval Dataloaders created --------

-------- Training --------
Training with Federated Learning technology.
Training with differential privacy.
Federated averaging algorithm selected.

Round 1 of 4
-------------------------------
Predictions - 1s: 322, 0s: 39
True Labels - 1s: 202, 0s: 159
Predictions - Proportion of 1s: 0.8919667590027701, Proportion of 0s: 0.10803324099722991
True Labels - Proportion of 1s: 0.5595567867036011, Proportion of 0s: 0.4404432132963989
Client 1 of 5: Local Epoch [1/3] Loss: 0.6999, Accuracy: 54.57 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 361, 0s: 0
True Labels - 1s: 202, 0s: 159
Predictions - Proportion of 1s: 1.0, Proportion of 0s: 0.0
True Labels - Proportion of 1s: 0.5595567867036011, Proportion of 0s: 0.4404432132963989
Client 1 of 5: Local Epoch [2/3] Loss: 0.7543, Accuracy: 55.96 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 361, 0s: 0
True Labels - 1s: 202, 0s: 159
Predictions - Proportion of 1s: 1.0, Proportion of 0s: 0.0
True Labels - Proportion of 1s: 0.5595567867036011, Proportion of 0s: 0.4404432132963989
Client 1 of 5: Local Epoch [3/3] Loss: 0.7691, Accuracy: 55.96 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 96, 0s: 265
True Labels - 1s: 191, 0s: 170
Predictions - Proportion of 1s: 0.2659279778393352, Proportion of 0s: 0.7340720221606648
True Labels - Proportion of 1s: 0.5290858725761773, Proportion of 0s: 0.4709141274238227
Client 2 of 5: Local Epoch [1/3] Loss: 0.6924, Accuracy: 54.29 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 277, 0s: 84
True Labels - 1s: 191, 0s: 170
Predictions - Proportion of 1s: 0.7673130193905817, Proportion of 0s: 0.23268698060941828
True Labels - Proportion of 1s: 0.5290858725761773, Proportion of 0s: 0.4709141274238227
Client 2 of 5: Local Epoch [2/3] Loss: 0.6571, Accuracy: 62.88 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 320, 0s: 41
True Labels - 1s: 191, 0s: 170
Predictions - Proportion of 1s: 0.8864265927977839, Proportion of 0s: 0.11357340720221606
True Labels - Proportion of 1s: 0.5290858725761773, Proportion of 0s: 0.4709141274238227
Client 2 of 5: Local Epoch [3/3] Loss: 0.6441, Accuracy: 59.83 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 194, 0s: 167
True Labels - 1s: 180, 0s: 181
Predictions - Proportion of 1s: 0.5373961218836565, Proportion of 0s: 0.4626038781163435
True Labels - Proportion of 1s: 0.4986149584487535, Proportion of 0s: 0.5013850415512465
Client 3 of 5: Local Epoch [1/3] Loss: 0.6840, Accuracy: 52.91 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 87, 0s: 274
True Labels - 1s: 180, 0s: 181
Predictions - Proportion of 1s: 0.2409972299168975, Proportion of 0s: 0.7590027700831025
True Labels - Proportion of 1s: 0.4986149584487535, Proportion of 0s: 0.5013850415512465
Client 3 of 5: Local Epoch [2/3] Loss: 0.6587, Accuracy: 60.39 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 85, 0s: 276
True Labels - 1s: 180, 0s: 181
Predictions - Proportion of 1s: 0.23545706371191136, Proportion of 0s: 0.7645429362880887
True Labels - Proportion of 1s: 0.4986149584487535, Proportion of 0s: 0.5013850415512465
Client 3 of 5: Local Epoch [3/3] Loss: 0.6516, Accuracy: 64.82 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 17, 0s: 344
True Labels - 1s: 178, 0s: 183
Predictions - Proportion of 1s: 0.04709141274238227, Proportion of 0s: 0.9529085872576177
True Labels - Proportion of 1s: 0.4930747922437673, Proportion of 0s: 0.5069252077562327
Client 4 of 5: Local Epoch [1/3] Loss: 0.7190, Accuracy: 49.31 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 18, 0s: 343
True Labels - 1s: 178, 0s: 183
Predictions - Proportion of 1s: 0.04986149584487535, Proportion of 0s: 0.9501385041551247
True Labels - Proportion of 1s: 0.4930747922437673, Proportion of 0s: 0.5069252077562327
Client 4 of 5: Local Epoch [2/3] Loss: 0.6754, Accuracy: 54.57 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 18, 0s: 343
True Labels - 1s: 178, 0s: 183
Predictions - Proportion of 1s: 0.04986149584487535, Proportion of 0s: 0.9501385041551247
True Labels - Proportion of 1s: 0.4930747922437673, Proportion of 0s: 0.5069252077562327
Client 4 of 5: Local Epoch [3/3] Loss: 0.6682, Accuracy: 54.57 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 131, 0s: 231
True Labels - 1s: 190, 0s: 172
Predictions - Proportion of 1s: 0.36187845303867405, Proportion of 0s: 0.638121546961326
True Labels - Proportion of 1s: 0.5248618784530387, Proportion of 0s: 0.47513812154696133
Client 5 of 5: Local Epoch [1/3] Loss: 0.6984, Accuracy: 48.90 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 299, 0s: 63
True Labels - 1s: 190, 0s: 172
Predictions - Proportion of 1s: 0.8259668508287292, Proportion of 0s: 0.17403314917127072
True Labels - Proportion of 1s: 0.5248618784530387, Proportion of 0s: 0.47513812154696133
Client 5 of 5: Local Epoch [2/3] Loss: 0.6641, Accuracy: 57.73 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 289, 0s: 73
True Labels - 1s: 190, 0s: 172
Predictions - Proportion of 1s: 0.7983425414364641, Proportion of 0s: 0.20165745856353592
True Labels - Proportion of 1s: 0.5248618784530387, Proportion of 0s: 0.47513812154696133
Client 5 of 5: Local Epoch [3/3] Loss: 0.6646, Accuracy: 59.94 %, Epsilon: 10.00, Delta: 0.0030
-------------------------------
Round [1/4] Average Local Loss: 0.6795, Average Local Accuracy: 59.02 %
-------------------------------
-------- Validation --------
Predictions - 1s: 386, 0s: 66
True Labels - 1s: 244, 0s: 208
Predictions - Proportion of 1s: 0.8539823008849557, Proportion of 0s: 0.14601769911504425
True Labels - Proportion of 1s: 0.5398230088495575, Proportion of 0s: 0.46017699115044247
Round [1/4] Global Model Validation Loss: 0.6407, Validation Accuracy: 64.60 %
-------- Validation finished --------
Updated best model in round 1 saved with Validation Loss: 0.6407234478840785 and Validation Accuracy: 64.60 %
-------------------------------

Round 2 of 4
-------------------------------
Predictions - 1s: 353, 0s: 8
True Labels - 1s: 202, 0s: 159
Predictions - Proportion of 1s: 0.9778393351800554, Proportion of 0s: 0.0221606648199446
True Labels - Proportion of 1s: 0.5595567867036011, Proportion of 0s: 0.4404432132963989
Client 1 of 5: Local Epoch [1/3] Loss: 0.6805, Accuracy: 55.96 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 361, 0s: 0
True Labels - 1s: 202, 0s: 159
Predictions - Proportion of 1s: 1.0, Proportion of 0s: 0.0
True Labels - Proportion of 1s: 0.5595567867036011, Proportion of 0s: 0.4404432132963989
Client 1 of 5: Local Epoch [2/3] Loss: 0.7412, Accuracy: 55.96 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 361, 0s: 0
True Labels - 1s: 202, 0s: 159
Predictions - Proportion of 1s: 1.0, Proportion of 0s: 0.0
True Labels - Proportion of 1s: 0.5595567867036011, Proportion of 0s: 0.4404432132963989
Client 1 of 5: Local Epoch [3/3] Loss: 0.8035, Accuracy: 55.96 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 317, 0s: 44
True Labels - 1s: 191, 0s: 170
Predictions - Proportion of 1s: 0.8781163434903048, Proportion of 0s: 0.12188365650969529
True Labels - Proportion of 1s: 0.5290858725761773, Proportion of 0s: 0.4709141274238227
Client 2 of 5: Local Epoch [1/3] Loss: 0.6360, Accuracy: 61.22 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 340, 0s: 21
True Labels - 1s: 191, 0s: 170
Predictions - Proportion of 1s: 0.9418282548476454, Proportion of 0s: 0.05817174515235457
True Labels - Proportion of 1s: 0.5290858725761773, Proportion of 0s: 0.4709141274238227
Client 2 of 5: Local Epoch [2/3] Loss: 0.6373, Accuracy: 57.62 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 330, 0s: 31
True Labels - 1s: 191, 0s: 170
Predictions - Proportion of 1s: 0.9141274238227147, Proportion of 0s: 0.08587257617728532
True Labels - Proportion of 1s: 0.5290858725761773, Proportion of 0s: 0.4709141274238227
Client 2 of 5: Local Epoch [3/3] Loss: 0.6226, Accuracy: 59.28 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 149, 0s: 212
True Labels - 1s: 180, 0s: 181
Predictions - Proportion of 1s: 0.41274238227146814, Proportion of 0s: 0.5872576177285319
True Labels - Proportion of 1s: 0.4986149584487535, Proportion of 0s: 0.5013850415512465
Client 3 of 5: Local Epoch [1/3] Loss: 0.6440, Accuracy: 64.82 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 54, 0s: 307
True Labels - 1s: 180, 0s: 181
Predictions - Proportion of 1s: 0.14958448753462603, Proportion of 0s: 0.850415512465374
True Labels - Proportion of 1s: 0.4986149584487535, Proportion of 0s: 0.5013850415512465
Client 3 of 5: Local Epoch [2/3] Loss: 0.6378, Accuracy: 61.77 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 51, 0s: 310
True Labels - 1s: 180, 0s: 181
Predictions - Proportion of 1s: 0.14127423822714683, Proportion of 0s: 0.8587257617728532
True Labels - Proportion of 1s: 0.4986149584487535, Proportion of 0s: 0.5013850415512465
Client 3 of 5: Local Epoch [3/3] Loss: 0.6363, Accuracy: 60.94 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 103, 0s: 258
True Labels - 1s: 178, 0s: 183
Predictions - Proportion of 1s: 0.2853185595567867, Proportion of 0s: 0.7146814404432132
True Labels - Proportion of 1s: 0.4930747922437673, Proportion of 0s: 0.5069252077562327
Client 4 of 5: Local Epoch [1/3] Loss: 0.6645, Accuracy: 62.05 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 68, 0s: 293
True Labels - 1s: 178, 0s: 183
Predictions - Proportion of 1s: 0.1883656509695291, Proportion of 0s: 0.8116343490304709
True Labels - Proportion of 1s: 0.4930747922437673, Proportion of 0s: 0.5069252077562327
Client 4 of 5: Local Epoch [2/3] Loss: 0.6323, Accuracy: 64.54 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 56, 0s: 305
True Labels - 1s: 178, 0s: 183
Predictions - Proportion of 1s: 0.15512465373961218, Proportion of 0s: 0.8448753462603878
True Labels - Proportion of 1s: 0.4930747922437673, Proportion of 0s: 0.5069252077562327
Client 4 of 5: Local Epoch [3/3] Loss: 0.6313, Accuracy: 61.77 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 241, 0s: 121
True Labels - 1s: 190, 0s: 172
Predictions - Proportion of 1s: 0.6657458563535912, Proportion of 0s: 0.3342541436464088
True Labels - Proportion of 1s: 0.5248618784530387, Proportion of 0s: 0.47513812154696133
Client 5 of 5: Local Epoch [1/3] Loss: 0.6388, Accuracy: 69.89 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 283, 0s: 79
True Labels - 1s: 190, 0s: 172
Predictions - Proportion of 1s: 0.7817679558011049, Proportion of 0s: 0.21823204419889503
True Labels - Proportion of 1s: 0.5248618784530387, Proportion of 0s: 0.47513812154696133
Client 5 of 5: Local Epoch [2/3] Loss: 0.6134, Accuracy: 68.23 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 310, 0s: 52
True Labels - 1s: 190, 0s: 172
Predictions - Proportion of 1s: 0.856353591160221, Proportion of 0s: 0.143646408839779
True Labels - Proportion of 1s: 0.5248618784530387, Proportion of 0s: 0.47513812154696133
Client 5 of 5: Local Epoch [3/3] Loss: 0.6167, Accuracy: 64.64 %, Epsilon: 10.00, Delta: 0.0030
-------------------------------
Round [2/4] Average Local Loss: 0.6621, Average Local Accuracy: 60.52 %
-------------------------------
-------- Validation --------
Predictions - 1s: 330, 0s: 122
True Labels - 1s: 244, 0s: 208
Predictions - Proportion of 1s: 0.7300884955752213, Proportion of 0s: 0.26991150442477874
True Labels - Proportion of 1s: 0.5398230088495575, Proportion of 0s: 0.46017699115044247
Round [2/4] Global Model Validation Loss: 0.5942, Validation Accuracy: 74.78 %
-------- Validation finished --------
Updated best model in round 2 saved with Validation Loss: 0.5942247710396759 and Validation Accuracy: 74.78 %
-------------------------------

Round 3 of 4
-------------------------------
Predictions - 1s: 332, 0s: 29
True Labels - 1s: 202, 0s: 159
Predictions - Proportion of 1s: 0.9196675900277008, Proportion of 0s: 0.08033240997229917
True Labels - Proportion of 1s: 0.5595567867036011, Proportion of 0s: 0.4404432132963989
Client 1 of 5: Local Epoch [1/3] Loss: 0.6309, Accuracy: 60.11 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 356, 0s: 5
True Labels - 1s: 202, 0s: 159
Predictions - Proportion of 1s: 0.9861495844875346, Proportion of 0s: 0.013850415512465374
True Labels - Proportion of 1s: 0.5595567867036011, Proportion of 0s: 0.4404432132963989
Client 1 of 5: Local Epoch [2/3] Loss: 0.6621, Accuracy: 56.79 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 361, 0s: 0
True Labels - 1s: 202, 0s: 159
Predictions - Proportion of 1s: 1.0, Proportion of 0s: 0.0
True Labels - Proportion of 1s: 0.5595567867036011, Proportion of 0s: 0.4404432132963989
Client 1 of 5: Local Epoch [3/3] Loss: 0.7303, Accuracy: 55.96 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 212, 0s: 149
True Labels - 1s: 191, 0s: 170
Predictions - Proportion of 1s: 0.5872576177285319, Proportion of 0s: 0.41274238227146814
True Labels - Proportion of 1s: 0.5290858725761773, Proportion of 0s: 0.4709141274238227
Client 2 of 5: Local Epoch [1/3] Loss: 0.5948, Accuracy: 73.13 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 301, 0s: 60
True Labels - 1s: 191, 0s: 170
Predictions - Proportion of 1s: 0.8337950138504155, Proportion of 0s: 0.16620498614958448
True Labels - Proportion of 1s: 0.5290858725761773, Proportion of 0s: 0.4709141274238227
Client 2 of 5: Local Epoch [2/3] Loss: 0.5882, Accuracy: 65.10 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 298, 0s: 63
True Labels - 1s: 191, 0s: 170
Predictions - Proportion of 1s: 0.8254847645429363, Proportion of 0s: 0.1745152354570637
True Labels - Proportion of 1s: 0.5290858725761773, Proportion of 0s: 0.4709141274238227
Client 2 of 5: Local Epoch [3/3] Loss: 0.5829, Accuracy: 66.48 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 236, 0s: 125
True Labels - 1s: 180, 0s: 181
Predictions - Proportion of 1s: 0.6537396121883656, Proportion of 0s: 0.3462603878116344
True Labels - Proportion of 1s: 0.4986149584487535, Proportion of 0s: 0.5013850415512465
Client 3 of 5: Local Epoch [1/3] Loss: 0.6116, Accuracy: 70.08 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 164, 0s: 197
True Labels - 1s: 180, 0s: 181
Predictions - Proportion of 1s: 0.45429362880886426, Proportion of 0s: 0.5457063711911357
True Labels - Proportion of 1s: 0.4986149584487535, Proportion of 0s: 0.5013850415512465
Client 3 of 5: Local Epoch [2/3] Loss: 0.5809, Accuracy: 72.30 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 172, 0s: 189
True Labels - 1s: 180, 0s: 181
Predictions - Proportion of 1s: 0.47645429362880887, Proportion of 0s: 0.5235457063711911
True Labels - Proportion of 1s: 0.4986149584487535, Proportion of 0s: 0.5013850415512465
Client 3 of 5: Local Epoch [3/3] Loss: 0.5653, Accuracy: 74.52 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 263, 0s: 98
True Labels - 1s: 178, 0s: 183
Predictions - Proportion of 1s: 0.7285318559556787, Proportion of 0s: 0.27146814404432135
True Labels - Proportion of 1s: 0.4930747922437673, Proportion of 0s: 0.5069252077562327
Client 4 of 5: Local Epoch [1/3] Loss: 0.6259, Accuracy: 63.71 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 191, 0s: 170
True Labels - 1s: 178, 0s: 183
Predictions - Proportion of 1s: 0.5290858725761773, Proportion of 0s: 0.4709141274238227
True Labels - Proportion of 1s: 0.4930747922437673, Proportion of 0s: 0.5069252077562327
Client 4 of 5: Local Epoch [2/3] Loss: 0.5836, Accuracy: 72.58 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 178, 0s: 183
True Labels - 1s: 178, 0s: 183
Predictions - Proportion of 1s: 0.4930747922437673, Proportion of 0s: 0.5069252077562327
True Labels - Proportion of 1s: 0.4930747922437673, Proportion of 0s: 0.5069252077562327
Client 4 of 5: Local Epoch [3/3] Loss: 0.5770, Accuracy: 75.62 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 321, 0s: 41
True Labels - 1s: 190, 0s: 172
Predictions - Proportion of 1s: 0.8867403314917127, Proportion of 0s: 0.1132596685082873
True Labels - Proportion of 1s: 0.5248618784530387, Proportion of 0s: 0.47513812154696133
Client 5 of 5: Local Epoch [1/3] Loss: 0.6194, Accuracy: 61.60 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 338, 0s: 24
True Labels - 1s: 190, 0s: 172
Predictions - Proportion of 1s: 0.9337016574585635, Proportion of 0s: 0.06629834254143646
True Labels - Proportion of 1s: 0.5248618784530387, Proportion of 0s: 0.47513812154696133
Client 5 of 5: Local Epoch [2/3] Loss: 0.6269, Accuracy: 57.46 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 345, 0s: 17
True Labels - 1s: 190, 0s: 172
Predictions - Proportion of 1s: 0.9530386740331491, Proportion of 0s: 0.04696132596685083
True Labels - Proportion of 1s: 0.5248618784530387, Proportion of 0s: 0.47513812154696133
Client 5 of 5: Local Epoch [3/3] Loss: 0.6319, Accuracy: 56.63 %, Epsilon: 10.00, Delta: 0.0030
-------------------------------
Round [3/4] Average Local Loss: 0.6175, Average Local Accuracy: 65.84 %
-------------------------------
-------- Validation --------
Predictions - 1s: 342, 0s: 110
True Labels - 1s: 244, 0s: 208
Predictions - Proportion of 1s: 0.7566371681415929, Proportion of 0s: 0.24336283185840707
True Labels - Proportion of 1s: 0.5398230088495575, Proportion of 0s: 0.46017699115044247
Round [3/4] Global Model Validation Loss: 0.5631, Validation Accuracy: 72.57 %
-------- Validation finished --------
Updated best model in round 3 saved with Validation Loss: 0.5631406647441661 and Validation Accuracy: 72.57 %
-------------------------------

Round 4 of 4
-------------------------------
Predictions - 1s: 351, 0s: 10
True Labels - 1s: 202, 0s: 159
Predictions - Proportion of 1s: 0.9722991689750693, Proportion of 0s: 0.027700831024930747
True Labels - Proportion of 1s: 0.5595567867036011, Proportion of 0s: 0.4404432132963989
Client 1 of 5: Local Epoch [1/3] Loss: 0.6494, Accuracy: 58.73 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 354, 0s: 7
True Labels - 1s: 202, 0s: 159
Predictions - Proportion of 1s: 0.9806094182825484, Proportion of 0s: 0.019390581717451522
True Labels - Proportion of 1s: 0.5595567867036011, Proportion of 0s: 0.4404432132963989
Client 1 of 5: Local Epoch [2/3] Loss: 0.7022, Accuracy: 57.89 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 359, 0s: 2
True Labels - 1s: 202, 0s: 159
Predictions - Proportion of 1s: 0.9944598337950139, Proportion of 0s: 0.00554016620498615
True Labels - Proportion of 1s: 0.5595567867036011, Proportion of 0s: 0.4404432132963989
Client 1 of 5: Local Epoch [3/3] Loss: 0.7668, Accuracy: 56.51 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 279, 0s: 82
True Labels - 1s: 191, 0s: 170
Predictions - Proportion of 1s: 0.7728531855955678, Proportion of 0s: 0.22714681440443213
True Labels - Proportion of 1s: 0.5290858725761773, Proportion of 0s: 0.4709141274238227
Client 2 of 5: Local Epoch [1/3] Loss: 0.5876, Accuracy: 66.76 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 322, 0s: 39
True Labels - 1s: 191, 0s: 170
Predictions - Proportion of 1s: 0.8919667590027701, Proportion of 0s: 0.10803324099722991
True Labels - Proportion of 1s: 0.5290858725761773, Proportion of 0s: 0.4709141274238227
Client 2 of 5: Local Epoch [2/3] Loss: 0.5994, Accuracy: 62.60 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 328, 0s: 33
True Labels - 1s: 191, 0s: 170
Predictions - Proportion of 1s: 0.9085872576177285, Proportion of 0s: 0.09141274238227147
True Labels - Proportion of 1s: 0.5290858725761773, Proportion of 0s: 0.4709141274238227
Client 2 of 5: Local Epoch [3/3] Loss: 0.6090, Accuracy: 59.28 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 337, 0s: 24
True Labels - 1s: 180, 0s: 181
Predictions - Proportion of 1s: 0.9335180055401662, Proportion of 0s: 0.0664819944598338
True Labels - Proportion of 1s: 0.4986149584487535, Proportion of 0s: 0.5013850415512465
Client 3 of 5: Local Epoch [1/3] Loss: 0.6557, Accuracy: 55.40 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 275, 0s: 86
True Labels - 1s: 180, 0s: 181
Predictions - Proportion of 1s: 0.7617728531855956, Proportion of 0s: 0.23822714681440443
True Labels - Proportion of 1s: 0.4986149584487535, Proportion of 0s: 0.5013850415512465
Client 3 of 5: Local Epoch [2/3] Loss: 0.5818, Accuracy: 67.04 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 278, 0s: 83
True Labels - 1s: 180, 0s: 181
Predictions - Proportion of 1s: 0.7700831024930748, Proportion of 0s: 0.2299168975069252
True Labels - Proportion of 1s: 0.4986149584487535, Proportion of 0s: 0.5013850415512465
Client 3 of 5: Local Epoch [3/3] Loss: 0.5818, Accuracy: 68.42 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 259, 0s: 102
True Labels - 1s: 178, 0s: 183
Predictions - Proportion of 1s: 0.7174515235457064, Proportion of 0s: 0.28254847645429365
True Labels - Proportion of 1s: 0.4930747922437673, Proportion of 0s: 0.5069252077562327
Client 4 of 5: Local Epoch [1/3] Loss: 0.5804, Accuracy: 69.81 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 206, 0s: 155
True Labels - 1s: 178, 0s: 183
Predictions - Proportion of 1s: 0.5706371191135734, Proportion of 0s: 0.4293628808864266
True Labels - Proportion of 1s: 0.4930747922437673, Proportion of 0s: 0.5069252077562327
Client 4 of 5: Local Epoch [2/3] Loss: 0.5380, Accuracy: 75.62 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 169, 0s: 192
True Labels - 1s: 178, 0s: 183
Predictions - Proportion of 1s: 0.46814404432132967, Proportion of 0s: 0.5318559556786704
True Labels - Proportion of 1s: 0.4930747922437673, Proportion of 0s: 0.5069252077562327
Client 4 of 5: Local Epoch [3/3] Loss: 0.5346, Accuracy: 75.90 %, Epsilon: 10.00, Delta: 0.0030
Predictions - 1s: 306, 0s: 56
True Labels - 1s: 190, 0s: 172
Predictions - Proportion of 1s: 0.8453038674033149, Proportion of 0s: 0.15469613259668508
True Labels - Proportion of 1s: 0.5248618784530387, Proportion of 0s: 0.47513812154696133
Client 5 of 5: Local Epoch [1/3] Loss: 0.5975, Accuracy: 65.19 %, Epsilon: 6.30, Delta: 0.0030
Predictions - 1s: 319, 0s: 43
True Labels - 1s: 190, 0s: 172
Predictions - Proportion of 1s: 0.8812154696132597, Proportion of 0s: 0.11878453038674033
True Labels - Proportion of 1s: 0.5248618784530387, Proportion of 0s: 0.47513812154696133
Client 5 of 5: Local Epoch [2/3] Loss: 0.6121, Accuracy: 62.71 %, Epsilon: 8.34, Delta: 0.0030
Predictions - 1s: 321, 0s: 41
True Labels - 1s: 190, 0s: 172
Predictions - Proportion of 1s: 0.8867403314917127, Proportion of 0s: 0.1132596685082873
True Labels - Proportion of 1s: 0.5248618784530387, Proportion of 0s: 0.47513812154696133
Client 5 of 5: Local Epoch [3/3] Loss: 0.6162, Accuracy: 62.71 %, Epsilon: 10.00, Delta: 0.0030
-------------------------------
Round [4/4] Average Local Loss: 0.6217, Average Local Accuracy: 64.56 %
-------------------------------
-------- Validation --------
Predictions - 1s: 350, 0s: 102
True Labels - 1s: 244, 0s: 208
Predictions - Proportion of 1s: 0.7743362831858407, Proportion of 0s: 0.22566371681415928
True Labels - Proportion of 1s: 0.5398230088495575, Proportion of 0s: 0.46017699115044247
Round [4/4] Global Model Validation Loss: 0.5472, Validation Accuracy: 71.68 %
-------- Validation finished --------
Updated best model in round 4 saved with Validation Loss: 0.5471612461636551 and Validation Accuracy: 71.68 %
-------------------------------
Best model in round 4 saved with Validation Loss: 0.5471612461636551 and Validation Accuracy: 71.68 %

-------- Training finished in 22:47 --------

Test flag enabled. Testing the model

-------- Loading best model from model_path --------
Loaded model bert-small from date 15-03-2024 09:33. Trained with Federated Learning technology.
Round 4, lr: 0.0006, optimizer: AdamW
Average train accuracy: 64.56 %, Validation accuracy: 71.68 %
-------- Best model loaded --------

-------- Creating Test Dataloader --------
Test Loader: 564 total sentences. 71 batches of size 8.
-------- Test Dataloader created --------

-------- Testing --------
Predictions - 1s: 426, 0s: 138
True Labels - 1s: 296, 0s: 268
Predictions - Proportion of 1s: 0.7553191489361702, Proportion of 0s: 0.24468085106382978
True Labels - Proportion of 1s: 0.524822695035461, Proportion of 0s: 0.475177304964539
Nº of test samples: 564
Accuracy: 73.76%
Accuracy 2 : 73.76%
Precision: 80.42%
Recall: 72.55%
F1 Score: 71.52%
Classification report:
              precision    recall  f1-score   support

           0     0.9348    0.4813    0.6355       268
           1     0.6737    0.9696    0.7950       296

    accuracy                         0.7376       564
   macro avg     0.8042    0.7255    0.7152       564
weighted avg     0.7978    0.7376    0.7192       564

-------- Testing finished --------
