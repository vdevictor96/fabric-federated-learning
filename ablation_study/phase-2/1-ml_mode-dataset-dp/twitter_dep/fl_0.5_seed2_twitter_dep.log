Current configuration:
{
    "concurrency_flag": false,
    "data_distribution": "iid",
    "dataset": "twitter_dep",
    "device": "cuda:1",
    "dp_delta": 0.003,
    "dp_epsilon": 0.5,
    "eval_batch_size": 4,
    "eval_flag": true,
    "eval_size": 0.2,
    "fed_alg": "fedavg",
    "layers": 3,
    "learning_rate": 0.06,
    "max_length": 512,
    "ml_mode": "fl",
    "model": "bert_small",
    "model_name": "fl_0.5_seed2_twitter_dep",
    "models_path": "/local/vpaloma/fabric-federated-learning/ablation_study/phase-2/1-ml_mode-dataset-dp/twitter_dep",
    "mu": 0.5,
    "num_clients": 5,
    "num_epochs": 3,
    "num_rounds": 4,
    "optimizer": "AdamW",
    "progress_bar_flag": false,
    "save_model": true,
    "scheduler": "linear",
    "scheduler_warmup_steps": 0,
    "seed": 221,
    "test_flag": true,
    "train_batch_size": 2,
    "train_size": 0.8
}
-------- Configuration loaded --------

-------- Setting device --------
cuda:1 device selected and available.
-------- Device set --------

-------- Setting seed --------
-------- Seed set --------

-------- Creating Model --------
-------- Model created --------

-------- Setting Trainable Layers --------
Training the last 3 layers.

Total parameters count: 28764674
Trainable parameters count: 3416066
-------- Trainable Layers set --------

-------- Creating Tokenizer --------
-------- Tokenizer created --------

-------- Creating Train and Eval Dataloaders --------
Train Loader: 1982 total sentences. 991 batches of size 2.
Eval Loader: 496 total sentences. 124 batches of size 4.
-------- Train and Eval Dataloaders created --------

-------- Training --------
Training with Federated Learning technology.
Training with differential privacy.
Federated averaging algorithm selected.

Round 1 of 4
-------------------------------
Predictions - 1s: 122, 0s: 274
True Labels - 1s: 97, 0s: 299
Predictions - Proportion of 1s: 0.30808080808080807, Proportion of 0s: 0.6919191919191919
True Labels - Proportion of 1s: 0.24494949494949494, Proportion of 0s: 0.7550505050505051
Client 1 of 5: Local Epoch [1/3] Loss: 5.1457, Accuracy: 57.32 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 95, 0s: 301
True Labels - 1s: 97, 0s: 299
Predictions - Proportion of 1s: 0.2398989898989899, Proportion of 0s: 0.76010101010101
True Labels - Proportion of 1s: 0.24494949494949494, Proportion of 0s: 0.7550505050505051
Client 1 of 5: Local Epoch [2/3] Loss: 5.3362, Accuracy: 65.15 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 124, 0s: 272
True Labels - 1s: 97, 0s: 299
Predictions - Proportion of 1s: 0.31313131313131315, Proportion of 0s: 0.6868686868686869
True Labels - Proportion of 1s: 0.24494949494949494, Proportion of 0s: 0.7550505050505051
Client 1 of 5: Local Epoch [3/3] Loss: 6.4236, Accuracy: 59.85 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 73, 0s: 323
True Labels - 1s: 124, 0s: 272
Predictions - Proportion of 1s: 0.18434343434343434, Proportion of 0s: 0.8156565656565656
True Labels - Proportion of 1s: 0.31313131313131315, Proportion of 0s: 0.6868686868686869
Client 2 of 5: Local Epoch [1/3] Loss: 5.0822, Accuracy: 63.38 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 103, 0s: 293
True Labels - 1s: 124, 0s: 272
Predictions - Proportion of 1s: 0.2601010101010101, Proportion of 0s: 0.73989898989899
True Labels - Proportion of 1s: 0.31313131313131315, Proportion of 0s: 0.6868686868686869
Client 2 of 5: Local Epoch [2/3] Loss: 5.1695, Accuracy: 60.86 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 99, 0s: 297
True Labels - 1s: 124, 0s: 272
Predictions - Proportion of 1s: 0.25, Proportion of 0s: 0.75
True Labels - Proportion of 1s: 0.31313131313131315, Proportion of 0s: 0.6868686868686869
Client 2 of 5: Local Epoch [3/3] Loss: 5.6317, Accuracy: 60.35 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 191, 0s: 205
True Labels - 1s: 118, 0s: 278
Predictions - Proportion of 1s: 0.4823232323232323, Proportion of 0s: 0.5176767676767676
True Labels - Proportion of 1s: 0.29797979797979796, Proportion of 0s: 0.702020202020202
Client 3 of 5: Local Epoch [1/3] Loss: 6.1620, Accuracy: 47.22 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 135, 0s: 261
True Labels - 1s: 118, 0s: 278
Predictions - Proportion of 1s: 0.3409090909090909, Proportion of 0s: 0.6590909090909091
True Labels - Proportion of 1s: 0.29797979797979796, Proportion of 0s: 0.702020202020202
Client 3 of 5: Local Epoch [2/3] Loss: 6.4589, Accuracy: 57.83 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 114, 0s: 282
True Labels - 1s: 118, 0s: 278
Predictions - Proportion of 1s: 0.2878787878787879, Proportion of 0s: 0.7121212121212122
True Labels - Proportion of 1s: 0.29797979797979796, Proportion of 0s: 0.702020202020202
Client 3 of 5: Local Epoch [3/3] Loss: 6.6882, Accuracy: 62.12 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 103, 0s: 293
True Labels - 1s: 110, 0s: 286
Predictions - Proportion of 1s: 0.2601010101010101, Proportion of 0s: 0.73989898989899
True Labels - Proportion of 1s: 0.2777777777777778, Proportion of 0s: 0.7222222222222222
Client 4 of 5: Local Epoch [1/3] Loss: 5.1401, Accuracy: 62.37 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 47, 0s: 349
True Labels - 1s: 110, 0s: 286
Predictions - Proportion of 1s: 0.11868686868686869, Proportion of 0s: 0.8813131313131313
True Labels - Proportion of 1s: 0.2777777777777778, Proportion of 0s: 0.7222222222222222
Client 4 of 5: Local Epoch [2/3] Loss: 7.7601, Accuracy: 63.89 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 118, 0s: 278
True Labels - 1s: 110, 0s: 286
Predictions - Proportion of 1s: 0.29797979797979796, Proportion of 0s: 0.702020202020202
True Labels - Proportion of 1s: 0.2777777777777778, Proportion of 0s: 0.7222222222222222
Client 4 of 5: Local Epoch [3/3] Loss: 6.2354, Accuracy: 59.60 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 75, 0s: 323
True Labels - 1s: 106, 0s: 292
Predictions - Proportion of 1s: 0.1884422110552764, Proportion of 0s: 0.8115577889447236
True Labels - Proportion of 1s: 0.2663316582914573, Proportion of 0s: 0.7336683417085427
Client 5 of 5: Local Epoch [1/3] Loss: 4.5191, Accuracy: 68.09 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 100, 0s: 298
True Labels - 1s: 106, 0s: 292
Predictions - Proportion of 1s: 0.25125628140703515, Proportion of 0s: 0.7487437185929648
True Labels - Proportion of 1s: 0.2663316582914573, Proportion of 0s: 0.7336683417085427
Client 5 of 5: Local Epoch [2/3] Loss: 5.2095, Accuracy: 61.31 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 36, 0s: 362
True Labels - 1s: 106, 0s: 292
Predictions - Proportion of 1s: 0.09045226130653267, Proportion of 0s: 0.9095477386934674
True Labels - Proportion of 1s: 0.2663316582914573, Proportion of 0s: 0.7336683417085427
Client 5 of 5: Local Epoch [3/3] Loss: 6.9133, Accuracy: 66.83 %, Epsilon: 0.49, Delta: 0.0030
-------------------------------
Round [1/4] Average Local Loss: 6.3785, Average Local Accuracy: 61.75 %
-------------------------------
-------- Validation --------
Predictions - 1s: 96, 0s: 400
True Labels - 1s: 119, 0s: 377
Predictions - Proportion of 1s: 0.1935483870967742, Proportion of 0s: 0.8064516129032258
True Labels - Proportion of 1s: 0.2399193548387097, Proportion of 0s: 0.7600806451612904
Round [1/4] Global Model Validation Loss: 2.2760, Validation Accuracy: 66.73 %
-------- Validation finished --------
Updated best model in round 1 saved with Validation Loss: 2.275963945651329 and Validation Accuracy: 66.73 %
-------------------------------

Round 2 of 4
-------------------------------
Predictions - 1s: 115, 0s: 281
True Labels - 1s: 97, 0s: 299
Predictions - Proportion of 1s: 0.2904040404040404, Proportion of 0s: 0.7095959595959596
True Labels - Proportion of 1s: 0.24494949494949494, Proportion of 0s: 0.7550505050505051
Client 1 of 5: Local Epoch [1/3] Loss: 5.5347, Accuracy: 61.62 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 71, 0s: 325
True Labels - 1s: 97, 0s: 299
Predictions - Proportion of 1s: 0.17929292929292928, Proportion of 0s: 0.8207070707070707
True Labels - Proportion of 1s: 0.24494949494949494, Proportion of 0s: 0.7550505050505051
Client 1 of 5: Local Epoch [2/3] Loss: 6.7792, Accuracy: 65.15 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 56, 0s: 340
True Labels - 1s: 97, 0s: 299
Predictions - Proportion of 1s: 0.1414141414141414, Proportion of 0s: 0.8585858585858586
True Labels - Proportion of 1s: 0.24494949494949494, Proportion of 0s: 0.7550505050505051
Client 1 of 5: Local Epoch [3/3] Loss: 6.7508, Accuracy: 67.42 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 166, 0s: 230
True Labels - 1s: 124, 0s: 272
Predictions - Proportion of 1s: 0.41919191919191917, Proportion of 0s: 0.5808080808080808
True Labels - Proportion of 1s: 0.31313131313131315, Proportion of 0s: 0.6868686868686869
Client 2 of 5: Local Epoch [1/3] Loss: 6.7173, Accuracy: 54.04 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 155, 0s: 241
True Labels - 1s: 124, 0s: 272
Predictions - Proportion of 1s: 0.39141414141414144, Proportion of 0s: 0.6085858585858586
True Labels - Proportion of 1s: 0.31313131313131315, Proportion of 0s: 0.6868686868686869
Client 2 of 5: Local Epoch [2/3] Loss: 8.2343, Accuracy: 54.80 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 97, 0s: 299
True Labels - 1s: 124, 0s: 272
Predictions - Proportion of 1s: 0.24494949494949494, Proportion of 0s: 0.7550505050505051
True Labels - Proportion of 1s: 0.31313131313131315, Proportion of 0s: 0.6868686868686869
Client 2 of 5: Local Epoch [3/3] Loss: 7.4193, Accuracy: 60.35 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 183, 0s: 213
True Labels - 1s: 118, 0s: 278
Predictions - Proportion of 1s: 0.4621212121212121, Proportion of 0s: 0.5378787878787878
True Labels - Proportion of 1s: 0.29797979797979796, Proportion of 0s: 0.702020202020202
Client 3 of 5: Local Epoch [1/3] Loss: 5.5895, Accuracy: 52.78 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 53, 0s: 343
True Labels - 1s: 118, 0s: 278
Predictions - Proportion of 1s: 0.13383838383838384, Proportion of 0s: 0.8661616161616161
True Labels - Proportion of 1s: 0.29797979797979796, Proportion of 0s: 0.702020202020202
Client 3 of 5: Local Epoch [2/3] Loss: 7.1736, Accuracy: 67.93 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 73, 0s: 323
True Labels - 1s: 118, 0s: 278
Predictions - Proportion of 1s: 0.18434343434343434, Proportion of 0s: 0.8156565656565656
True Labels - Proportion of 1s: 0.29797979797979796, Proportion of 0s: 0.702020202020202
Client 3 of 5: Local Epoch [3/3] Loss: 8.3708, Accuracy: 61.87 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 114, 0s: 282
True Labels - 1s: 110, 0s: 286
Predictions - Proportion of 1s: 0.2878787878787879, Proportion of 0s: 0.7121212121212122
True Labels - Proportion of 1s: 0.2777777777777778, Proportion of 0s: 0.7222222222222222
Client 4 of 5: Local Epoch [1/3] Loss: 6.2178, Accuracy: 57.07 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 48, 0s: 348
True Labels - 1s: 110, 0s: 286
Predictions - Proportion of 1s: 0.12121212121212122, Proportion of 0s: 0.8787878787878788
True Labels - Proportion of 1s: 0.2777777777777778, Proportion of 0s: 0.7222222222222222
Client 4 of 5: Local Epoch [2/3] Loss: 7.3591, Accuracy: 64.65 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 37, 0s: 359
True Labels - 1s: 110, 0s: 286
Predictions - Proportion of 1s: 0.09343434343434344, Proportion of 0s: 0.9065656565656566
True Labels - Proportion of 1s: 0.2777777777777778, Proportion of 0s: 0.7222222222222222
Client 4 of 5: Local Epoch [3/3] Loss: 8.1927, Accuracy: 65.91 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 83, 0s: 315
True Labels - 1s: 106, 0s: 292
Predictions - Proportion of 1s: 0.20854271356783918, Proportion of 0s: 0.7914572864321608
True Labels - Proportion of 1s: 0.2663316582914573, Proportion of 0s: 0.7336683417085427
Client 5 of 5: Local Epoch [1/3] Loss: 6.2388, Accuracy: 65.08 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 109, 0s: 289
True Labels - 1s: 106, 0s: 292
Predictions - Proportion of 1s: 0.27386934673366836, Proportion of 0s: 0.7261306532663316
True Labels - Proportion of 1s: 0.2663316582914573, Proportion of 0s: 0.7336683417085427
Client 5 of 5: Local Epoch [2/3] Loss: 6.4838, Accuracy: 59.55 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 79, 0s: 319
True Labels - 1s: 106, 0s: 292
Predictions - Proportion of 1s: 0.1984924623115578, Proportion of 0s: 0.8015075376884422
True Labels - Proportion of 1s: 0.2663316582914573, Proportion of 0s: 0.7336683417085427
Client 5 of 5: Local Epoch [3/3] Loss: 6.1828, Accuracy: 65.08 %, Epsilon: 0.49, Delta: 0.0030
-------------------------------
Round [2/4] Average Local Loss: 7.3833, Average Local Accuracy: 64.13 %
-------------------------------
-------- Validation --------
Predictions - 1s: 464, 0s: 32
True Labels - 1s: 119, 0s: 377
Predictions - Proportion of 1s: 0.9354838709677419, Proportion of 0s: 0.06451612903225806
True Labels - Proportion of 1s: 0.2399193548387097, Proportion of 0s: 0.7600806451612904
Round [2/4] Global Model Validation Loss: 13.0311, Validation Accuracy: 27.22 %
-------- Validation finished --------

Round 3 of 4
-------------------------------
Predictions - 1s: 133, 0s: 263
True Labels - 1s: 97, 0s: 299
Predictions - Proportion of 1s: 0.33585858585858586, Proportion of 0s: 0.6641414141414141
True Labels - Proportion of 1s: 0.24494949494949494, Proportion of 0s: 0.7550505050505051
Client 1 of 5: Local Epoch [1/3] Loss: 5.8321, Accuracy: 59.60 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 57, 0s: 339
True Labels - 1s: 97, 0s: 299
Predictions - Proportion of 1s: 0.14393939393939395, Proportion of 0s: 0.8560606060606061
True Labels - Proportion of 1s: 0.24494949494949494, Proportion of 0s: 0.7550505050505051
Client 1 of 5: Local Epoch [2/3] Loss: 6.7600, Accuracy: 68.18 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 100, 0s: 296
True Labels - 1s: 97, 0s: 299
Predictions - Proportion of 1s: 0.25252525252525254, Proportion of 0s: 0.7474747474747475
True Labels - Proportion of 1s: 0.24494949494949494, Proportion of 0s: 0.7550505050505051
Client 1 of 5: Local Epoch [3/3] Loss: 6.7307, Accuracy: 60.86 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 229, 0s: 167
True Labels - 1s: 124, 0s: 272
Predictions - Proportion of 1s: 0.5782828282828283, Proportion of 0s: 0.4217171717171717
True Labels - Proportion of 1s: 0.31313131313131315, Proportion of 0s: 0.6868686868686869
Client 2 of 5: Local Epoch [1/3] Loss: 7.3742, Accuracy: 46.21 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 187, 0s: 209
True Labels - 1s: 124, 0s: 272
Predictions - Proportion of 1s: 0.4722222222222222, Proportion of 0s: 0.5277777777777778
True Labels - Proportion of 1s: 0.31313131313131315, Proportion of 0s: 0.6868686868686869
Client 2 of 5: Local Epoch [2/3] Loss: 6.6977, Accuracy: 56.82 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 131, 0s: 265
True Labels - 1s: 124, 0s: 272
Predictions - Proportion of 1s: 0.33080808080808083, Proportion of 0s: 0.6691919191919192
True Labels - Proportion of 1s: 0.31313131313131315, Proportion of 0s: 0.6868686868686869
Client 2 of 5: Local Epoch [3/3] Loss: 6.6775, Accuracy: 54.80 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 62, 0s: 334
True Labels - 1s: 118, 0s: 278
Predictions - Proportion of 1s: 0.15656565656565657, Proportion of 0s: 0.8434343434343434
True Labels - Proportion of 1s: 0.29797979797979796, Proportion of 0s: 0.702020202020202
Client 3 of 5: Local Epoch [1/3] Loss: 7.0932, Accuracy: 66.67 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 74, 0s: 322
True Labels - 1s: 118, 0s: 278
Predictions - Proportion of 1s: 0.18686868686868688, Proportion of 0s: 0.8131313131313131
True Labels - Proportion of 1s: 0.29797979797979796, Proportion of 0s: 0.702020202020202
Client 3 of 5: Local Epoch [2/3] Loss: 7.2534, Accuracy: 60.10 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 38, 0s: 358
True Labels - 1s: 118, 0s: 278
Predictions - Proportion of 1s: 0.09595959595959595, Proportion of 0s: 0.9040404040404041
True Labels - Proportion of 1s: 0.29797979797979796, Proportion of 0s: 0.702020202020202
Client 3 of 5: Local Epoch [3/3] Loss: 8.1000, Accuracy: 67.17 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 67, 0s: 329
True Labels - 1s: 110, 0s: 286
Predictions - Proportion of 1s: 0.1691919191919192, Proportion of 0s: 0.8308080808080808
True Labels - Proportion of 1s: 0.2777777777777778, Proportion of 0s: 0.7222222222222222
Client 4 of 5: Local Epoch [1/3] Loss: 8.3533, Accuracy: 62.88 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 172, 0s: 224
True Labels - 1s: 110, 0s: 286
Predictions - Proportion of 1s: 0.43434343434343436, Proportion of 0s: 0.5656565656565656
True Labels - Proportion of 1s: 0.2777777777777778, Proportion of 0s: 0.7222222222222222
Client 4 of 5: Local Epoch [2/3] Loss: 8.7372, Accuracy: 48.99 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 181, 0s: 215
True Labels - 1s: 110, 0s: 286
Predictions - Proportion of 1s: 0.45707070707070707, Proportion of 0s: 0.5429292929292929
True Labels - Proportion of 1s: 0.2777777777777778, Proportion of 0s: 0.7222222222222222
Client 4 of 5: Local Epoch [3/3] Loss: 7.9905, Accuracy: 47.22 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 107, 0s: 291
True Labels - 1s: 106, 0s: 292
Predictions - Proportion of 1s: 0.26884422110552764, Proportion of 0s: 0.7311557788944724
True Labels - Proportion of 1s: 0.2663316582914573, Proportion of 0s: 0.7336683417085427
Client 5 of 5: Local Epoch [1/3] Loss: 6.8181, Accuracy: 55.53 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 52, 0s: 346
True Labels - 1s: 106, 0s: 292
Predictions - Proportion of 1s: 0.1306532663316583, Proportion of 0s: 0.8693467336683417
True Labels - Proportion of 1s: 0.2663316582914573, Proportion of 0s: 0.7336683417085427
Client 5 of 5: Local Epoch [2/3] Loss: 7.3314, Accuracy: 66.83 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 85, 0s: 313
True Labels - 1s: 106, 0s: 292
Predictions - Proportion of 1s: 0.2135678391959799, Proportion of 0s: 0.7864321608040201
True Labels - Proportion of 1s: 0.2663316582914573, Proportion of 0s: 0.7336683417085427
Client 5 of 5: Local Epoch [3/3] Loss: 7.1239, Accuracy: 64.07 %, Epsilon: 0.49, Delta: 0.0030
-------------------------------
Round [3/4] Average Local Loss: 7.3245, Average Local Accuracy: 58.82 %
-------------------------------
-------- Validation --------
Predictions - 1s: 343, 0s: 153
True Labels - 1s: 119, 0s: 377
Predictions - Proportion of 1s: 0.6915322580645161, Proportion of 0s: 0.3084677419354839
True Labels - Proportion of 1s: 0.2399193548387097, Proportion of 0s: 0.7600806451612904
Round [3/4] Global Model Validation Loss: 5.1186, Validation Accuracy: 42.74 %
-------- Validation finished --------

Round 4 of 4
-------------------------------
Predictions - 1s: 90, 0s: 306
True Labels - 1s: 97, 0s: 299
Predictions - Proportion of 1s: 0.22727272727272727, Proportion of 0s: 0.7727272727272727
True Labels - Proportion of 1s: 0.24494949494949494, Proportion of 0s: 0.7550505050505051
Client 1 of 5: Local Epoch [1/3] Loss: 5.2493, Accuracy: 65.40 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 53, 0s: 343
True Labels - 1s: 97, 0s: 299
Predictions - Proportion of 1s: 0.13383838383838384, Proportion of 0s: 0.8661616161616161
True Labels - Proportion of 1s: 0.24494949494949494, Proportion of 0s: 0.7550505050505051
Client 1 of 5: Local Epoch [2/3] Loss: 8.5358, Accuracy: 69.19 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 72, 0s: 324
True Labels - 1s: 97, 0s: 299
Predictions - Proportion of 1s: 0.18181818181818182, Proportion of 0s: 0.8181818181818182
True Labels - Proportion of 1s: 0.24494949494949494, Proportion of 0s: 0.7550505050505051
Client 1 of 5: Local Epoch [3/3] Loss: 6.8741, Accuracy: 65.40 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 134, 0s: 262
True Labels - 1s: 124, 0s: 272
Predictions - Proportion of 1s: 0.3383838383838384, Proportion of 0s: 0.6616161616161617
True Labels - Proportion of 1s: 0.31313131313131315, Proportion of 0s: 0.6868686868686869
Client 2 of 5: Local Epoch [1/3] Loss: 6.6901, Accuracy: 58.59 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 28, 0s: 368
True Labels - 1s: 124, 0s: 272
Predictions - Proportion of 1s: 0.0707070707070707, Proportion of 0s: 0.9292929292929293
True Labels - Proportion of 1s: 0.31313131313131315, Proportion of 0s: 0.6868686868686869
Client 2 of 5: Local Epoch [2/3] Loss: 8.6844, Accuracy: 65.66 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 61, 0s: 335
True Labels - 1s: 124, 0s: 272
Predictions - Proportion of 1s: 0.15404040404040403, Proportion of 0s: 0.8459595959595959
True Labels - Proportion of 1s: 0.31313131313131315, Proportion of 0s: 0.6868686868686869
Client 2 of 5: Local Epoch [3/3] Loss: 7.4752, Accuracy: 64.90 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 163, 0s: 233
True Labels - 1s: 118, 0s: 278
Predictions - Proportion of 1s: 0.4116161616161616, Proportion of 0s: 0.5883838383838383
True Labels - Proportion of 1s: 0.29797979797979796, Proportion of 0s: 0.702020202020202
Client 3 of 5: Local Epoch [1/3] Loss: 6.3774, Accuracy: 53.79 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 93, 0s: 303
True Labels - 1s: 118, 0s: 278
Predictions - Proportion of 1s: 0.23484848484848486, Proportion of 0s: 0.7651515151515151
True Labels - Proportion of 1s: 0.29797979797979796, Proportion of 0s: 0.702020202020202
Client 3 of 5: Local Epoch [2/3] Loss: 7.6917, Accuracy: 60.86 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 125, 0s: 271
True Labels - 1s: 118, 0s: 278
Predictions - Proportion of 1s: 0.31565656565656564, Proportion of 0s: 0.6843434343434344
True Labels - Proportion of 1s: 0.29797979797979796, Proportion of 0s: 0.702020202020202
Client 3 of 5: Local Epoch [3/3] Loss: 7.4322, Accuracy: 60.35 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 154, 0s: 242
True Labels - 1s: 110, 0s: 286
Predictions - Proportion of 1s: 0.3888888888888889, Proportion of 0s: 0.6111111111111112
True Labels - Proportion of 1s: 0.2777777777777778, Proportion of 0s: 0.7222222222222222
Client 4 of 5: Local Epoch [1/3] Loss: 6.2101, Accuracy: 55.05 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 143, 0s: 253
True Labels - 1s: 110, 0s: 286
Predictions - Proportion of 1s: 0.3611111111111111, Proportion of 0s: 0.6388888888888888
True Labels - Proportion of 1s: 0.2777777777777778, Proportion of 0s: 0.7222222222222222
Client 4 of 5: Local Epoch [2/3] Loss: 7.3285, Accuracy: 56.31 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 84, 0s: 312
True Labels - 1s: 110, 0s: 286
Predictions - Proportion of 1s: 0.21212121212121213, Proportion of 0s: 0.7878787878787878
True Labels - Proportion of 1s: 0.2777777777777778, Proportion of 0s: 0.7222222222222222
Client 4 of 5: Local Epoch [3/3] Loss: 6.9818, Accuracy: 64.65 %, Epsilon: 0.49, Delta: 0.0030
Predictions - 1s: 124, 0s: 274
True Labels - 1s: 106, 0s: 292
Predictions - Proportion of 1s: 0.31155778894472363, Proportion of 0s: 0.6884422110552764
True Labels - Proportion of 1s: 0.2663316582914573, Proportion of 0s: 0.7336683417085427
Client 5 of 5: Local Epoch [1/3] Loss: 7.5352, Accuracy: 57.79 %, Epsilon: 0.27, Delta: 0.0030
Predictions - 1s: 129, 0s: 269
True Labels - 1s: 106, 0s: 292
Predictions - Proportion of 1s: 0.3241206030150754, Proportion of 0s: 0.6758793969849246
True Labels - Proportion of 1s: 0.2663316582914573, Proportion of 0s: 0.7336683417085427
Client 5 of 5: Local Epoch [2/3] Loss: 8.1583, Accuracy: 56.53 %, Epsilon: 0.39, Delta: 0.0030
Predictions - 1s: 102, 0s: 296
True Labels - 1s: 106, 0s: 292
Predictions - Proportion of 1s: 0.2562814070351759, Proportion of 0s: 0.7437185929648241
True Labels - Proportion of 1s: 0.2663316582914573, Proportion of 0s: 0.7336683417085427
Client 5 of 5: Local Epoch [3/3] Loss: 6.5378, Accuracy: 60.80 %, Epsilon: 0.49, Delta: 0.0030
-------------------------------
Round [4/4] Average Local Loss: 7.0602, Average Local Accuracy: 63.22 %
-------------------------------
-------- Validation --------
Predictions - 1s: 231, 0s: 265
True Labels - 1s: 119, 0s: 377
Predictions - Proportion of 1s: 0.4657258064516129, Proportion of 0s: 0.5342741935483871
True Labels - Proportion of 1s: 0.2399193548387097, Proportion of 0s: 0.7600806451612904
Round [4/4] Global Model Validation Loss: 3.7971, Validation Accuracy: 56.05 %
-------- Validation finished --------
Best model in round 1 saved with Validation Loss: 2.275963945651329 and Validation Accuracy: 66.73 %

-------- Training finished in 14:50 --------

Test flag enabled. Testing the model

-------- Loading best model from model_path --------
Loaded model bert-small from date 15-03-2024 10:08. Trained with Federated Learning technology.
Round 1, lr: 0.06, optimizer: AdamW
Average train accuracy: 61.75 %, Validation accuracy: 66.73 %
-------- Best model loaded --------

-------- Creating Test Dataloader --------
Test Loader: 618 total sentences. 78 batches of size 8.
-------- Test Dataloader created --------

-------- Testing --------
Predictions - 1s: 133, 0s: 485
True Labels - 1s: 168, 0s: 450
Predictions - Proportion of 1s: 0.215210355987055, Proportion of 0s: 0.7847896440129449
True Labels - Proportion of 1s: 0.27184466019417475, Proportion of 0s: 0.7281553398058253
NÂº of test samples: 618
Accuracy: 61.97%
Accuracy 2 : 61.97%
Precision: 48.49%
Recall: 48.71%
F1 Score: 48.40%
Classification report:
              precision    recall  f1-score   support

           0     0.7216    0.7778    0.7487       450
           1     0.2481    0.1964    0.2193       168

    accuracy                         0.6197       618
   macro avg     0.4849    0.4871    0.4840       618
weighted avg     0.5929    0.6197    0.6048       618

-------- Testing finished --------
