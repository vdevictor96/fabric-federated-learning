Current configuration:
{
    "concurrency_flag": false,
    "data_distribution": "iid",
    "dataset": "dreaddit",
    "device": "cuda",
    "dp_delta": 0.003,
    "dp_epsilon": 1,
    "eval_batch_size": 4,
    "eval_flag": true,
    "eval_size": 0.2,
    "fed_alg": "fedavg",
    "layers": 3,
    "learning_rate": 0.0006,
    "max_length": 512,
    "ml_mode": "fl",
    "model": "bert_small",
    "model_name": "fl_1_dreaddit",
    "models_path": "/local/vpaloma/fabric-federated-learning/ablation_study/phase-2/1-ml_mode-dataset-dp/dreaddit",
    "mu": 0.5,
    "num_clients": 5,
    "num_epochs": 3,
    "num_rounds": 4,
    "optimizer": "AdamW",
    "progress_bar_flag": false,
    "save_model": true,
    "scheduler": "linear",
    "scheduler_warmup_steps": 0,
    "seed": 0,
    "test_flag": true,
    "train_batch_size": 4,
    "train_size": 0.8
}
-------- Configuration loaded --------

-------- Setting device --------
cuda device selected and available.
-------- Device set --------

-------- Setting seed --------
-------- Seed set --------

-------- Creating Model --------
-------- Model created --------

-------- Setting Trainable Layers --------
Training the last 3 layers.

Total parameters count: 28764674
Trainable parameters count: 3416066
-------- Trainable Layers set --------

-------- Creating Tokenizer --------
-------- Tokenizer created --------

-------- Creating Train and Eval Dataloaders --------
Train Loader: 2270 total sentences. 568 batches of size 4.
Eval Loader: 568 total sentences. 142 batches of size 4.
-------- Train and Eval Dataloaders created --------

-------- Training --------
Training with Federated Learning technology.
Training with differential privacy.
Federated averaging algorithm selected.

Round 1 of 4
-------------------------------
Predictions - 1s: 49, 0s: 405
True Labels - 1s: 241, 0s: 213
Predictions - Proportion of 1s: 0.10792951541850221, Proportion of 0s: 0.8920704845814978
True Labels - Proportion of 1s: 0.5308370044052864, Proportion of 0s: 0.46916299559471364
Client 1 of 5: Local Epoch [1/3] Loss: 0.7395, Accuracy: 46.26 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 238, 0s: 216
True Labels - 1s: 241, 0s: 213
Predictions - Proportion of 1s: 0.5242290748898678, Proportion of 0s: 0.47577092511013214
True Labels - Proportion of 1s: 0.5308370044052864, Proportion of 0s: 0.46916299559471364
Client 1 of 5: Local Epoch [2/3] Loss: 0.6940, Accuracy: 53.08 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 326, 0s: 128
True Labels - 1s: 241, 0s: 213
Predictions - Proportion of 1s: 0.7180616740088106, Proportion of 0s: 0.28193832599118945
True Labels - Proportion of 1s: 0.5308370044052864, Proportion of 0s: 0.46916299559471364
Client 1 of 5: Local Epoch [3/3] Loss: 0.6910, Accuracy: 51.32 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 25, 0s: 429
True Labels - 1s: 218, 0s: 236
Predictions - Proportion of 1s: 0.05506607929515418, Proportion of 0s: 0.9449339207048458
True Labels - Proportion of 1s: 0.4801762114537445, Proportion of 0s: 0.5198237885462555
Client 2 of 5: Local Epoch [1/3] Loss: 0.7200, Accuracy: 50.00 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 31, 0s: 423
True Labels - 1s: 218, 0s: 236
Predictions - Proportion of 1s: 0.06828193832599119, Proportion of 0s: 0.9317180616740088
True Labels - Proportion of 1s: 0.4801762114537445, Proportion of 0s: 0.5198237885462555
Client 2 of 5: Local Epoch [2/3] Loss: 0.6959, Accuracy: 52.20 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 23, 0s: 431
True Labels - 1s: 218, 0s: 236
Predictions - Proportion of 1s: 0.05066079295154185, Proportion of 0s: 0.9493392070484582
True Labels - Proportion of 1s: 0.4801762114537445, Proportion of 0s: 0.5198237885462555
Client 2 of 5: Local Epoch [3/3] Loss: 0.6918, Accuracy: 53.52 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 85, 0s: 369
True Labels - 1s: 223, 0s: 231
Predictions - Proportion of 1s: 0.18722466960352424, Proportion of 0s: 0.8127753303964758
True Labels - Proportion of 1s: 0.4911894273127753, Proportion of 0s: 0.5088105726872246
Client 3 of 5: Local Epoch [1/3] Loss: 0.7117, Accuracy: 49.78 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 105, 0s: 349
True Labels - 1s: 223, 0s: 231
Predictions - Proportion of 1s: 0.23127753303964757, Proportion of 0s: 0.7687224669603524
True Labels - Proportion of 1s: 0.4911894273127753, Proportion of 0s: 0.5088105726872246
Client 3 of 5: Local Epoch [2/3] Loss: 0.6909, Accuracy: 53.30 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 115, 0s: 339
True Labels - 1s: 223, 0s: 231
Predictions - Proportion of 1s: 0.2533039647577093, Proportion of 0s: 0.7466960352422908
True Labels - Proportion of 1s: 0.4911894273127753, Proportion of 0s: 0.5088105726872246
Client 3 of 5: Local Epoch [3/3] Loss: 0.6770, Accuracy: 58.59 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 126, 0s: 328
True Labels - 1s: 244, 0s: 210
Predictions - Proportion of 1s: 0.2775330396475771, Proportion of 0s: 0.7224669603524229
True Labels - Proportion of 1s: 0.5374449339207048, Proportion of 0s: 0.46255506607929514
Client 4 of 5: Local Epoch [1/3] Loss: 0.7131, Accuracy: 47.14 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 319, 0s: 135
True Labels - 1s: 244, 0s: 210
Predictions - Proportion of 1s: 0.7026431718061674, Proportion of 0s: 0.2973568281938326
True Labels - Proportion of 1s: 0.5374449339207048, Proportion of 0s: 0.46255506607929514
Client 4 of 5: Local Epoch [2/3] Loss: 0.6786, Accuracy: 56.17 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 403, 0s: 51
True Labels - 1s: 244, 0s: 210
Predictions - Proportion of 1s: 0.8876651982378855, Proportion of 0s: 0.11233480176211454
True Labels - Proportion of 1s: 0.5374449339207048, Proportion of 0s: 0.46255506607929514
Client 4 of 5: Local Epoch [3/3] Loss: 0.6790, Accuracy: 57.93 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 29, 0s: 425
True Labels - 1s: 234, 0s: 220
Predictions - Proportion of 1s: 0.06387665198237885, Proportion of 0s: 0.9361233480176211
True Labels - Proportion of 1s: 0.5154185022026432, Proportion of 0s: 0.4845814977973568
Client 5 of 5: Local Epoch [1/3] Loss: 0.7350, Accuracy: 46.04 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 101, 0s: 353
True Labels - 1s: 234, 0s: 220
Predictions - Proportion of 1s: 0.22246696035242292, Proportion of 0s: 0.7775330396475771
True Labels - Proportion of 1s: 0.5154185022026432, Proportion of 0s: 0.4845814977973568
Client 5 of 5: Local Epoch [2/3] Loss: 0.6981, Accuracy: 51.76 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 123, 0s: 331
True Labels - 1s: 234, 0s: 220
Predictions - Proportion of 1s: 0.2709251101321586, Proportion of 0s: 0.7290748898678414
True Labels - Proportion of 1s: 0.5154185022026432, Proportion of 0s: 0.4845814977973568
Client 5 of 5: Local Epoch [3/3] Loss: 0.6802, Accuracy: 53.52 %, Epsilon: 0.99, Delta: 0.0030
-------------------------------
Round [1/4] Average Local Loss: 0.6838, Average Local Accuracy: 54.98 %
-------------------------------
-------- Validation --------
Predictions - 1s: 291, 0s: 277
True Labels - 1s: 328, 0s: 240
Predictions - Proportion of 1s: 0.5123239436619719, Proportion of 0s: 0.4876760563380282
True Labels - Proportion of 1s: 0.5774647887323944, Proportion of 0s: 0.4225352112676056
Round [1/4] Global Model Validation Loss: 0.6794, Validation Accuracy: 57.92 %
-------- Validation finished --------
Updated best model in round 1 saved with Validation Loss: 0.6794234598186654 and Validation Accuracy: 57.92 %
-------------------------------

Round 2 of 4
-------------------------------
Predictions - 1s: 362, 0s: 92
True Labels - 1s: 241, 0s: 213
Predictions - Proportion of 1s: 0.7973568281938326, Proportion of 0s: 0.2026431718061674
True Labels - Proportion of 1s: 0.5308370044052864, Proportion of 0s: 0.46916299559471364
Client 1 of 5: Local Epoch [1/3] Loss: 0.6880, Accuracy: 54.41 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 440, 0s: 14
True Labels - 1s: 241, 0s: 213
Predictions - Proportion of 1s: 0.9691629955947136, Proportion of 0s: 0.030837004405286344
True Labels - Proportion of 1s: 0.5308370044052864, Proportion of 0s: 0.46916299559471364
Client 1 of 5: Local Epoch [2/3] Loss: 0.6749, Accuracy: 55.73 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 444, 0s: 10
True Labels - 1s: 241, 0s: 213
Predictions - Proportion of 1s: 0.9779735682819384, Proportion of 0s: 0.022026431718061675
True Labels - Proportion of 1s: 0.5308370044052864, Proportion of 0s: 0.46916299559471364
Client 1 of 5: Local Epoch [3/3] Loss: 0.6850, Accuracy: 54.85 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 73, 0s: 381
True Labels - 1s: 218, 0s: 236
Predictions - Proportion of 1s: 0.16079295154185022, Proportion of 0s: 0.8392070484581498
True Labels - Proportion of 1s: 0.4801762114537445, Proportion of 0s: 0.5198237885462555
Client 2 of 5: Local Epoch [1/3] Loss: 0.6819, Accuracy: 54.85 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 85, 0s: 369
True Labels - 1s: 218, 0s: 236
Predictions - Proportion of 1s: 0.18722466960352424, Proportion of 0s: 0.8127753303964758
True Labels - Proportion of 1s: 0.4801762114537445, Proportion of 0s: 0.5198237885462555
Client 2 of 5: Local Epoch [2/3] Loss: 0.6648, Accuracy: 56.61 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 111, 0s: 343
True Labels - 1s: 218, 0s: 236
Predictions - Proportion of 1s: 0.2444933920704846, Proportion of 0s: 0.7555066079295154
True Labels - Proportion of 1s: 0.4801762114537445, Proportion of 0s: 0.5198237885462555
Client 2 of 5: Local Epoch [3/3] Loss: 0.6560, Accuracy: 60.57 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 236, 0s: 218
True Labels - 1s: 223, 0s: 231
Predictions - Proportion of 1s: 0.5198237885462555, Proportion of 0s: 0.4801762114537445
True Labels - Proportion of 1s: 0.4911894273127753, Proportion of 0s: 0.5088105726872246
Client 3 of 5: Local Epoch [1/3] Loss: 0.6710, Accuracy: 58.81 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 271, 0s: 183
True Labels - 1s: 223, 0s: 231
Predictions - Proportion of 1s: 0.5969162995594713, Proportion of 0s: 0.40308370044052866
True Labels - Proportion of 1s: 0.4911894273127753, Proportion of 0s: 0.5088105726872246
Client 3 of 5: Local Epoch [2/3] Loss: 0.6749, Accuracy: 55.51 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 325, 0s: 129
True Labels - 1s: 223, 0s: 231
Predictions - Proportion of 1s: 0.7158590308370044, Proportion of 0s: 0.2841409691629956
True Labels - Proportion of 1s: 0.4911894273127753, Proportion of 0s: 0.5088105726872246
Client 3 of 5: Local Epoch [3/3] Loss: 0.6643, Accuracy: 60.35 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 305, 0s: 149
True Labels - 1s: 244, 0s: 210
Predictions - Proportion of 1s: 0.6718061674008811, Proportion of 0s: 0.32819383259911894
True Labels - Proportion of 1s: 0.5374449339207048, Proportion of 0s: 0.46255506607929514
Client 4 of 5: Local Epoch [1/3] Loss: 0.6715, Accuracy: 57.93 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 388, 0s: 66
True Labels - 1s: 244, 0s: 210
Predictions - Proportion of 1s: 0.8546255506607929, Proportion of 0s: 0.14537444933920704
True Labels - Proportion of 1s: 0.5374449339207048, Proportion of 0s: 0.46255506607929514
Client 4 of 5: Local Epoch [2/3] Loss: 0.6688, Accuracy: 59.03 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 429, 0s: 25
True Labels - 1s: 244, 0s: 210
Predictions - Proportion of 1s: 0.9449339207048458, Proportion of 0s: 0.05506607929515418
True Labels - Proportion of 1s: 0.5374449339207048, Proportion of 0s: 0.46255506607929514
Client 4 of 5: Local Epoch [3/3] Loss: 0.6724, Accuracy: 57.49 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 288, 0s: 166
True Labels - 1s: 234, 0s: 220
Predictions - Proportion of 1s: 0.6343612334801763, Proportion of 0s: 0.3656387665198238
True Labels - Proportion of 1s: 0.5154185022026432, Proportion of 0s: 0.4845814977973568
Client 5 of 5: Local Epoch [1/3] Loss: 0.6826, Accuracy: 58.59 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 368, 0s: 86
True Labels - 1s: 234, 0s: 220
Predictions - Proportion of 1s: 0.8105726872246696, Proportion of 0s: 0.1894273127753304
True Labels - Proportion of 1s: 0.5154185022026432, Proportion of 0s: 0.4845814977973568
Client 5 of 5: Local Epoch [2/3] Loss: 0.6593, Accuracy: 62.11 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 399, 0s: 55
True Labels - 1s: 234, 0s: 220
Predictions - Proportion of 1s: 0.8788546255506607, Proportion of 0s: 0.1211453744493392
True Labels - Proportion of 1s: 0.5154185022026432, Proportion of 0s: 0.4845814977973568
Client 5 of 5: Local Epoch [3/3] Loss: 0.6680, Accuracy: 57.49 %, Epsilon: 0.99, Delta: 0.0030
-------------------------------
Round [2/4] Average Local Loss: 0.6692, Average Local Accuracy: 58.15 %
-------------------------------
-------- Validation --------
Predictions - 1s: 529, 0s: 39
True Labels - 1s: 328, 0s: 240
Predictions - Proportion of 1s: 0.9313380281690141, Proportion of 0s: 0.06866197183098592
True Labels - Proportion of 1s: 0.5774647887323944, Proportion of 0s: 0.4225352112676056
Round [2/4] Global Model Validation Loss: 0.6444, Validation Accuracy: 62.50 %
-------- Validation finished --------
Updated best model in round 2 saved with Validation Loss: 0.6443895563273363 and Validation Accuracy: 62.50 %
-------------------------------

Round 3 of 4
-------------------------------
Predictions - 1s: 427, 0s: 27
True Labels - 1s: 241, 0s: 213
Predictions - Proportion of 1s: 0.9405286343612335, Proportion of 0s: 0.05947136563876652
True Labels - Proportion of 1s: 0.5308370044052864, Proportion of 0s: 0.46916299559471364
Client 1 of 5: Local Epoch [1/3] Loss: 0.6771, Accuracy: 56.83 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 450, 0s: 4
True Labels - 1s: 241, 0s: 213
Predictions - Proportion of 1s: 0.9911894273127754, Proportion of 0s: 0.00881057268722467
True Labels - Proportion of 1s: 0.5308370044052864, Proportion of 0s: 0.46916299559471364
Client 1 of 5: Local Epoch [2/3] Loss: 0.7366, Accuracy: 53.96 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 452, 0s: 2
True Labels - 1s: 241, 0s: 213
Predictions - Proportion of 1s: 0.9955947136563876, Proportion of 0s: 0.004405286343612335
True Labels - Proportion of 1s: 0.5308370044052864, Proportion of 0s: 0.46916299559471364
Client 1 of 5: Local Epoch [3/3] Loss: 0.7631, Accuracy: 53.52 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 337, 0s: 117
True Labels - 1s: 218, 0s: 236
Predictions - Proportion of 1s: 0.7422907488986784, Proportion of 0s: 0.2577092511013216
True Labels - Proportion of 1s: 0.4801762114537445, Proportion of 0s: 0.5198237885462555
Client 2 of 5: Local Epoch [1/3] Loss: 0.6603, Accuracy: 60.57 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 332, 0s: 122
True Labels - 1s: 218, 0s: 236
Predictions - Proportion of 1s: 0.7312775330396476, Proportion of 0s: 0.2687224669603524
True Labels - Proportion of 1s: 0.4801762114537445, Proportion of 0s: 0.5198237885462555
Client 2 of 5: Local Epoch [2/3] Loss: 0.6488, Accuracy: 63.88 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 304, 0s: 150
True Labels - 1s: 218, 0s: 236
Predictions - Proportion of 1s: 0.6696035242290749, Proportion of 0s: 0.3303964757709251
True Labels - Proportion of 1s: 0.4801762114537445, Proportion of 0s: 0.5198237885462555
Client 2 of 5: Local Epoch [3/3] Loss: 0.6353, Accuracy: 66.52 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 384, 0s: 70
True Labels - 1s: 223, 0s: 231
Predictions - Proportion of 1s: 0.8458149779735683, Proportion of 0s: 0.15418502202643172
True Labels - Proportion of 1s: 0.4911894273127753, Proportion of 0s: 0.5088105726872246
Client 3 of 5: Local Epoch [1/3] Loss: 0.6727, Accuracy: 59.25 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 395, 0s: 59
True Labels - 1s: 223, 0s: 231
Predictions - Proportion of 1s: 0.8700440528634361, Proportion of 0s: 0.1299559471365639
True Labels - Proportion of 1s: 0.4911894273127753, Proportion of 0s: 0.5088105726872246
Client 3 of 5: Local Epoch [2/3] Loss: 0.6734, Accuracy: 58.15 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 392, 0s: 62
True Labels - 1s: 223, 0s: 231
Predictions - Proportion of 1s: 0.8634361233480177, Proportion of 0s: 0.13656387665198239
True Labels - Proportion of 1s: 0.4911894273127753, Proportion of 0s: 0.5088105726872246
Client 3 of 5: Local Epoch [3/3] Loss: 0.6657, Accuracy: 60.13 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 365, 0s: 89
True Labels - 1s: 244, 0s: 210
Predictions - Proportion of 1s: 0.8039647577092511, Proportion of 0s: 0.1960352422907489
True Labels - Proportion of 1s: 0.5374449339207048, Proportion of 0s: 0.46255506607929514
Client 4 of 5: Local Epoch [1/3] Loss: 0.6517, Accuracy: 63.22 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 435, 0s: 19
True Labels - 1s: 244, 0s: 210
Predictions - Proportion of 1s: 0.9581497797356828, Proportion of 0s: 0.04185022026431718
True Labels - Proportion of 1s: 0.5374449339207048, Proportion of 0s: 0.46255506607929514
Client 4 of 5: Local Epoch [2/3] Loss: 0.6766, Accuracy: 57.49 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 441, 0s: 13
True Labels - 1s: 244, 0s: 210
Predictions - Proportion of 1s: 0.9713656387665198, Proportion of 0s: 0.028634361233480177
True Labels - Proportion of 1s: 0.5374449339207048, Proportion of 0s: 0.46255506607929514
Client 4 of 5: Local Epoch [3/3] Loss: 0.6743, Accuracy: 56.17 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 413, 0s: 41
True Labels - 1s: 234, 0s: 220
Predictions - Proportion of 1s: 0.9096916299559471, Proportion of 0s: 0.09030837004405286
True Labels - Proportion of 1s: 0.5154185022026432, Proportion of 0s: 0.4845814977973568
Client 5 of 5: Local Epoch [1/3] Loss: 0.6591, Accuracy: 58.37 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 427, 0s: 27
True Labels - 1s: 234, 0s: 220
Predictions - Proportion of 1s: 0.9405286343612335, Proportion of 0s: 0.05947136563876652
True Labels - Proportion of 1s: 0.5154185022026432, Proportion of 0s: 0.4845814977973568
Client 5 of 5: Local Epoch [2/3] Loss: 0.6801, Accuracy: 56.17 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 424, 0s: 30
True Labels - 1s: 234, 0s: 220
Predictions - Proportion of 1s: 0.933920704845815, Proportion of 0s: 0.06607929515418502
True Labels - Proportion of 1s: 0.5154185022026432, Proportion of 0s: 0.4845814977973568
Client 5 of 5: Local Epoch [3/3] Loss: 0.6705, Accuracy: 56.83 %, Epsilon: 0.99, Delta: 0.0030
-------------------------------
Round [3/4] Average Local Loss: 0.6818, Average Local Accuracy: 58.63 %
-------------------------------
-------- Validation --------
Predictions - 1s: 550, 0s: 18
True Labels - 1s: 328, 0s: 240
Predictions - Proportion of 1s: 0.9683098591549296, Proportion of 0s: 0.03169014084507042
True Labels - Proportion of 1s: 0.5774647887323944, Proportion of 0s: 0.4225352112676056
Round [3/4] Global Model Validation Loss: 0.6528, Validation Accuracy: 60.92 %
-------- Validation finished --------

Round 4 of 4
-------------------------------
Predictions - 1s: 450, 0s: 4
True Labels - 1s: 241, 0s: 213
Predictions - Proportion of 1s: 0.9911894273127754, Proportion of 0s: 0.00881057268722467
True Labels - Proportion of 1s: 0.5308370044052864, Proportion of 0s: 0.46916299559471364
Client 1 of 5: Local Epoch [1/3] Loss: 0.7260, Accuracy: 53.96 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 451, 0s: 3
True Labels - 1s: 241, 0s: 213
Predictions - Proportion of 1s: 0.9933920704845814, Proportion of 0s: 0.006607929515418502
True Labels - Proportion of 1s: 0.5308370044052864, Proportion of 0s: 0.46916299559471364
Client 1 of 5: Local Epoch [2/3] Loss: 0.8209, Accuracy: 53.74 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 451, 0s: 3
True Labels - 1s: 241, 0s: 213
Predictions - Proportion of 1s: 0.9933920704845814, Proportion of 0s: 0.006607929515418502
True Labels - Proportion of 1s: 0.5308370044052864, Proportion of 0s: 0.46916299559471364
Client 1 of 5: Local Epoch [3/3] Loss: 0.8371, Accuracy: 53.74 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 438, 0s: 16
True Labels - 1s: 218, 0s: 236
Predictions - Proportion of 1s: 0.9647577092511013, Proportion of 0s: 0.03524229074889868
True Labels - Proportion of 1s: 0.4801762114537445, Proportion of 0s: 0.5198237885462555
Client 2 of 5: Local Epoch [1/3] Loss: 0.7426, Accuracy: 51.10 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 418, 0s: 36
True Labels - 1s: 218, 0s: 236
Predictions - Proportion of 1s: 0.920704845814978, Proportion of 0s: 0.07929515418502203
True Labels - Proportion of 1s: 0.4801762114537445, Proportion of 0s: 0.5198237885462555
Client 2 of 5: Local Epoch [2/3] Loss: 0.6826, Accuracy: 54.63 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 412, 0s: 42
True Labels - 1s: 218, 0s: 236
Predictions - Proportion of 1s: 0.9074889867841409, Proportion of 0s: 0.09251101321585903
True Labels - Proportion of 1s: 0.4801762114537445, Proportion of 0s: 0.5198237885462555
Client 2 of 5: Local Epoch [3/3] Loss: 0.6764, Accuracy: 55.07 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 402, 0s: 52
True Labels - 1s: 223, 0s: 231
Predictions - Proportion of 1s: 0.8854625550660793, Proportion of 0s: 0.1145374449339207
True Labels - Proportion of 1s: 0.4911894273127753, Proportion of 0s: 0.5088105726872246
Client 3 of 5: Local Epoch [1/3] Loss: 0.6778, Accuracy: 58.37 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 385, 0s: 69
True Labels - 1s: 223, 0s: 231
Predictions - Proportion of 1s: 0.8480176211453745, Proportion of 0s: 0.15198237885462554
True Labels - Proportion of 1s: 0.4911894273127753, Proportion of 0s: 0.5088105726872246
Client 3 of 5: Local Epoch [2/3] Loss: 0.6637, Accuracy: 60.79 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 399, 0s: 55
True Labels - 1s: 223, 0s: 231
Predictions - Proportion of 1s: 0.8788546255506607, Proportion of 0s: 0.1211453744493392
True Labels - Proportion of 1s: 0.4911894273127753, Proportion of 0s: 0.5088105726872246
Client 3 of 5: Local Epoch [3/3] Loss: 0.6813, Accuracy: 58.15 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 445, 0s: 9
True Labels - 1s: 244, 0s: 210
Predictions - Proportion of 1s: 0.9801762114537445, Proportion of 0s: 0.019823788546255508
True Labels - Proportion of 1s: 0.5374449339207048, Proportion of 0s: 0.46255506607929514
Client 4 of 5: Local Epoch [1/3] Loss: 0.7206, Accuracy: 55.73 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 451, 0s: 3
True Labels - 1s: 244, 0s: 210
Predictions - Proportion of 1s: 0.9933920704845814, Proportion of 0s: 0.006607929515418502
True Labels - Proportion of 1s: 0.5374449339207048, Proportion of 0s: 0.46255506607929514
Client 4 of 5: Local Epoch [2/3] Loss: 0.7465, Accuracy: 54.41 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 451, 0s: 3
True Labels - 1s: 244, 0s: 210
Predictions - Proportion of 1s: 0.9933920704845814, Proportion of 0s: 0.006607929515418502
True Labels - Proportion of 1s: 0.5374449339207048, Proportion of 0s: 0.46255506607929514
Client 4 of 5: Local Epoch [3/3] Loss: 0.7933, Accuracy: 54.41 %, Epsilon: 0.99, Delta: 0.0030
Predictions - 1s: 437, 0s: 17
True Labels - 1s: 234, 0s: 220
Predictions - Proportion of 1s: 0.9625550660792952, Proportion of 0s: 0.037444933920704845
True Labels - Proportion of 1s: 0.5154185022026432, Proportion of 0s: 0.4845814977973568
Client 5 of 5: Local Epoch [1/3] Loss: 0.6976, Accuracy: 54.41 %, Epsilon: 0.56, Delta: 0.0030
Predictions - 1s: 441, 0s: 13
True Labels - 1s: 234, 0s: 220
Predictions - Proportion of 1s: 0.9713656387665198, Proportion of 0s: 0.028634361233480177
True Labels - Proportion of 1s: 0.5154185022026432, Proportion of 0s: 0.4845814977973568
Client 5 of 5: Local Epoch [2/3] Loss: 0.7262, Accuracy: 53.52 %, Epsilon: 0.81, Delta: 0.0030
Predictions - 1s: 447, 0s: 7
True Labels - 1s: 234, 0s: 220
Predictions - Proportion of 1s: 0.9845814977973568, Proportion of 0s: 0.015418502202643172
True Labels - Proportion of 1s: 0.5154185022026432, Proportion of 0s: 0.4845814977973568
Client 5 of 5: Local Epoch [3/3] Loss: 0.7542, Accuracy: 52.20 %, Epsilon: 0.99, Delta: 0.0030
-------------------------------
Round [4/4] Average Local Loss: 0.7484, Average Local Accuracy: 54.71 %
-------------------------------
-------- Validation --------
Predictions - 1s: 558, 0s: 10
True Labels - 1s: 328, 0s: 240
Predictions - Proportion of 1s: 0.9823943661971831, Proportion of 0s: 0.017605633802816902
True Labels - Proportion of 1s: 0.5774647887323944, Proportion of 0s: 0.4225352112676056
Round [4/4] Global Model Validation Loss: 0.7036, Validation Accuracy: 59.51 %
-------- Validation finished --------
Best model in round 2 saved with Validation Loss: 0.6443895563273363 and Validation Accuracy: 62.50 %

-------- Training finished in 22:43 --------

Test flag enabled. Testing the model

-------- Loading best model from model_path --------
Loaded model bert-small from date 15-03-2024 10:02. Trained with Federated Learning technology.
Round 2, lr: 0.0006, optimizer: AdamW
Average train accuracy: 58.15 %, Validation accuracy: 62.50 %
-------- Best model loaded --------

-------- Creating Test Dataloader --------
Test Loader: 715 total sentences. 90 batches of size 8.
-------- Test Dataloader created --------

-------- Testing --------
Predictions - 1s: 664, 0s: 51
True Labels - 1s: 369, 0s: 346
Predictions - Proportion of 1s: 0.9286713286713286, Proportion of 0s: 0.07132867132867132
True Labels - Proportion of 1s: 0.5160839160839161, Proportion of 0s: 0.48391608391608393
Nº of test samples: 715
Accuracy: 56.50%
Accuracy 2 : 56.50%
Precision: 69.34%
Recall: 55.13%
F1 Score: 45.78%
Classification report:
              precision    recall  f1-score   support

           0     0.8431    0.1243    0.2166       346
           1     0.5437    0.9783    0.6989       369

    accuracy                         0.5650       715
   macro avg     0.6934    0.5513    0.4578       715
weighted avg     0.6886    0.5650    0.4655       715

-------- Testing finished --------
