Current configuration:
{
    "concurrency_flag": false,
    "data_distribution": "iid",
    "dataset": "dreaddit",
    "device": "cuda",
    "dp_delta": 0.003,
    "dp_epsilon": 10,
    "eval_batch_size": 4,
    "eval_flag": true,
    "eval_size": 0.2,
    "fed_alg": "fedavg",
    "layers": 3,
    "learning_rate": 0.0006,
    "max_length": 512,
    "ml_mode": "ml",
    "model": "bert_small",
    "model_name": "ml_10_dreaddit",
    "models_path": "/local/vpaloma/fabric-federated-learning/ablation_study/phase-2/1-ml_mode-dataset-dp/dreaddit",
    "mu": 0.5,
    "num_clients": 5,
    "num_epochs": 12,
    "num_rounds": 4,
    "optimizer": "AdamW",
    "progress_bar_flag": false,
    "save_model": true,
    "scheduler": "linear",
    "scheduler_warmup_steps": 0,
    "seed": 0,
    "test_flag": true,
    "train_batch_size": 4,
    "train_size": 0.8
}
-------- Configuration loaded --------

-------- Setting device --------
cuda device selected and available.
-------- Device set --------

-------- Setting seed --------
-------- Seed set --------

-------- Creating Model --------
-------- Model created --------

-------- Setting Trainable Layers --------
Training the last 3 layers.

Total parameters count: 28764674
Trainable parameters count: 3416066
-------- Trainable Layers set --------

-------- Creating Tokenizer --------
-------- Tokenizer created --------

-------- Creating Train and Eval Dataloaders --------
Train Loader: 2270 total sentences. 568 batches of size 4.
Eval Loader: 568 total sentences. 142 batches of size 4.
-------- Train and Eval Dataloaders created --------

-------- Creating Optimizer --------
-------- Optimizer created --------

-------- Creating Scheduler --------
-------- Scheduler created --------

-------- Training --------
Training with Centralised Machine Learning technology.
Training with differential privacy.
Epoch [1/12], Step [100/568], Loss: 0.7267, Accuracy: 51.25 %, Epsilon: 1.73, Delta: 0.0030
Epoch [1/12], Step [200/568], Loss: 0.7037, Accuracy: 52.00 %, Epsilon: 2.38, Delta: 0.0030
Epoch [1/12], Step [300/568], Loss: 0.6978, Accuracy: 54.58 %, Epsilon: 2.79, Delta: 0.0030
Epoch [1/12], Step [400/568], Loss: 0.7233, Accuracy: 53.62 %, Epsilon: 3.10, Delta: 0.0030
Epoch [1/12], Step [500/568], Loss: 0.7302, Accuracy: 53.40 %, Epsilon: 3.36, Delta: 0.0030
Predictions - 1s: 1542, 0s: 728
True Labels - 1s: 1160, 0s: 1110
-------------------------------
Epoch [1/12] Loss: 0.7324, Accuracy: 53.74 %, Epsilon: 3.51, Delta: 0.0030
-------------------------------
-------- Validation --------
Predictions - 1s: 561, 0s: 7
True Labels - 1s: 328, 0s: 240
Validation Loss: 0.8217, Validation Accuracy: 58.98 %
-------- Validation finished --------
Updated best model in epoch 1 saved with Validation Loss: 0.8217 and Validation Accuracy: 58.98 %
-------------------------------
Epoch [2/12], Step [100/568], Loss: 0.9572, Accuracy: 51.75 %, Epsilon: 3.72, Delta: 0.0030
Epoch [2/12], Step [200/568], Loss: 1.0053, Accuracy: 52.50 %, Epsilon: 3.91, Delta: 0.0030
Epoch [2/12], Step [300/568], Loss: 1.0806, Accuracy: 52.67 %, Epsilon: 4.08, Delta: 0.0030
Epoch [2/12], Step [400/568], Loss: 1.1579, Accuracy: 51.75 %, Epsilon: 4.25, Delta: 0.0030
Epoch [2/12], Step [500/568], Loss: 1.1635, Accuracy: 52.20 %, Epsilon: 4.41, Delta: 0.0030
Predictions - 1s: 2234, 0s: 36
True Labels - 1s: 1160, 0s: 1110
-------------------------------
Epoch [2/12] Loss: 1.1751, Accuracy: 52.69 %, Epsilon: 4.51, Delta: 0.0030
-------------------------------
-------- Validation --------
Predictions - 1s: 563, 0s: 5
True Labels - 1s: 328, 0s: 240
Validation Loss: 1.4272, Validation Accuracy: 58.63 %
-------- Validation finished --------
Epoch [3/12], Step [100/568], Loss: 1.6879, Accuracy: 54.00 %, Epsilon: 4.66, Delta: 0.0030
Epoch [3/12], Step [200/568], Loss: 1.6964, Accuracy: 52.62 %, Epsilon: 4.80, Delta: 0.0030
Epoch [3/12], Step [300/568], Loss: 1.6488, Accuracy: 52.50 %, Epsilon: 4.94, Delta: 0.0030
Epoch [3/12], Step [400/568], Loss: 1.6237, Accuracy: 53.50 %, Epsilon: 5.07, Delta: 0.0030
Epoch [3/12], Step [500/568], Loss: 1.5971, Accuracy: 53.90 %, Epsilon: 5.20, Delta: 0.0030
Predictions - 1s: 2182, 0s: 88
True Labels - 1s: 1160, 0s: 1110
-------------------------------
Epoch [3/12] Loss: 1.5476, Accuracy: 54.80 %, Epsilon: 5.28, Delta: 0.0030
-------------------------------
-------- Validation --------
Predictions - 1s: 534, 0s: 34
True Labels - 1s: 328, 0s: 240
Validation Loss: 1.3005, Validation Accuracy: 63.03 %
-------- Validation finished --------
Epoch [4/12], Step [100/568], Loss: 1.2134, Accuracy: 60.75 %, Epsilon: 5.41, Delta: 0.0030
Epoch [4/12], Step [200/568], Loss: 1.1979, Accuracy: 60.88 %, Epsilon: 5.53, Delta: 0.0030
Epoch [4/12], Step [300/568], Loss: 1.0972, Accuracy: 63.58 %, Epsilon: 5.65, Delta: 0.0030
Epoch [4/12], Step [400/568], Loss: 1.0922, Accuracy: 62.94 %, Epsilon: 5.76, Delta: 0.0030
Epoch [4/12], Step [500/568], Loss: 1.0455, Accuracy: 64.85 %, Epsilon: 5.88, Delta: 0.0030
Predictions - 1s: 1844, 0s: 426
True Labels - 1s: 1160, 0s: 1110
-------------------------------
Epoch [4/12] Loss: 1.0537, Accuracy: 64.93 %, Epsilon: 5.96, Delta: 0.0030
-------------------------------
-------- Validation --------
Predictions - 1s: 485, 0s: 83
True Labels - 1s: 328, 0s: 240
Validation Loss: 1.1835, Validation Accuracy: 67.78 %
-------- Validation finished --------
Epoch [5/12], Step [100/568], Loss: 1.0106, Accuracy: 64.75 %, Epsilon: 6.07, Delta: 0.0030
Epoch [5/12], Step [200/568], Loss: 0.9640, Accuracy: 65.50 %, Epsilon: 6.18, Delta: 0.0030
Epoch [5/12], Step [300/568], Loss: 0.9366, Accuracy: 67.75 %, Epsilon: 6.28, Delta: 0.0030
Epoch [5/12], Step [400/568], Loss: 0.9197, Accuracy: 68.75 %, Epsilon: 6.39, Delta: 0.0030
Epoch [5/12], Step [500/568], Loss: 0.9105, Accuracy: 69.60 %, Epsilon: 6.49, Delta: 0.0030
Predictions - 1s: 1451, 0s: 819
True Labels - 1s: 1160, 0s: 1110
-------------------------------
Epoch [5/12] Loss: 0.9120, Accuracy: 69.56 %, Epsilon: 6.56, Delta: 0.0030
-------------------------------
-------- Validation --------
Predictions - 1s: 367, 0s: 201
True Labels - 1s: 328, 0s: 240
Validation Loss: 0.9801, Validation Accuracy: 73.42 %
-------- Validation finished --------
Epoch [6/12], Step [100/568], Loss: 0.8802, Accuracy: 70.25 %, Epsilon: 6.67, Delta: 0.0030
Epoch [6/12], Step [200/568], Loss: 0.8681, Accuracy: 72.00 %, Epsilon: 6.77, Delta: 0.0030
Epoch [6/12], Step [300/568], Loss: 0.8965, Accuracy: 72.92 %, Epsilon: 6.87, Delta: 0.0030
Epoch [6/12], Step [400/568], Loss: 0.9293, Accuracy: 72.25 %, Epsilon: 6.97, Delta: 0.0030
Epoch [6/12], Step [500/568], Loss: 0.9593, Accuracy: 71.95 %, Epsilon: 7.06, Delta: 0.0030
Predictions - 1s: 1295, 0s: 975
True Labels - 1s: 1160, 0s: 1110
-------------------------------
Epoch [6/12] Loss: 0.9618, Accuracy: 71.76 %, Epsilon: 7.13, Delta: 0.0030
-------------------------------
-------- Validation --------
Predictions - 1s: 392, 0s: 176
True Labels - 1s: 328, 0s: 240
Validation Loss: 1.1841, Validation Accuracy: 72.18 %
-------- Validation finished --------
Epoch [7/12], Step [100/568], Loss: 0.9973, Accuracy: 74.00 %, Epsilon: 7.22, Delta: 0.0030
Epoch [7/12], Step [200/568], Loss: 1.0297, Accuracy: 73.00 %, Epsilon: 7.32, Delta: 0.0030
Epoch [7/12], Step [300/568], Loss: 1.0200, Accuracy: 73.50 %, Epsilon: 7.41, Delta: 0.0030
Epoch [7/12], Step [400/568], Loss: 1.0344, Accuracy: 72.62 %, Epsilon: 7.50, Delta: 0.0030
Epoch [7/12], Step [500/568], Loss: 1.0359, Accuracy: 73.30 %, Epsilon: 7.60, Delta: 0.0030
Predictions - 1s: 1272, 0s: 998
True Labels - 1s: 1160, 0s: 1110
-------------------------------
Epoch [7/12] Loss: 1.0783, Accuracy: 72.78 %, Epsilon: 7.66, Delta: 0.0030
-------------------------------
-------- Validation --------
Predictions - 1s: 357, 0s: 211
True Labels - 1s: 328, 0s: 240
Validation Loss: 1.2302, Validation Accuracy: 73.42 %
-------- Validation finished --------
Epoch [8/12], Step [100/568], Loss: 1.1373, Accuracy: 71.25 %, Epsilon: 7.75, Delta: 0.0030
Epoch [8/12], Step [200/568], Loss: 1.1462, Accuracy: 71.00 %, Epsilon: 7.84, Delta: 0.0030
Epoch [8/12], Step [300/568], Loss: 1.1189, Accuracy: 72.08 %, Epsilon: 7.93, Delta: 0.0030
Epoch [8/12], Step [400/568], Loss: 1.1575, Accuracy: 71.81 %, Epsilon: 8.02, Delta: 0.0030
Epoch [8/12], Step [500/568], Loss: 1.1260, Accuracy: 72.50 %, Epsilon: 8.10, Delta: 0.0030
Predictions - 1s: 1235, 0s: 1035
True Labels - 1s: 1160, 0s: 1110
-------------------------------
Epoch [8/12] Loss: 1.1374, Accuracy: 72.38 %, Epsilon: 8.16, Delta: 0.0030
-------------------------------
-------- Validation --------
Predictions - 1s: 351, 0s: 217
True Labels - 1s: 328, 0s: 240
Validation Loss: 1.2850, Validation Accuracy: 73.06 %
-------- Validation finished --------
Epoch [9/12], Step [100/568], Loss: 1.1247, Accuracy: 75.75 %, Epsilon: 8.25, Delta: 0.0030
Epoch [9/12], Step [200/568], Loss: 1.0667, Accuracy: 74.75 %, Epsilon: 8.33, Delta: 0.0030
Epoch [9/12], Step [300/568], Loss: 1.1136, Accuracy: 74.17 %, Epsilon: 8.42, Delta: 0.0030
Epoch [9/12], Step [400/568], Loss: 1.1276, Accuracy: 73.44 %, Epsilon: 8.50, Delta: 0.0030
Epoch [9/12], Step [500/568], Loss: 1.1488, Accuracy: 73.25 %, Epsilon: 8.59, Delta: 0.0030
Predictions - 1s: 1182, 0s: 1088
True Labels - 1s: 1160, 0s: 1110
-------------------------------
Epoch [9/12] Loss: 1.1331, Accuracy: 73.22 %, Epsilon: 8.65, Delta: 0.0030
-------------------------------
-------- Validation --------
Predictions - 1s: 372, 0s: 196
True Labels - 1s: 328, 0s: 240
Validation Loss: 1.3620, Validation Accuracy: 72.54 %
-------- Validation finished --------
Epoch [10/12], Step [100/568], Loss: 1.2978, Accuracy: 69.25 %, Epsilon: 8.73, Delta: 0.0030
Epoch [10/12], Step [200/568], Loss: 1.2560, Accuracy: 71.38 %, Epsilon: 8.81, Delta: 0.0030
Epoch [10/12], Step [300/568], Loss: 1.2242, Accuracy: 72.08 %, Epsilon: 8.89, Delta: 0.0030
Epoch [10/12], Step [400/568], Loss: 1.2543, Accuracy: 71.69 %, Epsilon: 8.97, Delta: 0.0030
Epoch [10/12], Step [500/568], Loss: 1.2179, Accuracy: 72.50 %, Epsilon: 9.05, Delta: 0.0030
Predictions - 1s: 1263, 0s: 1007
True Labels - 1s: 1160, 0s: 1110
-------------------------------
Epoch [10/12] Loss: 1.2010, Accuracy: 72.64 %, Epsilon: 9.11, Delta: 0.0030
-------------------------------
-------- Validation --------
Predictions - 1s: 357, 0s: 211
True Labels - 1s: 328, 0s: 240
Validation Loss: 1.3348, Validation Accuracy: 73.42 %
-------- Validation finished --------
Epoch [11/12], Step [100/568], Loss: 1.2381, Accuracy: 73.25 %, Epsilon: 9.19, Delta: 0.0030
Epoch [11/12], Step [200/568], Loss: 1.1635, Accuracy: 73.00 %, Epsilon: 9.27, Delta: 0.0030
Epoch [11/12], Step [300/568], Loss: 1.1145, Accuracy: 74.17 %, Epsilon: 9.35, Delta: 0.0030
Epoch [11/12], Step [400/568], Loss: 1.1608, Accuracy: 73.25 %, Epsilon: 9.43, Delta: 0.0030
Epoch [11/12], Step [500/568], Loss: 1.2126, Accuracy: 72.45 %, Epsilon: 9.51, Delta: 0.0030
Predictions - 1s: 1238, 0s: 1032
True Labels - 1s: 1160, 0s: 1110
-------------------------------
Epoch [11/12] Loss: 1.2032, Accuracy: 72.69 %, Epsilon: 9.56, Delta: 0.0030
-------------------------------
-------- Validation --------
Predictions - 1s: 342, 0s: 226
True Labels - 1s: 328, 0s: 240
Validation Loss: 1.3171, Validation Accuracy: 74.30 %
-------- Validation finished --------
Epoch [12/12], Step [100/568], Loss: 1.2272, Accuracy: 73.00 %, Epsilon: 9.64, Delta: 0.0030
Epoch [12/12], Step [200/568], Loss: 1.2932, Accuracy: 72.75 %, Epsilon: 9.71, Delta: 0.0030
Epoch [12/12], Step [300/568], Loss: 1.2247, Accuracy: 73.33 %, Epsilon: 9.79, Delta: 0.0030
Epoch [12/12], Step [400/568], Loss: 1.1959, Accuracy: 73.38 %, Epsilon: 9.87, Delta: 0.0030
Epoch [12/12], Step [500/568], Loss: 1.2152, Accuracy: 72.80 %, Epsilon: 9.94, Delta: 0.0030
Predictions - 1s: 1172, 0s: 1098
True Labels - 1s: 1160, 0s: 1110
-------------------------------
Epoch [12/12] Loss: 1.1966, Accuracy: 73.22 %, Epsilon: 9.99, Delta: 0.0030
-------------------------------
-------- Validation --------
Predictions - 1s: 341, 0s: 227
True Labels - 1s: 328, 0s: 240
Validation Loss: 1.3101, Validation Accuracy: 74.47 %
-------- Validation finished --------
Best model in epoch 1 saved with with Validation Loss: 0.8217 and Validation Accuracy: 58.98 %

-------- Training finished in 20:55 --------

Test flag enabled. Testing the model

-------- Loading best model from model_path --------
Loaded model bert-small from date 18-03-2024 11:09. Trained with Centralised Machine Learning technology.
Epoch 1, lr: 0.0006, optimizer: DPOptimizer
Train accuracy: 53.74 %, Validation accuracy: 58.98 %
-------- Best model loaded --------

-------- Creating Test Dataloader --------
Test Loader: 715 total sentences. 90 batches of size 8.
-------- Test Dataloader created --------

-------- Testing --------
Predictions - 1s: 707, 0s: 8
True Labels - 1s: 369, 0s: 346
Nº of test samples: 715
Accuracy: 52.73%
Accuracy 2 : 52.73%
Precision: 76.10%
Recall: 51.16%
F1 Score: 36.55%
Classification report:
              precision    recall  f1-score   support

           0     1.0000    0.0231    0.0452       346
           1     0.5219    1.0000    0.6859       369

    accuracy                         0.5273       715
   macro avg     0.7610    0.5116    0.3655       715
weighted avg     0.7533    0.5273    0.3758       715

-------- Testing finished --------
