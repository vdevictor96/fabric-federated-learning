Current configuration:
{
    "concurrency_flag": true,
    "data_distribution": "iid",
    "dataset": "twitter_dep",
    "device": "cuda",
    "dp_delta": 0.003,
    "dp_epsilon": 0.0,
    "eval_batch_size": 4,
    "eval_flag": true,
    "eval_size": 0.2,
    "fed_alg": "fedavg",
    "layers": 3,
    "learning_rate": 6e-05,
    "max_length": 512,
    "ml_mode": "ml",
    "model": "bert_medium",
    "model_name": "ml_medium_seed3_twitter_dep",
    "models_path": "/local/vpaloma/fabric-federated-learning/ablation_study/phase-2/4-execution_time/twitter_dep/",
    "mu": 0.5,
    "num_clients": 5,
    "num_epochs": 12,
    "num_rounds": 4,
    "optimizer": "AdamW",
    "progress_bar_flag": false,
    "save_model": true,
    "scheduler": "linear",
    "scheduler_warmup_steps": 0,
    "seed": 331,
    "test_flag": true,
    "train_batch_size": 4,
    "train_size": 0.8
}
-------- Configuration loaded --------

-------- Setting device --------
cuda device selected and available.
-------- Device set --------

-------- Setting seed --------
-------- Seed set --------

-------- Creating Model --------
-------- Model created --------

-------- Setting Trainable Layers --------
Training the last 3 layers.

Total parameters count: 41374210
Trainable parameters count: 3416066
-------- Trainable Layers set --------

-------- Creating Tokenizer --------
-------- Tokenizer created --------

-------- Creating Train and Eval Dataloaders --------
Train Loader: 1982 total sentences. 496 batches of size 4.
Eval Loader: 496 total sentences. 124 batches of size 4.
-------- Train and Eval Dataloaders created --------

-------- Creating Optimizer --------
-------- Optimizer created --------

-------- Creating Scheduler --------
-------- Scheduler created --------

-------- Training --------
Training with Centralised Machine Learning technology.
Training without differential privacy.
Concurrency flag is set to True, but ml mode is selected. Concurrency flag will be ignored.
Epoch [1/12], Step [100/496], Loss: 0.5390, Accuracy: 73.75 %
Epoch [1/12], Step [200/496], Loss: 0.5252, Accuracy: 74.75 %
Epoch [1/12], Step [300/496], Loss: 0.5101, Accuracy: 75.67 %
Epoch [1/12], Step [400/496], Loss: 0.4997, Accuracy: 76.38 %
Predictions - 1s: 320, 0s: 1662
True Labels - 1s: 545, 0s: 1437
-------------------------------
Epoch [1/12] Loss: 0.4802, Accuracy: 77.65 %
-------------------------------
-------- Validation --------
Predictions - 1s: 190, 0s: 306
True Labels - 1s: 129, 0s: 367
Validation Loss: 0.5028, Validation Accuracy: 73.99 %
-------- Validation finished --------
Updated best model in epoch 1 saved with Validation Loss: 0.5028 and Validation Accuracy: 73.99 %
-------------------------------
Epoch [2/12], Step [100/496], Loss: 0.3494, Accuracy: 86.25 %
Epoch [2/12], Step [200/496], Loss: 0.3928, Accuracy: 82.88 %
Epoch [2/12], Step [300/496], Loss: 0.3891, Accuracy: 82.75 %
Epoch [2/12], Step [400/496], Loss: 0.3956, Accuracy: 82.00 %
Predictions - 1s: 446, 0s: 1536
True Labels - 1s: 545, 0s: 1437
-------------------------------
Epoch [2/12] Loss: 0.3914, Accuracy: 82.09 %
-------------------------------
-------- Validation --------
Predictions - 1s: 155, 0s: 341
True Labels - 1s: 129, 0s: 367
Validation Loss: 0.4418, Validation Accuracy: 78.63 %
-------- Validation finished --------
Updated best model in epoch 2 saved with Validation Loss: 0.4418 and Validation Accuracy: 78.63 %
-------------------------------
Epoch [3/12], Step [100/496], Loss: 0.3243, Accuracy: 85.25 %
Epoch [3/12], Step [200/496], Loss: 0.3260, Accuracy: 84.25 %
Epoch [3/12], Step [300/496], Loss: 0.3345, Accuracy: 83.67 %
Epoch [3/12], Step [400/496], Loss: 0.3332, Accuracy: 84.25 %
Predictions - 1s: 461, 0s: 1521
True Labels - 1s: 545, 0s: 1437
-------------------------------
Epoch [3/12] Loss: 0.3389, Accuracy: 83.96 %
-------------------------------
-------- Validation --------
Predictions - 1s: 166, 0s: 330
True Labels - 1s: 129, 0s: 367
Validation Loss: 0.4781, Validation Accuracy: 76.81 %
-------- Validation finished --------
Epoch [4/12], Step [100/496], Loss: 0.2805, Accuracy: 87.50 %
Epoch [4/12], Step [200/496], Loss: 0.2747, Accuracy: 88.38 %
Epoch [4/12], Step [300/496], Loss: 0.2792, Accuracy: 88.00 %
Epoch [4/12], Step [400/496], Loss: 0.2784, Accuracy: 87.94 %
Predictions - 1s: 499, 0s: 1483
True Labels - 1s: 545, 0s: 1437
-------------------------------
Epoch [4/12] Loss: 0.2805, Accuracy: 87.69 %
-------------------------------
-------- Validation --------
Predictions - 1s: 128, 0s: 368
True Labels - 1s: 129, 0s: 367
Validation Loss: 0.4663, Validation Accuracy: 78.83 %
-------- Validation finished --------
Epoch [5/12], Step [100/496], Loss: 0.2337, Accuracy: 89.75 %
Epoch [5/12], Step [200/496], Loss: 0.2497, Accuracy: 89.38 %
Epoch [5/12], Step [300/496], Loss: 0.2307, Accuracy: 89.92 %
Epoch [5/12], Step [400/496], Loss: 0.2257, Accuracy: 90.25 %
Predictions - 1s: 496, 0s: 1486
True Labels - 1s: 545, 0s: 1437
-------------------------------
Epoch [5/12] Loss: 0.2248, Accuracy: 90.57 %
-------------------------------
-------- Validation --------
Predictions - 1s: 118, 0s: 378
True Labels - 1s: 129, 0s: 367
Validation Loss: 0.5359, Validation Accuracy: 78.02 %
-------- Validation finished --------
Epoch [6/12], Step [100/496], Loss: 0.1704, Accuracy: 92.50 %
Epoch [6/12], Step [200/496], Loss: 0.1684, Accuracy: 93.62 %
Epoch [6/12], Step [300/496], Loss: 0.1731, Accuracy: 93.00 %
Epoch [6/12], Step [400/496], Loss: 0.1639, Accuracy: 93.56 %
Predictions - 1s: 538, 0s: 1444
True Labels - 1s: 545, 0s: 1437
-------------------------------
Epoch [6/12] Loss: 0.1595, Accuracy: 93.69 %
-------------------------------
-------- Validation --------
Predictions - 1s: 140, 0s: 356
True Labels - 1s: 129, 0s: 367
Validation Loss: 0.6438, Validation Accuracy: 76.41 %
-------- Validation finished --------
Epoch [7/12], Step [100/496], Loss: 0.1266, Accuracy: 95.50 %
Epoch [7/12], Step [200/496], Loss: 0.1280, Accuracy: 94.88 %
Epoch [7/12], Step [300/496], Loss: 0.1229, Accuracy: 95.00 %
Epoch [7/12], Step [400/496], Loss: 0.1226, Accuracy: 95.12 %
Predictions - 1s: 530, 0s: 1452
True Labels - 1s: 545, 0s: 1437
-------------------------------
Epoch [7/12] Loss: 0.1232, Accuracy: 95.21 %
-------------------------------
-------- Validation --------
Predictions - 1s: 132, 0s: 364
True Labels - 1s: 129, 0s: 367
Validation Loss: 0.7019, Validation Accuracy: 76.41 %
-------- Validation finished --------
Epoch [8/12], Step [100/496], Loss: 0.0729, Accuracy: 98.00 %
Epoch [8/12], Step [200/496], Loss: 0.0830, Accuracy: 97.50 %
Epoch [8/12], Step [300/496], Loss: 0.0850, Accuracy: 97.08 %
Epoch [8/12], Step [400/496], Loss: 0.0896, Accuracy: 96.69 %
Predictions - 1s: 543, 0s: 1439
True Labels - 1s: 545, 0s: 1437
-------------------------------
Epoch [8/12] Loss: 0.0943, Accuracy: 96.37 %
-------------------------------
-------- Validation --------
Predictions - 1s: 122, 0s: 374
True Labels - 1s: 129, 0s: 367
Validation Loss: 0.7240, Validation Accuracy: 76.41 %
-------- Validation finished --------
Epoch [9/12], Step [100/496], Loss: 0.0820, Accuracy: 96.75 %
Epoch [9/12], Step [200/496], Loss: 0.0750, Accuracy: 97.12 %
Epoch [9/12], Step [300/496], Loss: 0.0752, Accuracy: 97.17 %
Epoch [9/12], Step [400/496], Loss: 0.0689, Accuracy: 97.50 %
Predictions - 1s: 541, 0s: 1441
True Labels - 1s: 545, 0s: 1437
-------------------------------
Epoch [9/12] Loss: 0.0699, Accuracy: 97.38 %
-------------------------------
-------- Validation --------
Predictions - 1s: 113, 0s: 383
True Labels - 1s: 129, 0s: 367
Validation Loss: 0.8036, Validation Accuracy: 79.03 %
-------- Validation finished --------
Epoch [10/12], Step [100/496], Loss: 0.0770, Accuracy: 96.25 %
Epoch [10/12], Step [200/496], Loss: 0.0640, Accuracy: 97.25 %
Epoch [10/12], Step [300/496], Loss: 0.0628, Accuracy: 97.25 %
Epoch [10/12], Step [400/496], Loss: 0.0636, Accuracy: 97.25 %
Predictions - 1s: 535, 0s: 1447
True Labels - 1s: 545, 0s: 1437
-------------------------------
Epoch [10/12] Loss: 0.0597, Accuracy: 97.58 %
-------------------------------
-------- Validation --------
Predictions - 1s: 112, 0s: 384
True Labels - 1s: 129, 0s: 367
Validation Loss: 0.8140, Validation Accuracy: 78.83 %
-------- Validation finished --------
Epoch [11/12], Step [100/496], Loss: 0.0400, Accuracy: 99.00 %
Epoch [11/12], Step [200/496], Loss: 0.0378, Accuracy: 98.75 %
Epoch [11/12], Step [300/496], Loss: 0.0381, Accuracy: 98.75 %
Epoch [11/12], Step [400/496], Loss: 0.0414, Accuracy: 98.50 %
Predictions - 1s: 545, 0s: 1437
True Labels - 1s: 545, 0s: 1437
-------------------------------
Epoch [11/12] Loss: 0.0419, Accuracy: 98.59 %
-------------------------------
-------- Validation --------
Predictions - 1s: 114, 0s: 382
True Labels - 1s: 129, 0s: 367
Validation Loss: 0.8595, Validation Accuracy: 78.43 %
-------- Validation finished --------
Epoch [12/12], Step [100/496], Loss: 0.0334, Accuracy: 99.00 %
Epoch [12/12], Step [200/496], Loss: 0.0381, Accuracy: 98.75 %
Epoch [12/12], Step [300/496], Loss: 0.0411, Accuracy: 98.42 %
Epoch [12/12], Step [400/496], Loss: 0.0449, Accuracy: 98.31 %
Predictions - 1s: 542, 0s: 1440
True Labels - 1s: 545, 0s: 1437
-------------------------------
Epoch [12/12] Loss: 0.0434, Accuracy: 98.44 %
-------------------------------
-------- Validation --------
Predictions - 1s: 117, 0s: 379
True Labels - 1s: 129, 0s: 367
Validation Loss: 0.8646, Validation Accuracy: 77.82 %
-------- Validation finished --------
Best model in epoch 2 saved with with Validation Loss: 0.4418 and Validation Accuracy: 78.63 %

-------- Training finished in 2:16 --------

Test flag enabled. Testing the model

-------- Loading best model from model_path --------
Loaded model bert-medium from date 21-03-2024 13:49. Trained with Centralised Machine Learning technology.
Epoch 2, lr: 6e-05, optimizer: AdamW
Train accuracy: 82.09 %, Validation accuracy: 78.63 %
-------- Best model loaded --------

-------- Creating Test Dataloader --------
Test Loader: 618 total sentences. 78 batches of size 8.
-------- Test Dataloader created --------

-------- Testing --------
Predictions - 1s: 192, 0s: 426
True Labels - 1s: 168, 0s: 450
Nº of test samples: 618
Accuracy: 82.20%
Accuracy 2 : 82.20%
Precision: 77.51%
Recall: 79.76%
F1 Score: 78.44%
Classification report:
              precision    recall  f1-score   support

           0     0.8991    0.8511    0.8744       450
           1     0.6510    0.7440    0.6944       168

    accuracy                         0.8220       618
   macro avg     0.7751    0.7976    0.7844       618
weighted avg     0.8316    0.8220    0.8255       618

-------- Testing finished --------
